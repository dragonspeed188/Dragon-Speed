MP2COD 4.15, COFF to COD File Converter
Copyright (c) 2007 Microchip Technology Inc.
Listing File Generated: Thu May 15 22:55:44 2008


Address  Value    Disassembly              Source                                                                           File
-------  -------  -----------------------  -------------------------------------------------------------------------------  -----
                                           /* $Id: c018i.c,v 1.7 2006/11/15 22:53:12 moshtaa Exp $ */                       C:\MCC18\src\traditional\startup\c018i.c
                                                                                                                            C:\MCC18\src\traditional\startup\c018i.c
                                           /* Copyright (c)1999 Microchip Technology */                                     C:\MCC18\src\traditional\startup\c018i.c
                                                                                                                            C:\MCC18\src\traditional\startup\c018i.c
                                           /* MPLAB-C18 startup code, including initialized data */                         C:\MCC18\src\traditional\startup\c018i.c
                                                                                                                            C:\MCC18\src\traditional\startup\c018i.c
                                           /* external reference to __init() function */                                    C:\MCC18\src\traditional\startup\c018i.c
                                           extern void __init (void);                                                       C:\MCC18\src\traditional\startup\c018i.c
                                           /* external reference to the user's main routine */                              C:\MCC18\src\traditional\startup\c018i.c
                                           extern void main (void);                                                         C:\MCC18\src\traditional\startup\c018i.c
                                           /* prototype for the startup function */                                         C:\MCC18\src\traditional\startup\c018i.c
                                           void _entry (void);                                                              C:\MCC18\src\traditional\startup\c018i.c
                                           void _startup (void);                                                            C:\MCC18\src\traditional\startup\c018i.c
                                           /* prototype for the initialized data setup */                                   C:\MCC18\src\traditional\startup\c018i.c
                                           void _do_cinit (void);                                                           C:\MCC18\src\traditional\startup\c018i.c
                                                                                                                            C:\MCC18\src\traditional\startup\c018i.c
                                           extern volatile near unsigned long short TBLPTR;                                 C:\MCC18\src\traditional\startup\c018i.c
                                           extern near unsigned FSR0;                                                       C:\MCC18\src\traditional\startup\c018i.c
                                           extern near char __FPFLAGS;                                                      C:\MCC18\src\traditional\startup\c018i.c
                                           #define RND 6                                                                    C:\MCC18\src\traditional\startup\c018i.c
                                                                                                                            C:\MCC18\src\traditional\startup\c018i.c
                                           #pragma code _entry_scn=0x000000                                                 C:\MCC18\src\traditional\startup\c018i.c
                                           void                                                                             C:\MCC18\src\traditional\startup\c018i.c
                                           _entry (void)                                                                    C:\MCC18\src\traditional\startup\c018i.c
                                           {_asm goto _startup _endasm                                                      C:\MCC18\src\traditional\startup\c018i.c
000000   efea     GOTO      0x7d4                                                                                           C:\MCC18\src\traditional\startup\c018i.c
000002   f003                                                                                                               
                                           }                                                                                C:\MCC18\src\traditional\startup\c018i.c
000004   0012     RETURN    0x0            #pragma code _startup_scn                                                        C:\MCC18\src\traditional\startup\c018i.c
                                           void                                                                             C:\MCC18\src\traditional\startup\c018i.c
                                           _startup (void)                                                                  C:\MCC18\src\traditional\startup\c018i.c
                                           {                                                                                C:\MCC18\src\traditional\startup\c018i.c
                                             _asm                                                                           C:\MCC18\src\traditional\startup\c018i.c
                                               // Initialize the stack pointer                                              C:\MCC18\src\traditional\startup\c018i.c
                                               lfsr 1, _stack                                                               C:\MCC18\src\traditional\startup\c018i.c
0007d4   ee13     LFSR      0x1,0x300          lfsr 2, _stack                                                               C:\MCC18\src\traditional\startup\c018i.c
0007d6   f000                                                                                                               
0007d8   ee23     LFSR      0x2,0x300                                                                                       C:\MCC18\src\traditional\startup\c018i.c
0007da   f000                                                                                                               
                                               clrf TBLPTRU, 0 // 1st silicon doesn't do this on POR                        C:\MCC18\src\traditional\startup\c018i.c
0007dc   6af8     CLRF      0xf8,0x0                                                                                        C:\MCC18\src\traditional\startup\c018i.c
                                               bcf __FPFLAGS,RND,0 // Initialize rounding flag for floating point libs      C:\MCC18\src\traditional\startup\c018i.c
0007de   9c01     BCF       0x1,0x6,0x0                                                                                     C:\MCC18\src\traditional\startup\c018i.c
                                               _endasm                                                                      C:\MCC18\src\traditional\startup\c018i.c
                                               _do_cinit ();                                                                C:\MCC18\src\traditional\startup\c018i.c
0007e0   ec90     CALL      0xb20,0x0                                                                                       C:\MCC18\src\traditional\startup\c018i.c
0007e2   f005                                                                                                               
                                           loop:                                                                            C:\MCC18\src\traditional\startup\c018i.c
                                                                                                                            C:\MCC18\src\traditional\startup\c018i.c
                                             // If user defined __init is not found, the one in clib.lib will be used       C:\MCC18\src\traditional\startup\c018i.c
                                             __init ();                                                                     C:\MCC18\src\traditional\startup\c018i.c
0007e4   ecff     CALL      0x7fe,0x0                                                                                       C:\MCC18\src\traditional\startup\c018i.c
0007e6   f003                                                                                                               
                                             // Call the user's main routine                                                C:\MCC18\src\traditional\startup\c018i.c
                                             main ();                                                                       C:\MCC18\src\traditional\startup\c018i.c
0007e8   ecd1     CALL      0x7a2,0x0                                                                                       C:\MCC18\src\traditional\startup\c018i.c
0007ea   f003                                                                                                               
                                             goto loop;                                                                     C:\MCC18\src\traditional\startup\c018i.c
0007ec   d7fb     BRA       0x7e4          }                               /* end _startup() */                             C:\MCC18\src\traditional\startup\c018i.c
0007ee   0012     RETURN    0x0                                                                                             C:\MCC18\src\traditional\startup\c018i.c
                                           /* MPLAB-C18 initialized data memory support */                                  C:\MCC18\src\traditional\startup\c018i.c
                                           /* The linker will populate the _cinit table */                                  C:\MCC18\src\traditional\startup\c018i.c
                                           extern far rom struct                                                            C:\MCC18\src\traditional\startup\c018i.c
                                           {                                                                                C:\MCC18\src\traditional\startup\c018i.c
                                             unsigned short num_init;                                                       C:\MCC18\src\traditional\startup\c018i.c
                                             struct _init_entry                                                             C:\MCC18\src\traditional\startup\c018i.c
                                             {                                                                              C:\MCC18\src\traditional\startup\c018i.c
                                               unsigned long from;                                                          C:\MCC18\src\traditional\startup\c018i.c
                                               unsigned long to;                                                            C:\MCC18\src\traditional\startup\c018i.c
                                               unsigned long size;                                                          C:\MCC18\src\traditional\startup\c018i.c
                                             }                                                                              C:\MCC18\src\traditional\startup\c018i.c
                                             entries[];                                                                     C:\MCC18\src\traditional\startup\c018i.c
                                           }                                                                                C:\MCC18\src\traditional\startup\c018i.c
                                           _cinit;                                                                          C:\MCC18\src\traditional\startup\c018i.c
                                                                                                                            C:\MCC18\src\traditional\startup\c018i.c
                                           #pragma code _cinit_scn                                                          C:\MCC18\src\traditional\startup\c018i.c
                                           void                                                                             C:\MCC18\src\traditional\startup\c018i.c
                                           _do_cinit (void)                                                                 C:\MCC18\src\traditional\startup\c018i.c
                                           {                                                                                C:\MCC18\src\traditional\startup\c018i.c
                                             /* we'll make the assumption in the following code that these statics          C:\MCC18\src\traditional\startup\c018i.c
                                              * will be allocated into the same bank.                                       C:\MCC18\src\traditional\startup\c018i.c
                                              */                                                                            C:\MCC18\src\traditional\startup\c018i.c
                                             static short long prom;                                                        C:\MCC18\src\traditional\startup\c018i.c
                                             static unsigned short curr_byte;                                               C:\MCC18\src\traditional\startup\c018i.c
                                             static unsigned short curr_entry;                                              C:\MCC18\src\traditional\startup\c018i.c
                                             static short long data_ptr;                                                    C:\MCC18\src\traditional\startup\c018i.c
                                                                                                                            C:\MCC18\src\traditional\startup\c018i.c
                                             // Initialized data...                                                         C:\MCC18\src\traditional\startup\c018i.c
                                             TBLPTR = (short long)&_cinit;                                                  C:\MCC18\src\traditional\startup\c018i.c
000b20   0e2a     MOVLW     0x2a             _asm                                                                           C:\MCC18\src\traditional\startup\c018i.c
000b22   6ef6     MOVWF     0xf6,0x0                                                                                        
000b24   0e00     MOVLW     0x0                                                                                             
000b26   6ef7     MOVWF     0xf7,0x0                                                                                        
000b28   0e00     MOVLW     0x0                                                                                             
000b2a   6ef8     MOVWF     0xf8,0x0                                                                                        
                                               movlb data_ptr                                                               C:\MCC18\src\traditional\startup\c018i.c
000b2c   0100     MOVLB     0x0                tblrdpostinc                                                                 C:\MCC18\src\traditional\startup\c018i.c
000b2e   0009     TBLRDPOSTINC                 movf TABLAT, 0, 0                                                            C:\MCC18\src\traditional\startup\c018i.c
000b30   50f5     MOVF      0xf5,0x0,0x0       movwf curr_entry, 1                                                          C:\MCC18\src\traditional\startup\c018i.c
000b32   6f65     MOVWF     0x65,0x1           tblrdpostinc                                                                 C:\MCC18\src\traditional\startup\c018i.c
000b34   0009     TBLRDPOSTINC                 movf TABLAT, 0, 0                                                            C:\MCC18\src\traditional\startup\c018i.c
000b36   50f5     MOVF      0xf5,0x0,0x0       movwf curr_entry+1, 1                                                        C:\MCC18\src\traditional\startup\c018i.c
000b38   6f66     MOVWF     0x66,0x1         _endasm                                                                        C:\MCC18\src\traditional\startup\c018i.c
                                               //while (curr_entry)                                                         C:\MCC18\src\traditional\startup\c018i.c
                                               //{                                                                          C:\MCC18\src\traditional\startup\c018i.c
                                               test:                                                                        C:\MCC18\src\traditional\startup\c018i.c
                                               _asm                                                                         C:\MCC18\src\traditional\startup\c018i.c
                                                bnz 3                                                                       C:\MCC18\src\traditional\startup\c018i.c
000b3a   e103     BNZ       0xb42              tstfsz curr_entry, 1                                                         C:\MCC18\src\traditional\startup\c018i.c
000b3c   6765     TSTFSZ    0x65,0x1           bra 1                                                                        C:\MCC18\src\traditional\startup\c018i.c
000b3e   d001     BRA       0xb42              _endasm                                                                      C:\MCC18\src\traditional\startup\c018i.c
                                               goto done;                                                                   C:\MCC18\src\traditional\startup\c018i.c
000b40   d03d     BRA       0xbbc                /* Count down so we only have to look up the data in _cinit                C:\MCC18\src\traditional\startup\c018i.c
                                                  * once.                                                                   C:\MCC18\src\traditional\startup\c018i.c
                                                  *                                                                         C:\MCC18\src\traditional\startup\c018i.c
                                                  * At this point we know that TBLPTR points to the top of the current      C:\MCC18\src\traditional\startup\c018i.c
                                                  * entry in _cinit, so we can just start reading the from, to, and         C:\MCC18\src\traditional\startup\c018i.c
                                                  * size values.                                                            C:\MCC18\src\traditional\startup\c018i.c
                                                  */                                                                        C:\MCC18\src\traditional\startup\c018i.c
                                                 _asm                                                                       C:\MCC18\src\traditional\startup\c018i.c
                                           	/* read the source address */                                                   C:\MCC18\src\traditional\startup\c018i.c
                                           	tblrdpostinc                                                                    C:\MCC18\src\traditional\startup\c018i.c
000b42   0009     TBLRDPOSTINC             	movf TABLAT, 0, 0                                                               C:\MCC18\src\traditional\startup\c018i.c
000b44   50f5     MOVF      0xf5,0x0,0x0   	movwf prom, 1                                                                   C:\MCC18\src\traditional\startup\c018i.c
000b46   6f60     MOVWF     0x60,0x1       	tblrdpostinc                                                                    C:\MCC18\src\traditional\startup\c018i.c
000b48   0009     TBLRDPOSTINC             	movf TABLAT, 0, 0                                                               C:\MCC18\src\traditional\startup\c018i.c
000b4a   50f5     MOVF      0xf5,0x0,0x0   	movwf prom+1, 1                                                                 C:\MCC18\src\traditional\startup\c018i.c
000b4c   6f61     MOVWF     0x61,0x1       	tblrdpostinc                                                                    C:\MCC18\src\traditional\startup\c018i.c
000b4e   0009     TBLRDPOSTINC             	movf TABLAT, 0, 0                                                               C:\MCC18\src\traditional\startup\c018i.c
000b50   50f5     MOVF      0xf5,0x0,0x0   	movwf prom+2, 1                                                                 C:\MCC18\src\traditional\startup\c018i.c
000b52   6f62     MOVWF     0x62,0x1       	/* skip a byte since it's stored as a 32bit int */                              C:\MCC18\src\traditional\startup\c018i.c
                                           	tblrdpostinc                                                                    C:\MCC18\src\traditional\startup\c018i.c
000b54   0009     TBLRDPOSTINC             	/* read the destination address directly into FSR0 */                           C:\MCC18\src\traditional\startup\c018i.c
                                           	tblrdpostinc                                                                    C:\MCC18\src\traditional\startup\c018i.c
000b56   0009     TBLRDPOSTINC             	movf TABLAT, 0, 0                                                               C:\MCC18\src\traditional\startup\c018i.c
000b58   50f5     MOVF      0xf5,0x0,0x0   	movwf FSR0L, 0                                                                  C:\MCC18\src\traditional\startup\c018i.c
000b5a   6ee9     MOVWF     0xe9,0x0       	tblrdpostinc                                                                    C:\MCC18\src\traditional\startup\c018i.c
000b5c   0009     TBLRDPOSTINC             	movf TABLAT, 0, 0                                                               C:\MCC18\src\traditional\startup\c018i.c
000b5e   50f5     MOVF      0xf5,0x0,0x0   	movwf FSR0H, 0                                                                  C:\MCC18\src\traditional\startup\c018i.c
000b60   6eea     MOVWF     0xea,0x0       	/* skip two bytes since it's stored as a 32bit int */                           C:\MCC18\src\traditional\startup\c018i.c
                                           	tblrdpostinc                                                                    C:\MCC18\src\traditional\startup\c018i.c
000b62   0009     TBLRDPOSTINC             	tblrdpostinc                                                                    C:\MCC18\src\traditional\startup\c018i.c
000b64   0009     TBLRDPOSTINC             	/* read the destination address directly into FSR0 */                           C:\MCC18\src\traditional\startup\c018i.c
                                           	tblrdpostinc                                                                    C:\MCC18\src\traditional\startup\c018i.c
000b66   0009     TBLRDPOSTINC             	movf TABLAT, 0, 0                                                               C:\MCC18\src\traditional\startup\c018i.c
000b68   50f5     MOVF      0xf5,0x0,0x0   	movwf curr_byte, 1                                                              C:\MCC18\src\traditional\startup\c018i.c
000b6a   6f63     MOVWF     0x63,0x1       	tblrdpostinc                                                                    C:\MCC18\src\traditional\startup\c018i.c
000b6c   0009     TBLRDPOSTINC             	movf TABLAT, 0, 0                                                               C:\MCC18\src\traditional\startup\c018i.c
000b6e   50f5     MOVF      0xf5,0x0,0x0   	movwf curr_byte+1, 1                                                            C:\MCC18\src\traditional\startup\c018i.c
000b70   6f64     MOVWF     0x64,0x1       	/* skip two bytes since it's stored as a 32bit int */                           C:\MCC18\src\traditional\startup\c018i.c
                                           	tblrdpostinc                                                                    C:\MCC18\src\traditional\startup\c018i.c
000b72   0009     TBLRDPOSTINC             	tblrdpostinc                                                                    C:\MCC18\src\traditional\startup\c018i.c
000b74   0009     TBLRDPOSTINC                   _endasm                                                                    C:\MCC18\src\traditional\startup\c018i.c
                                                 //prom = data_ptr->from;                                                   C:\MCC18\src\traditional\startup\c018i.c
                                                 //FSR0 = data_ptr->to;                                                     C:\MCC18\src\traditional\startup\c018i.c
                                                 //curr_byte = (unsigned short) data_ptr->size;                             C:\MCC18\src\traditional\startup\c018i.c
                                                 /* the table pointer now points to the next entry. Save it                 C:\MCC18\src\traditional\startup\c018i.c
                                                  * off since we'll be using the table pointer to do the copying            C:\MCC18\src\traditional\startup\c018i.c
                                                  * for the entry.                                                          C:\MCC18\src\traditional\startup\c018i.c
                                                  */                                                                        C:\MCC18\src\traditional\startup\c018i.c
                                                 data_ptr = TBLPTR;                                                         C:\MCC18\src\traditional\startup\c018i.c
000b76   cff6     MOVFF     0xff6,0x67                                                                                      C:\MCC18\src\traditional\startup\c018i.c
000b78   f067                                                                                                               
000b7a   cff7     MOVFF     0xff7,0x68                                                                                      
000b7c   f068                                                                                                               
000b7e   cff8     MOVFF     0xff8,0x69                                                                                      
000b80   f069                                                                                                               
                                                 /* now assign the source address to the table pointer */                   C:\MCC18\src\traditional\startup\c018i.c
                                                 TBLPTR = prom;                                                             C:\MCC18\src\traditional\startup\c018i.c
000b82   c060     MOVFF     0x60,0xff6                                                                                      C:\MCC18\src\traditional\startup\c018i.c
000b84   fff6                                                                                                               
000b86   c061     MOVFF     0x61,0xff7                                                                                      
000b88   fff7                                                                                                               
000b8a   c062     MOVFF     0x62,0xff8                                                                                      
000b8c   fff8                                                                                                               
                                                 /* do the copy loop */                                                     C:\MCC18\src\traditional\startup\c018i.c
                                                 _asm                                                                       C:\MCC18\src\traditional\startup\c018i.c
                                                   // determine if we have any more bytes to copy                           C:\MCC18\src\traditional\startup\c018i.c
                                           	movlb curr_byte                                                                 C:\MCC18\src\traditional\startup\c018i.c
000b8e   0100     MOVLB     0x0            	movf curr_byte, 1, 1                                                            C:\MCC18\src\traditional\startup\c018i.c
000b90   5363     MOVF      0x63,0x1,0x1   copy_loop:                                                                       C:\MCC18\src\traditional\startup\c018i.c
                                           	bnz 2 // copy_one_byte                                                          C:\MCC18\src\traditional\startup\c018i.c
000b92   e102     BNZ       0xb98          	movf curr_byte + 1, 1, 1                                                        C:\MCC18\src\traditional\startup\c018i.c
000b94   5364     MOVF      0x64,0x1,0x1   	bz 7 // done_copying                                                            C:\MCC18\src\traditional\startup\c018i.c
000b96   e007     BZ        0xba6                                                                                           C:\MCC18\src\traditional\startup\c018i.c
                                           copy_one_byte:                                                                   C:\MCC18\src\traditional\startup\c018i.c
                                           	tblrdpostinc                                                                    C:\MCC18\src\traditional\startup\c018i.c
000b98   0009     TBLRDPOSTINC             	movf TABLAT, 0, 0                                                               C:\MCC18\src\traditional\startup\c018i.c
000b9a   50f5     MOVF      0xf5,0x0,0x0   	movwf POSTINC0, 0                                                               C:\MCC18\src\traditional\startup\c018i.c
000b9c   6eee     MOVWF     0xee,0x0                                                                                        C:\MCC18\src\traditional\startup\c018i.c
                                           	// decrement byte counter                                                       C:\MCC18\src\traditional\startup\c018i.c
                                           	decf curr_byte, 1, 1                                                            C:\MCC18\src\traditional\startup\c018i.c
000b9e   0763     DECF      0x63,0x1,0x1   	bc -8 // copy_loop                                                              C:\MCC18\src\traditional\startup\c018i.c
000ba0   e2f8     BC        0xb92                  decf curr_byte + 1, 1, 1                                                 C:\MCC18\src\traditional\startup\c018i.c
000ba2   0764     DECF      0x64,0x1,0x1   	bra -7 // copy_one_byte                                                         C:\MCC18\src\traditional\startup\c018i.c
000ba4   d7f9     BRA       0xb98                                                                                           C:\MCC18\src\traditional\startup\c018i.c
                                           done_copying:                                                                    C:\MCC18\src\traditional\startup\c018i.c
                                                                                                                            C:\MCC18\src\traditional\startup\c018i.c
                                                 _endasm                                                                    C:\MCC18\src\traditional\startup\c018i.c
                                                 /* restore the table pointer for the next entry */                         C:\MCC18\src\traditional\startup\c018i.c
                                                 TBLPTR = data_ptr;                                                         C:\MCC18\src\traditional\startup\c018i.c
000ba6   c067     MOVFF     0x67,0xff6           /* next entry... */                                                        C:\MCC18\src\traditional\startup\c018i.c
000ba8   fff6                                                                                                               
000baa   c068     MOVFF     0x68,0xff7                                                                                      
000bac   fff7                                                                                                               
000bae   c069     MOVFF     0x69,0xff8                                                                                      
000bb0   fff8                                                                                                               
                                                 curr_entry--;                                                              C:\MCC18\src\traditional\startup\c018i.c
000bb2   0100     MOVLB     0x0                  goto test;                                                                 C:\MCC18\src\traditional\startup\c018i.c
000bb4   0765     DECF      0x65,0x1,0x1                                                                                    
000bb6   0e00     MOVLW     0x0                                                                                             
000bb8   5b66     SUBWFB    0x66,0x1,0x1                                                                                    
000bba   d7bf     BRA       0xb3a          done:                                                                            C:\MCC18\src\traditional\startup\c018i.c
                                           ;                                                                                C:\MCC18\src\traditional\startup\c018i.c
                                           }                                                                                C:\MCC18\src\traditional\startup\c018i.c
                                           /*********************************************************************           C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            *                Microchip USB C18 Firmware Version 1.0                         C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            *********************************************************************           C:\joyneuf\main.c
                                            * FileName:        main.c                                                       C:\joyneuf\main.c
                                            * Dependencies:    See INCLUDES section below                                   C:\joyneuf\main.c
                                            * Processor:       PIC18                                                        C:\joyneuf\main.c
                                            * Compiler:        C18 2.30.01+                                                 C:\joyneuf\main.c
                                            * Company:         Microchip Technology, Inc.                                   C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * Software License Agreement                                                    C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * The software supplied herewith by Microchip Technology Incorporated           C:\joyneuf\main.c
                                            * (the ìCompanyÅE for its PICmicroÆ Microcontroller is intended and             C:\joyneuf\main.c
                                            * supplied to you, the Companyís customer, for use solely and                   C:\joyneuf\main.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               C:\joyneuf\main.c
                                            * software is owned by the Company and/or its supplier, and is                  C:\joyneuf\main.c
                                            * protected under applicable copyright laws. All rights are reserved.           C:\joyneuf\main.c
                                            * Any use in violation of the foregoing restrictions may subject the            C:\joyneuf\main.c
                                            * user to criminal sanctions under applicable laws, as well as to               C:\joyneuf\main.c
                                            * civil liability for the breach of the terms and conditions of this            C:\joyneuf\main.c
                                            * license.                                                                      C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * THIS SOFTWARE IS PROVIDED IN AN ìAS ISÅECONDITION. NO WARRANTIES,             C:\joyneuf\main.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             C:\joyneuf\main.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   C:\joyneuf\main.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             C:\joyneuf\main.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    C:\joyneuf\main.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * Author               Date        Comment                                      C:\joyneuf\main.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           C:\joyneuf\main.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    C:\joyneuf\main.c
                                            ********************************************************************/           C:\joyneuf\main.c
                                                                                                                            C:\joyneuf\main.c
                                           /** I N C L U D E S **********************************************************/  C:\joyneuf\main.c
                                           #include <p18cxxx.h>                                                             C:\joyneuf\main.c
                                           #include "system\typedefs.h"                        // Required                  C:\joyneuf\main.c
                                           #include "system\usb\usb.h"                         // Required                  C:\joyneuf\main.c
                                           #include "io_cfg.h"                                 // Required                  C:\joyneuf\main.c
                                                                                                                            C:\joyneuf\main.c
                                           #include "system\usb\usb_compile_time_validation.h" // Optional                  C:\joyneuf\main.c
                                           #include "user\user_mouse.h"                        // Modifiable                C:\joyneuf\main.c
                                                                                                                            C:\joyneuf\main.c
                                           /** V A R I A B L E S ********************************************************/  C:\joyneuf\main.c
                                           #pragma udata                                                                    C:\joyneuf\main.c
                                                                                                                            C:\joyneuf\main.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  C:\joyneuf\main.c
                                           static void InitializeSystem(void);                                              C:\joyneuf\main.c
                                           void USBTasks(void);                                                             C:\joyneuf\main.c
                                                                                                                            C:\joyneuf\main.c
                                           /** V E C T O R  R E M A P P I N G *******************************************/  C:\joyneuf\main.c
                                                                                                                            C:\joyneuf\main.c
                                           extern void _startup (void);        // See c018i.c in your C18 compiler dir      C:\joyneuf\main.c
                                           #pragma code _RESET_INTERRUPT_VECTOR = 0x000800                                  C:\joyneuf\main.c
                                           void _reset (void)                                                               C:\joyneuf\main.c
                                           {                                                                                C:\joyneuf\main.c
000800   efea     GOTO      0x7d4              _asm goto _startup _endasm                                                   C:\joyneuf\main.c
000802   f003                                                                                                               
000804   0012     RETURN    0x0            }                                                                                C:\joyneuf\main.c
                                           #pragma code                                                                     C:\joyneuf\main.c
                                                                                                                            C:\joyneuf\main.c
                                           /** D E C L A R A T I O N S **************************************************/  C:\joyneuf\main.c
                                           #pragma code                                                                     C:\joyneuf\main.c
                                           /******************************************************************************  C:\joyneuf\main.c
                                            * Function:        void main(void)                                              C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * PreCondition:    None                                                         C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * Input:           None                                                         C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * Output:          None                                                         C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * Side Effects:    None                                                         C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * Overview:        Main program entry point.                                    C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * Note:            None                                                         C:\joyneuf\main.c
                                            *****************************************************************************/  C:\joyneuf\main.c
                                           void main(void)                                                                  C:\joyneuf\main.c
                                           {                                                                                C:\joyneuf\main.c
0007a2   d805     RCALL     0x7ae              InitializeSystem();                                                          C:\joyneuf\main.c
0007aa   d7fc     BRA       0x7a4              while(1)                                                                     C:\joyneuf\main.c
                                               {                                                                            C:\joyneuf\main.c
0007a4   d810     RCALL     0x7c6                  USBTasks();         // USB Tasks                                         C:\joyneuf\main.c
0007a6   ece2     CALL      0xbc4,0x0              ProcessIO();        // See user\user.c & .h                              C:\joyneuf\main.c
0007a8   f005                                                                                                               
                                               }//end while                                                                 C:\joyneuf\main.c
0007ac   0012     RETURN    0x0            }//end main                                                                      C:\joyneuf\main.c
                                                                                                                            C:\joyneuf\main.c
                                           /******************************************************************************  C:\joyneuf\main.c
                                            * Function:        static void InitializeSystem(void)                           C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * PreCondition:    None                                                         C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * Input:           None                                                         C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * Output:          None                                                         C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * Side Effects:    None                                                         C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * Overview:        InitializeSystem is a centralize initialization routine.     C:\joyneuf\main.c
                                            *                  All required USB initialization routines are called from     C:\joyneuf\main.c
                                            *                  here.                                                        C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            *                  User application initialization routine should also be       C:\joyneuf\main.c
                                            *                  called from here.                                            C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * Note:            None                                                         C:\joyneuf\main.c
                                            *****************************************************************************/  C:\joyneuf\main.c
                                           static void InitializeSystem(void)                                               C:\joyneuf\main.c
                                           {                                                                                C:\joyneuf\main.c
0007ae   0e0f     MOVLW     0xf                ADCON1 |= 0x0F;                 // Default all pins to digital               C:\joyneuf\main.c
0007b0   12c1     IORWF     0xc1,0x1,0x0                                                                                    
                                                                                                                            C:\joyneuf\main.c
                                               #if defined(USE_USB_BUS_SENSE_IO)                                            C:\joyneuf\main.c
                                               tris_usb_bus_sense = INPUT_PIN; // See io_cfg.h                              C:\joyneuf\main.c
                                               #endif                                                                       C:\joyneuf\main.c
                                                                                                                            C:\joyneuf\main.c
                                               #if defined(USE_SELF_POWER_SENSE_IO)                                         C:\joyneuf\main.c
                                               tris_self_power = INPUT_PIN;                                                 C:\joyneuf\main.c
                                               #endif                                                                       C:\joyneuf\main.c
                                                                                                                            C:\joyneuf\main.c
0007b2   0e14     MOVLW     0x14               mInitializeUSBDriver();         // See usbdrv.h                              C:\joyneuf\main.c
0007b4   6e6f     MOVWF     0x6f,0x0                                                                                        
0007b6   0100     MOVLB     0x0                                                                                             
0007b8   6b76     CLRF      0x76,0x1                                                                                        
0007ba   0100     MOVLB     0x0                                                                                             
0007bc   6b77     CLRF      0x77,0x1                                                                                        
0007be   0100     MOVLB     0x0                                                                                             
0007c0   6b78     CLRF      0x78,0x1                                                                                        
                                                                                                                            C:\joyneuf\main.c
0007c2   efdf     GOTO      0xbbe              UserInit();                     // See user.c & .h                           C:\joyneuf\main.c
0007c4   f005                                                                                                               
                                                                                                                            C:\joyneuf\main.c
                                           }//end InitializeSystem                                                          C:\joyneuf\main.c
                                                                                                                            C:\joyneuf\main.c
                                           /******************************************************************************  C:\joyneuf\main.c
                                            * Function:        void USBTasks(void)                                          C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * PreCondition:    InitializeSystem has been called.                            C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * Input:           None                                                         C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * Output:          None                                                         C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * Side Effects:    None                                                         C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * Overview:        Service loop for USB tasks.                                  C:\joyneuf\main.c
                                            *                                                                               C:\joyneuf\main.c
                                            * Note:            None                                                         C:\joyneuf\main.c
                                            *****************************************************************************/  C:\joyneuf\main.c
                                           void USBTasks(void)                                                              C:\joyneuf\main.c
                                           {                                                                                C:\joyneuf\main.c
                                               /*                                                                           C:\joyneuf\main.c
                                                * Servicing Hardware                                                        C:\joyneuf\main.c
                                                */                                                                          C:\joyneuf\main.c
0007c6   ec0e     CALL      0x61c,0x0          USBCheckBusStatus();                    // Must use polling method           C:\joyneuf\main.c
0007c8   f003                                                                                                               
0007ca   be6f     BTFSC     0x6f,0x7,0x0       if(UCFGbits.UTEYE!=1)                                                        C:\joyneuf\main.c
0007cc   d002     BRA       0x7d2                                                                                           
0007ce   ec2d     CALL      0x65a,0x0              USBDriverService();                 // Interrupt or polling method       C:\joyneuf\main.c
0007d0   f003                                                                                                               
                                                                                                                            C:\joyneuf\main.c
0007d2   0012     RETURN    0x0            }// end USBTasks                                                                 C:\joyneuf\main.c
                                           /*                                                                               C:\joyneuf\main.c
                                           //configulationÇí«â¡ÇµÇ‹ÇµÇΩ***********************************************     C:\joyneuf\main.c
                                           #pragma config PLLDIV = 5                                                        C:\joyneuf\main.c
                                           #pragma config CPUDIV = OSC1_PLL2                                                C:\joyneuf\main.c
                                           #pragma config USBDIV = 2                                                        C:\joyneuf\main.c
                                                                                                                            C:\joyneuf\main.c
                                           #pragma config FOSC = HS                                                         C:\joyneuf\main.c
                                           #pragma config FCMEM = OFF                                                       C:\joyneuf\main.c
                                           #pragma config IESO = OFF                                                        C:\joyneuf\main.c
                                                                                                                            C:\joyneuf\main.c
                                           #pragma config PWRT = OFF                                                        C:\joyneuf\main.c
                                           #pragma config BOR = ON                                                          C:\joyneuf\main.c
                                           #pragma config BORV = 28                                                         C:\joyneuf\main.c
                                           #pragma config VREGEN = ON                                                       C:\joyneuf\main.c
                                                                                                                            C:\joyneuf\main.c
                                           #pragma config WDT = OFF                                                         C:\joyneuf\main.c
                                           #pragma config WDTPS = 1                                                         C:\joyneuf\main.c
                                                                                                                            C:\joyneuf\main.c
                                           #pragma config MCLRE = ON                                                        C:\joyneuf\main.c
                                           #pragma config LPT1OSC = OFF                                                     C:\joyneuf\main.c
                                           #pragma config PBADEN = OFF                                                      C:\joyneuf\main.c
                                           #pragma config CCP2MX = OFF                                                      C:\joyneuf\main.c
                                                                                                                            C:\joyneuf\main.c
                                           #pragma config STVREN = OFF                                                      C:\joyneuf\main.c
                                           #pragma config LVP = OFF                                                         C:\joyneuf\main.c
                                           #pragma config ICPRT = OFF                                                       C:\joyneuf\main.c
                                           #pragma config XINST = OFF                                                       C:\joyneuf\main.c
                                           #pragma config DEBUG = OFF                                                       C:\joyneuf\main.c
                                                                                                                            C:\joyneuf\main.c
                                           #pragma config CP0 = OFF                                                         C:\joyneuf\main.c
                                           #pragma config CPB = OFF                                                         C:\joyneuf\main.c
                                           #pragma config WRT0 = OFF                                                        C:\joyneuf\main.c
                                           #pragma config WRTB = OFF                                                        C:\joyneuf\main.c
                                           #pragma config EBTR0 = OFF                                                       C:\joyneuf\main.c
                                           #pragma config EBTRB = OFF                                                       C:\joyneuf\main.c
                                           */                                                                               C:\joyneuf\main.c
                                           /** EOF main.c ***************************************************************/  C:\joyneuf\main.c
                                           /*********************************************************************           C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            *                Microchip USB C18 Firmware Version 1.0                         C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            *********************************************************************           C:\joyneuf\system\usb\usbmmap.c
                                            * FileName:        usbmmap.c                                                    C:\joyneuf\system\usb\usbmmap.c
                                            * Dependencies:    See INCLUDES section below                                   C:\joyneuf\system\usb\usbmmap.c
                                            * Processor:       PIC18                                                        C:\joyneuf\system\usb\usbmmap.c
                                            * Compiler:        C18 2.30.01+                                                 C:\joyneuf\system\usb\usbmmap.c
                                            * Company:         Microchip Technology, Inc.                                   C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * Software License Agreement                                                    C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * The software supplied herewith by Microchip Technology Incorporated           C:\joyneuf\system\usb\usbmmap.c
                                            * (the ìCompanyî) for its PICmicroÆ Microcontroller is intended and             C:\joyneuf\system\usb\usbmmap.c
                                            * supplied to you, the Companyís customer, for use solely and                   C:\joyneuf\system\usb\usbmmap.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               C:\joyneuf\system\usb\usbmmap.c
                                            * software is owned by the Company and/or its supplier, and is                  C:\joyneuf\system\usb\usbmmap.c
                                            * protected under applicable copyright laws. All rights are reserved.           C:\joyneuf\system\usb\usbmmap.c
                                            * Any use in violation of the foregoing restrictions may subject the            C:\joyneuf\system\usb\usbmmap.c
                                            * user to criminal sanctions under applicable laws, as well as to               C:\joyneuf\system\usb\usbmmap.c
                                            * civil liability for the breach of the terms and conditions of this            C:\joyneuf\system\usb\usbmmap.c
                                            * license.                                                                      C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * THIS SOFTWARE IS PROVIDED IN AN ìAS ISî CONDITION. NO WARRANTIES,             C:\joyneuf\system\usb\usbmmap.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             C:\joyneuf\system\usb\usbmmap.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   C:\joyneuf\system\usb\usbmmap.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             C:\joyneuf\system\usb\usbmmap.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    C:\joyneuf\system\usb\usbmmap.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * Author               Date        Comment                                      C:\joyneuf\system\usb\usbmmap.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           C:\joyneuf\system\usb\usbmmap.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    C:\joyneuf\system\usb\usbmmap.c
                                            ********************************************************************/           C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbmmap.c
                                            * -usbmmap.c-                                                                   C:\joyneuf\system\usb\usbmmap.c
                                            * USB Memory Map                                                                C:\joyneuf\system\usb\usbmmap.c
                                            * This file is the USB memory manager; it serves as a compile-time memory       C:\joyneuf\system\usb\usbmmap.c
                                            * allocator for the USB endpoints. It uses the compile time options passed      C:\joyneuf\system\usb\usbmmap.c
                                            * from usbcfg.h to instantiate endpoints and endpoint buffer.                   C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * Each endpoint requires to have a set of Buffer Descriptor registers(BDT).     C:\joyneuf\system\usb\usbmmap.c
                                            * A BDT is 4-byte long and has a specific RAM location for each endpoint.       C:\joyneuf\system\usb\usbmmap.c
                                            * The BDT for endpoint 0 out is located at address 0x400 to 0x403.              C:\joyneuf\system\usb\usbmmap.c
                                            * The BDT for endpoint 0 in is located at address 0x404 to 0x407.               C:\joyneuf\system\usb\usbmmap.c
                                            * The BDT for endpoint 1 out is located at address 0x408 to 0x40B.              C:\joyneuf\system\usb\usbmmap.c
                                            * and so on... The above allocation assumes the Ping-Pong Buffer Mode 0 is      C:\joyneuf\system\usb\usbmmap.c
                                            * used. These locations are already hard-wired in the silicon. The point        C:\joyneuf\system\usb\usbmmap.c
                                            * of doing instantiation, i.e. volatile far BDT ep0Bo;, is to provide the       C:\joyneuf\system\usb\usbmmap.c
                                            * C compiler a way to address each variable directly. This is very important    C:\joyneuf\system\usb\usbmmap.c
                                            * because when a register can be accessed directly, it saves execution time     C:\joyneuf\system\usb\usbmmap.c
                                            * and reduces program size.                                                     C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * Endpoints are defined using the endpoint number and the direction             C:\joyneuf\system\usb\usbmmap.c
                                            * of transfer. For simplicity, usbmmap.c only uses the endpoint number          C:\joyneuf\system\usb\usbmmap.c
                                            * in the BDT register allocation scheme. This means if the usbcfg.h states      C:\joyneuf\system\usb\usbmmap.c
                                            * that the MAX_EP_NUMBER is number 1, then four BDTs will be                    C:\joyneuf\system\usb\usbmmap.c
                                            * instantiated: one each for endpoint0 in and endpoint0 out, which must         C:\joyneuf\system\usb\usbmmap.c
                                            * always be instantiated for control transfer by default, and one each sets     C:\joyneuf\system\usb\usbmmap.c
                                            * for endpoint1 in and endpoint1 out. The naming convention for instantiating   C:\joyneuf\system\usb\usbmmap.c
                                            * BDT is                                                                        C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * ep<#>B<d>                                                                     C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * where # is the endpoint number, and d is the direction of                     C:\joyneuf\system\usb\usbmmap.c
                                            * transfer, which could be either <i> or <o>.                                   C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * The USB memory manager uses MAX_EP_NUMBER, as defined in usbcfg.h, to define  C:\joyneuf\system\usb\usbmmap.c
                                            * the endpoints to be instantiated. This represents the highest endpoint        C:\joyneuf\system\usb\usbmmap.c
                                            * number to be allocated, not how many endpoints are used. Since the BDTs for   C:\joyneuf\system\usb\usbmmap.c
                                            * endpoints have hardware-assigned addresses in Bank 4, setting this value too  C:\joyneuf\system\usb\usbmmap.c
                                            * high may lead to inefficient use of data RAM. For example, if an application  C:\joyneuf\system\usb\usbmmap.c
                                            * uses only endpoints EP0 and EP4, then the MAX_EP_NUMBER is 4, and not 2.      C:\joyneuf\system\usb\usbmmap.c
                                            * The in-between endpoint BDTs in this example (EP1, EP2, and EP3) go unused,   C:\joyneuf\system\usb\usbmmap.c
                                            * and the 24 bytes of memory associated with them are wasted. It does not make  C:\joyneuf\system\usb\usbmmap.c
                                            * much sense to skip endpoints, but the final decision lies with the user.      C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * The next step is to assign the instantiated BDTs to different                 C:\joyneuf\system\usb\usbmmap.c
                                            * USB functions. The firmware framework fundamentally assumes that every USB    C:\joyneuf\system\usb\usbmmap.c
                                            * function should know which endpoint it is using, i.e., the default control    C:\joyneuf\system\usb\usbmmap.c
                                            * transfer should know that it is using endpoint 0 in and endpoint 0 out.       C:\joyneuf\system\usb\usbmmap.c
                                            * A HID class can choose which endpoint it wants to use, but once chosen, it    C:\joyneuf\system\usb\usbmmap.c
                                            * should always know the number of the endpoint.                                C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * The assignment of endpoints to USB functions is managed centrally             C:\joyneuf\system\usb\usbmmap.c
                                            * in usbcfg.h. This helps prevent the mistake of having more                    C:\joyneuf\system\usb\usbmmap.c
                                            * than one USB function using the same endpoint. The "Endpoint Allocation"      C:\joyneuf\system\usb\usbmmap.c
                                            * section in usbcfg.h provides examples for how to map USB endpoints to USB     C:\joyneuf\system\usb\usbmmap.c
                                            * functions.                                                                    C:\joyneuf\system\usb\usbmmap.c
                                            * Quite a few things can be mapped in that section. There is no                 C:\joyneuf\system\usb\usbmmap.c
                                            * one correct way to do the mapping and the user has the choice to              C:\joyneuf\system\usb\usbmmap.c
                                            * choose a method that is most suitable to the application.                     C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * Typically, however, a user will want to map the following for a given         C:\joyneuf\system\usb\usbmmap.c
                                            * USB interface function:                                                       C:\joyneuf\system\usb\usbmmap.c
                                            * 1. The USB interface ID                                                       C:\joyneuf\system\usb\usbmmap.c
                                            * 2. The endpoint control registers (UEPn)                                      C:\joyneuf\system\usb\usbmmap.c
                                            * 3. The BDT registers (ep<#>B<d>)                                              C:\joyneuf\system\usb\usbmmap.c
                                            * 4. The endpoint size                                                          C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * Example: Assume a USB device class "foo", which uses one out endpoint         C:\joyneuf\system\usb\usbmmap.c
                                            *          of size 64-byte and one in endpoint of size 64-byte, then:           C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * #define FOO_INTF_ID          0x00                                             C:\joyneuf\system\usb\usbmmap.c
                                            * #define FOO_UEP              UEP1                                             C:\joyneuf\system\usb\usbmmap.c
                                            * #define FOO_BD_OUT           ep1Bo                                            C:\joyneuf\system\usb\usbmmap.c
                                            * #define FOO_BD_IN            ep1Bi                                            C:\joyneuf\system\usb\usbmmap.c
                                            * #define FOO_EP_SIZE          64                                               C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * The mapping above has chosen class "foo" to use endpoint 1.                   C:\joyneuf\system\usb\usbmmap.c
                                            * The names are arbitrary and can be anything other than FOO_??????.            C:\joyneuf\system\usb\usbmmap.c
                                            * For abstraction, the code for class "foo" should use the abstract             C:\joyneuf\system\usb\usbmmap.c
                                            * definitions of FOO_BD_OUT,FOO_BD_IN, and not ep1Bo or ep1Bi.                  C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * Note that the endpoint size defined in the usbcfg.h file is again             C:\joyneuf\system\usb\usbmmap.c
                                            * used in the usbmmap.c file. This shows that the relationship between          C:\joyneuf\system\usb\usbmmap.c
                                            * the two files are tightly related.                                            C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * The endpoint buffer for each USB function must be located in the              C:\joyneuf\system\usb\usbmmap.c
                                            * dual-port RAM area and has to come after all the BDTs have been               C:\joyneuf\system\usb\usbmmap.c
                                            * instantiated. An example declaration is:                                      C:\joyneuf\system\usb\usbmmap.c
                                            * volatile far unsigned char[FOO_EP_SIZE] data;                                 C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * The 'volatile' keyword tells the compiler not to perform any code             C:\joyneuf\system\usb\usbmmap.c
                                            * optimization on this variable because its content could be modified           C:\joyneuf\system\usb\usbmmap.c
                                            * by the hardware. The 'far' keyword tells the compiler that this variable      C:\joyneuf\system\usb\usbmmap.c
                                            * is not located in the Access RAM area (0x000 - 0x05F).                        C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * For the variable to be globally accessible by other files, it should be       C:\joyneuf\system\usb\usbmmap.c
                                            * declared in the header file usbmmap.h as an extern definition, such as        C:\joyneuf\system\usb\usbmmap.c
                                            * extern volatile far unsigned char[FOO_EP_SIZE] data;                          C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * Conclusion:                                                                   C:\joyneuf\system\usb\usbmmap.c
                                            * In a short summary, the dependencies between usbcfg and usbmmap can           C:\joyneuf\system\usb\usbmmap.c
                                            * be shown as:                                                                  C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * usbcfg[MAX_EP_NUMBER] -> usbmmap                                              C:\joyneuf\system\usb\usbmmap.c
                                            * usbmmap[ep<#>B<d>] -> usbcfg                                                  C:\joyneuf\system\usb\usbmmap.c
                                            * usbcfg[EP size] -> usbmmap                                                    C:\joyneuf\system\usb\usbmmap.c
                                            * usbcfg[abstract ep definitions] -> usb9/hid/cdc/etc class code                C:\joyneuf\system\usb\usbmmap.c
                                            * usbmmap[endpoint buffer variable] -> usb9/hid/cdc/etc class code              C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * Data mapping provides a means for direct addressing of BDT and endpoint       C:\joyneuf\system\usb\usbmmap.c
                                            * buffer. This means less usage of pointers, which equates to a faster and      C:\joyneuf\system\usb\usbmmap.c
                                            * smaller program code.                                                         C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           /** I N C L U D E S **********************************************************/  C:\joyneuf\system\usb\usbmmap.c
                                           #include "system\typedefs.h"                                                     C:\joyneuf\system\usb\usbmmap.c
                                           #include "system\usb\usb.h"                                                      C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           /** U S B  G L O B A L  V A R I A B L E S ************************************/  C:\joyneuf\system\usb\usbmmap.c
                                           #pragma udata                                                                    C:\joyneuf\system\usb\usbmmap.c
                                           byte usb_device_state;          // Device States: DETACHED, ATTACHED, ...        C:\joyneuf\system\usb\usbmmap.c
                                           USB_DEVICE_STATUS usb_stat;     // Global USB flags                              C:\joyneuf\system\usb\usbmmap.c
                                           byte usb_active_cfg;            // Value of current configuration                C:\joyneuf\system\usb\usbmmap.c
                                           byte usb_alt_intf[MAX_NUM_INT]; // Array to keep track of the current alternate  C:\joyneuf\system\usb\usbmmap.c
                                                                           // setting for each interface ID                 C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           /** U S B  F I X E D  L O C A T I O N  V A R I A B L E S *********************/  C:\joyneuf\system\usb\usbmmap.c
                                           #pragma udata usbram4=0x400     //See Linker Script,usb4:0x400-0x4FF(256-byte)   C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbmmap.c
                                            * Section A: Buffer Descriptor Table                                            C:\joyneuf\system\usb\usbmmap.c
                                            * - 0x400 - 0x4FF(max)                                                          C:\joyneuf\system\usb\usbmmap.c
                                            * - MAX_EP_NUMBER is defined in autofiles\usbcfg.h                              C:\joyneuf\system\usb\usbmmap.c
                                            * - BDT data type is defined in system\usb\usbmmap.h                            C:\joyneuf\system\usb\usbmmap.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           #if(0 <= MAX_EP_NUMBER)                                                          C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep0Bo;         //Endpoint #0 BD Out                             C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep0Bi;         //Endpoint #0 BD In                              C:\joyneuf\system\usb\usbmmap.c
                                           #endif                                                                           C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           #if(1 <= MAX_EP_NUMBER)                                                          C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep1Bo;         //Endpoint #1 BD Out                             C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep1Bi;         //Endpoint #1 BD In                              C:\joyneuf\system\usb\usbmmap.c
                                           #endif                                                                           C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           #if(2 <= MAX_EP_NUMBER)                                                          C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep2Bo;         //Endpoint #2 BD Out                             C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep2Bi;         //Endpoint #2 BD In                              C:\joyneuf\system\usb\usbmmap.c
                                           #endif                                                                           C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           #if(3 <= MAX_EP_NUMBER)                                                          C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep3Bo;         //Endpoint #3 BD Out                             C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep3Bi;         //Endpoint #3 BD In                              C:\joyneuf\system\usb\usbmmap.c
                                           #endif                                                                           C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           #if(4 <= MAX_EP_NUMBER)                                                          C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep4Bo;         //Endpoint #4 BD Out                             C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep4Bi;         //Endpoint #4 BD In                              C:\joyneuf\system\usb\usbmmap.c
                                           #endif                                                                           C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           #if(5 <= MAX_EP_NUMBER)                                                          C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep5Bo;         //Endpoint #5 BD Out                             C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep5Bi;         //Endpoint #5 BD In                              C:\joyneuf\system\usb\usbmmap.c
                                           #endif                                                                           C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           #if(6 <= MAX_EP_NUMBER)                                                          C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep6Bo;         //Endpoint #6 BD Out                             C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep6Bi;         //Endpoint #6 BD In                              C:\joyneuf\system\usb\usbmmap.c
                                           #endif                                                                           C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           #if(7 <= MAX_EP_NUMBER)                                                          C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep7Bo;         //Endpoint #7 BD Out                             C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep7Bi;         //Endpoint #7 BD In                              C:\joyneuf\system\usb\usbmmap.c
                                           #endif                                                                           C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           #if(8 <= MAX_EP_NUMBER)                                                          C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep8Bo;         //Endpoint #8 BD Out                             C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep8Bi;         //Endpoint #8 BD In                              C:\joyneuf\system\usb\usbmmap.c
                                           #endif                                                                           C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           #if(9 <= MAX_EP_NUMBER)                                                          C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep9Bo;         //Endpoint #9 BD Out                             C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep9Bi;         //Endpoint #9 BD In                              C:\joyneuf\system\usb\usbmmap.c
                                           #endif                                                                           C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           #if(10 <= MAX_EP_NUMBER)                                                         C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep10Bo;        //Endpoint #10 BD Out                            C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep10Bi;        //Endpoint #10 BD In                             C:\joyneuf\system\usb\usbmmap.c
                                           #endif                                                                           C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           #if(11 <= MAX_EP_NUMBER)                                                         C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep11Bo;        //Endpoint #11 BD Out                            C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep11Bi;        //Endpoint #11 BD In                             C:\joyneuf\system\usb\usbmmap.c
                                           #endif                                                                           C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           #if(12 <= MAX_EP_NUMBER)                                                         C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep12Bo;        //Endpoint #12 BD Out                            C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep12Bi;        //Endpoint #12 BD In                             C:\joyneuf\system\usb\usbmmap.c
                                           #endif                                                                           C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           #if(13 <= MAX_EP_NUMBER)                                                         C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep13Bo;        //Endpoint #13 BD Out                            C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep13Bi;        //Endpoint #13 BD In                             C:\joyneuf\system\usb\usbmmap.c
                                           #endif                                                                           C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           #if(14 <= MAX_EP_NUMBER)                                                         C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep14Bo;        //Endpoint #14 BD Out                            C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep14Bi;        //Endpoint #14 BD In                             C:\joyneuf\system\usb\usbmmap.c
                                           #endif                                                                           C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           #if(15 <= MAX_EP_NUMBER)                                                         C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep15Bo;        //Endpoint #15 BD Out                            C:\joyneuf\system\usb\usbmmap.c
                                           volatile far BDT ep15Bi;        //Endpoint #15 BD In                             C:\joyneuf\system\usb\usbmmap.c
                                           #endif                                                                           C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbmmap.c
                                            * Section B: EP0 Buffer Space                                                   C:\joyneuf\system\usb\usbmmap.c
                                            ******************************************************************************  C:\joyneuf\system\usb\usbmmap.c
                                            * - Two buffer areas are defined:                                               C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            *   A. CTRL_TRF_SETUP                                                           C:\joyneuf\system\usb\usbmmap.c
                                            *      - Size = EP0_BUFF_SIZE as defined in autofiles\usbcfg.h                  C:\joyneuf\system\usb\usbmmap.c
                                            *      - Detailed data structure allows direct adddressing of bits and bytes.   C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            *   B. CTRL_TRF_DATA                                                            C:\joyneuf\system\usb\usbmmap.c
                                            *      - Size = EP0_BUFF_SIZE as defined in autofiles\usbcfg.h                  C:\joyneuf\system\usb\usbmmap.c
                                            *      - Data structure allows direct adddressing of the first 8 bytes.         C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            * - Both data types are defined in system\usb\usbdefs\usbdefs_ep0_buff.h        C:\joyneuf\system\usb\usbmmap.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbmmap.c
                                           volatile far CTRL_TRF_SETUP SetupPkt;                                            C:\joyneuf\system\usb\usbmmap.c
                                           volatile far CTRL_TRF_DATA CtrlTrfData;                                          C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbmmap.c
                                            * Section C: HID Buffer                                                         C:\joyneuf\system\usb\usbmmap.c
                                            ******************************************************************************  C:\joyneuf\system\usb\usbmmap.c
                                            *                                                                               C:\joyneuf\system\usb\usbmmap.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbmmap.c
                                           #if defined(USB_USE_HID)                                                         C:\joyneuf\system\usb\usbmmap.c
                                           volatile far unsigned char hid_report_out[HID_INT_OUT_EP_SIZE];                  C:\joyneuf\system\usb\usbmmap.c
                                           volatile far unsigned char hid_report_in[HID_INT_IN_EP_SIZE];                    C:\joyneuf\system\usb\usbmmap.c
                                           #endif                                                                           C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           #pragma udata                                                                    C:\joyneuf\system\usb\usbmmap.c
                                                                                                                            C:\joyneuf\system\usb\usbmmap.c
                                           /** EOF usbmmap.c ************************************************************/  C:\joyneuf\system\usb\usbmmap.c
                                           /*********************************************************************           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                Microchip USB C18 Firmware Version 1.0                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *********************************************************************           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * FileName:        usbdrv.c                                                     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Dependencies:    See INCLUDES section below                                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Processor:       PIC18                                                        C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Compiler:        C18 2.30.01+                                                 C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Company:         Microchip Technology, Inc.                                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Software License Agreement                                                    C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * The software supplied herewith by Microchip Technology Incorporated           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * (the ìCompanyÅE for its PICmicroÆ Microcontroller is intended and             C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * supplied to you, the Companyís customer, for use solely and                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * software is owned by the Company and/or its supplier, and is                  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * protected under applicable copyright laws. All rights are reserved.           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Any use in violation of the foregoing restrictions may subject the            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * user to criminal sanctions under applicable laws, as well as to               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * civil liability for the breach of the terms and conditions of this            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * license.                                                                      C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * THIS SOFTWARE IS PROVIDED IN AN ìAS ISÅECONDITION. NO WARRANTIES,             C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Author               Date        Comment                                      C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            ********************************************************************/           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           /** I N C L U D E S **********************************************************/  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           #include <p18cxxx.h>                                                             C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           #include "system\typedefs.h"                                                     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           #include "system\usb\usb.h"                                                      C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           #include "io_cfg.h"             // Required for USBCheckBusStatus()              C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           /** V A R I A B L E S ********************************************************/  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           #pragma udata                                                                    C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           void USBModuleEnable(void);                                                      C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           void USBModuleDisable(void);                                                     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           void USBSuspend(void);                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           void USBWakeFromSuspend(void);                                                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           void USBProtocolResetHandler(void);                                              C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           void USB_SOF_Handler(void);                                                      C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           void USBStallHandler(void);                                                      C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           void USBErrorHandler(void);                                                      C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           /** D E C L A R A T I O N S **************************************************/  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           #pragma code                                                                     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBCheckBusStatus(void)                                 C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine enables/disables the USB module by monitoring   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  the USB power signal.                                        C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           void USBCheckBusStatus(void)                                                     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           {                                                                                C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               /**************************************************************************  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * Bus Attachment & Detachment Detection                                     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * usb_bus_sense is an i/o pin defined in io_cfg.h                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                *************************************************************************/  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               #define USB_BUS_ATTACHED    1                                                C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               #define USB_BUS_DETACHED    0                                                C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               if(usb_bus_sense == USB_BUS_ATTACHED)       // Is USB bus attached?          C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               {                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
00061c   a66d     BTFSS     0x6d,0x3,0x0           if(UCONbits.USBEN == 0)                 // Is the module off?            C:\joyneuf\system\usb\usbdrv\usbdrv.c
00061e   d80f     RCALL     0x63e                      USBModuleEnable();                  // Is off, enable it             C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               }                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
000620   d002     BRA       0x626              else                                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               {                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
000622   b66d     BTFSC     0x6d,0x3,0x0           if(UCONbits.USBEN == 1)                 // Is the module on?             C:\joyneuf\system\usb\usbdrv\usbdrv.c
000624   d813     RCALL     0x64c                      USBModuleDisable();                 // Is on, disable it             C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               }//end if(usb_bus_sense...)                                                  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * After enabling the USB module, it takes some time for the voltage         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * on the D+ or D- line to rise high enough to get out of the SE0 condition. C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * The USB Reset interrupt should not be unmasked until the SE0 condition is C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * cleared. This helps preventing the firmware from misinterpreting this     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * unique event as a USB bus reset from the USB host.                        C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                */                                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
000626   0100     MOVLB     0x0                if(usb_device_state == ATTACHED_STATE)                                       C:\joyneuf\system\usb\usbdrv\usbdrv.c
000628   0576     DECF      0x76,0x0,0x1                                                                                    
00062a   e108     BNZ       0x63c                                                                                           
                                               {                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
00062c   ba6d     BTFSC     0x6d,0x5,0x0           if(!UCONbits.SE0)                                                        C:\joyneuf\system\usb\usbdrv\usbdrv.c
00062e   d006     BRA       0x63c                                                                                           
                                                   {                                                                        C:\joyneuf\system\usb\usbdrv\usbdrv.c
000630   6a68     CLRF      0x68,0x0                   UIR = 0;                        // Clear all USB interrupts          C:\joyneuf\system\usb\usbdrv\usbdrv.c
000632   6a69     CLRF      0x69,0x0                   UIE = 0;                        // Mask all USB interrupts           C:\joyneuf\system\usb\usbdrv\usbdrv.c
000634   8069     BSF       0x69,0x0,0x0               UIEbits.URSTIE = 1;             // Unmask RESET interrupt            C:\joyneuf\system\usb\usbdrv\usbdrv.c
000636   8869     BSF       0x69,0x4,0x0               UIEbits.IDLEIE = 1;             // Unmask IDLE interrupt             C:\joyneuf\system\usb\usbdrv\usbdrv.c
000638   0e02     MOVLW     0x2                        usb_device_state = POWERED_STATE;                                    C:\joyneuf\system\usb\usbdrv\usbdrv.c
00063a   6f76     MOVWF     0x76,0x1                                                                                        
                                                   }//end if                           // else wait until SE0 is cleared    C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               }//end if(usb_device_state == ATTACHED_STATE)                                C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
00063c   0012     RETURN    0x0            }//end USBCheckBusStatus                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBModuleEnable(void)                                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine enables the USB module.                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  An end designer should never have to call this routine       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  manually. This routine should only be called from            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  USBCheckBusStatus().                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Note:            See USBCheckBusStatus() for more information.                C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           void USBModuleEnable(void)                                                       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           {                                                                                C:\joyneuf\system\usb\usbdrv\usbdrv.c
00063e   6a6d     CLRF      0x6d,0x0           UCON = 0;                                                                    C:\joyneuf\system\usb\usbdrv\usbdrv.c
000640   6a69     CLRF      0x69,0x0           UIE = 0;                                // Mask all USB interrupts           C:\joyneuf\system\usb\usbdrv\usbdrv.c
000642   866d     BSF       0x6d,0x3,0x0       UCONbits.USBEN = 1;                     // Enable module & attach to bus     C:\joyneuf\system\usb\usbdrv\usbdrv.c
000644   0100     MOVLB     0x0                usb_device_state = ATTACHED_STATE;      // Defined in usbmmap.c & .h         C:\joyneuf\system\usb\usbdrv\usbdrv.c
000646   0e01     MOVLW     0x1                                                                                             
000648   6f76     MOVWF     0x76,0x1                                                                                        
00064a   0012     RETURN    0x0            }//end USBModuleEnable                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBModuleDisable(void)                                  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine disables the USB module.                        C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  An end designer should never have to call this routine       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  manually. This routine should only be called from            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  USBCheckBusStatus().                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Note:            See USBCheckBusStatus() for more information.                C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           void USBModuleDisable(void)                                                      C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           {                                                                                C:\joyneuf\system\usb\usbdrv\usbdrv.c
00064c   6a6d     CLRF      0x6d,0x0           UCON = 0;                               // Disable module & detach from bus  C:\joyneuf\system\usb\usbdrv\usbdrv.c
00064e   6a69     CLRF      0x69,0x0           UIE = 0;                                // Mask all USB interrupts           C:\joyneuf\system\usb\usbdrv\usbdrv.c
000650   0100     MOVLB     0x0                usb_device_state = DETACHED_STATE;      // Defined in usbmmap.c & .h         C:\joyneuf\system\usb\usbdrv\usbdrv.c
000652   6b76     CLRF      0x76,0x1                                                                                        
000654   0012     RETURN    0x0            }//end USBModuleDisable                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBSoftDetach(void)                                     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    The device will have to be re-enumerated to function again.  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Overview:        USBSoftDetach electrically disconnects the device from       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  the bus. This is done by stop supplying Vusb voltage to      C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  pull-up resistor. The pull-down resistors on the host        C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  side will pull both differential signal lines low and        C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  the host registers the event as a disconnect.                C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  Since the USB cable is not physically disconnected, the      C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  power supply through the cable can still be sensed by        C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  the device. The next time USBCheckBusStatus() function       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  is called, it will reconnect the device back to the bus.     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           void USBSoftDetach(void)                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           {                                                                                C:\joyneuf\system\usb\usbdrv\usbdrv.c
000656   ef26     GOTO      0x64c              USBModuleDisable();                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
000658   f003                                                                                                               
                                           }//end USBSoftDetach                                                             C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBDriverService(void)                                  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine is the heart of this firmware. It manages       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  all USB interrupts.                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Note:            Device state transitions through the following stages:       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  DETACHED -> ATTACHED -> POWERED -> DEFAULT ->                C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  ADDRESS_PENDING -> ADDRESSED -> CONFIGURED -> READY          C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           void USBDriverService(void)                                                      C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           {                                                                                C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * Pointless to continue servicing if USB cable is not even attached.        C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                */                                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
00065a   0100     MOVLB     0x0                if(usb_device_state == DETACHED_STATE) return;                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
00065c   5176     MOVF      0x76,0x0,0x1                                                                                    
00065e   e101     BNZ       0x662                                                                                           
000660   d03a     BRA       0x6d6                                                                                           
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * Task A: Service USB Activity Interrupt                                    C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                */                                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
000662   5068     MOVF      0x68,0x0,0x0       if(UIRbits.ACTVIF && UIEbits.ACTVIE)    USBWakeFromSuspend();                C:\joyneuf\system\usb\usbdrv\usbdrv.c
000664   0b04     ANDLW     0x4                                                                                             
000666   e004     BZ        0x670                                                                                           
000668   5069     MOVF      0x69,0x0,0x0                                                                                    
00066a   0b04     ANDLW     0x4                                                                                             
00066c   e001     BZ        0x670                                                                                           
00066e   d841     RCALL     0x6f2                                                                                           
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * Pointless to continue servicing if the device is in suspend mode.         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                */                                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
000670   b26d     BTFSC     0x6d,0x1,0x0       if(UCONbits.SUSPND==1) return;                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
000672   d031     BRA       0x6d6                                                                                           
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * Task B: Service USB Bus Reset Interrupt.                                  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * When bus reset is received during suspend, ACTVIF will be set first,      C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * once the UCONbits.SUSPND is clear, then the URSTIF bit will be asserted.  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * This is why URSTIF is checked after ACTVIF.                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                *                                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * The USB reset flag is masked when the USB state is in                     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * DETACHED_STATE or ATTACHED_STATE, and therefore cannot                    C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * cause a USB reset event during these two states.                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                */                                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
000674   5068     MOVF      0x68,0x0,0x0       if(UIRbits.URSTIF && UIEbits.URSTIE)    USBProtocolResetHandler();           C:\joyneuf\system\usb\usbdrv\usbdrv.c
000676   0b01     ANDLW     0x1                                                                                             
000678   e004     BZ        0x682                                                                                           
00067a   5069     MOVF      0x69,0x0,0x0                                                                                    
00067c   0b01     ANDLW     0x1                                                                                             
00067e   e001     BZ        0x682                                                                                           
000680   d859     RCALL     0x734                                                                                           
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * Task C: Service other USB interrupts                                      C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                */                                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
000682   5068     MOVF      0x68,0x0,0x0       if(UIRbits.IDLEIF && UIEbits.IDLEIE)    USBSuspend();                        C:\joyneuf\system\usb\usbdrv\usbdrv.c
000684   0b10     ANDLW     0x10                                                                                            
000686   e004     BZ        0x690                                                                                           
000688   5069     MOVF      0x69,0x0,0x0                                                                                    
00068a   0b10     ANDLW     0x10                                                                                            
00068c   e001     BZ        0x690                                                                                           
00068e   d824     RCALL     0x6d8                                                                                           
000690   5068     MOVF      0x68,0x0,0x0       if(UIRbits.SOFIF && UIEbits.SOFIE)      USB_SOF_Handler();                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
000692   0b40     ANDLW     0x40                                                                                            
000694   e004     BZ        0x69e                                                                                           
000696   5069     MOVF      0x69,0x0,0x0                                                                                    
000698   0b40     ANDLW     0x40                                                                                            
00069a   e001     BZ        0x69e                                                                                           
00069c   d840     RCALL     0x71e                                                                                           
00069e   5068     MOVF      0x68,0x0,0x0       if(UIRbits.STALLIF && UIEbits.STALLIE)  USBStallHandler();                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006a0   0b20     ANDLW     0x20                                                                                            
0006a2   e004     BZ        0x6ac                                                                                           
0006a4   5069     MOVF      0x69,0x0,0x0                                                                                    
0006a6   0b20     ANDLW     0x20                                                                                            
0006a8   e001     BZ        0x6ac                                                                                           
0006aa   d83b     RCALL     0x722                                                                                           
0006ac   5068     MOVF      0x68,0x0,0x0       if(UIRbits.UERRIF && UIEbits.UERRIE)    USBErrorHandler();                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006ae   0b02     ANDLW     0x2                                                                                             
0006b0   e004     BZ        0x6ba                                                                                           
0006b2   5069     MOVF      0x69,0x0,0x0                                                                                    
0006b4   0b02     ANDLW     0x2                                                                                             
0006b6   e001     BZ        0x6ba                                                                                           
0006b8   d83b     RCALL     0x730                                                                                           
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * Pointless to continue servicing if the host has not sent a bus reset.     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * Once bus reset is received, the device transitions into the DEFAULT       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * state and is ready for communication.                                     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                */                                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006ba   0e03     MOVLW     0x3                if(usb_device_state < DEFAULT_STATE) return;                                 C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006bc   0100     MOVLB     0x0                                                                                             
0006be   5d76     SUBWF     0x76,0x0,0x1                                                                                    
0006c0   e201     BC        0x6c4                                                                                           
0006c2   d009     BRA       0x6d6                                                                                           
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * Task D: Servicing USB Transaction Complete Interrupt                      C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                */                                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006c4   5068     MOVF      0x68,0x0,0x0       if(UIRbits.TRNIF && UIEbits.TRNIE)                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006c6   0b08     ANDLW     0x8                                                                                             
0006c8   e006     BZ        0x6d6                                                                                           
0006ca   5069     MOVF      0x69,0x0,0x0                                                                                    
0006cc   0b08     ANDLW     0x8                                                                                             
0006ce   e003     BZ        0x6d6                                                                                           
                                               {                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                   /*                                                                       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                    * USBCtrlEPService only services transactions over EP0.                 C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                    * It ignores all other EP transactions.                                 C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                    */                                                                      C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006d0   ec9a     CALL      0x334,0x0              USBCtrlEPService();                                                      C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006d2   f001                                                                                                               
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                   /*                                                                       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                    * Other EP can be serviced later by responsible device class firmware.  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                    * Each device driver knows when an OUT or IN transaction is ready by    C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                    * checking the buffer ownership bit.                                    C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                    * An OUT EP should always be owned by SIE until the data is ready.      C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                    * An IN EP should always be owned by CPU until the data is ready.       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                    *                                                                       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                    * Because of this logic, it is not necessary to save the USTAT value    C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                    * of non-EP0 transactions.                                              C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                    */                                                                      C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006d4   9668     BCF       0x68,0x3,0x0           UIRbits.TRNIF = 0;                                                       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               }//end if(UIRbits.TRNIF && UIEbits.TRNIE)                                    C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006d6   0012     RETURN    0x0            }//end USBDriverService                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBSuspend(void)                                        C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Overview:                                                                     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           void USBSuspend(void)                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           {                                                                                C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * NOTE: Do not clear UIRbits.ACTVIF here!                                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * Reason:                                                                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * ACTVIF is only generated once an IDLEIF has been generated.               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * This is a 1:1 ratio interrupt generation.                                 C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * For every IDLEIF, there will be only one ACTVIF regardless of             C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * the number of subsequent bus transitions.                                 C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                *                                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * If the ACTIF is cleared here, a problem could occur when:                 C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * [       IDLE       ][bus activity ->                                      C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * <--- 3 ms ----->     ^                                                    C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                *                ^     ACTVIF=1                                             C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                *                IDLEIF=1                                                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                *  #           #           #           #   (#=Program polling flags)        C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                *                          ^                                                C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                *                          This polling loop will see both                  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                *                          IDLEIF=1 and ACTVIF=1.                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                *                          However, the program services IDLEIF first       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                *                          because ACTIVIE=0.                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                *                          If this routine clears the only ACTIVIF,         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                *                          then it can never get out of the suspend         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                *                          mode.                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                */                                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006d8   8469     BSF       0x69,0x2,0x0       UIEbits.ACTVIE = 1;                     // Enable bus activity interrupt     C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006da   9868     BCF       0x68,0x4,0x0       UIRbits.IDLEIF = 0;                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006dc   826d     BSF       0x6d,0x1,0x0       UCONbits.SUSPND = 1;                    // Put USB module in power conserve  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                       // mode, SIE clock inactive          C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * At this point the PIC can go into sleep,idle, or                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * switch to a slower clock, etc.                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                */                                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               /* Modifiable Section */                                                     C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006de   9aa1     BCF       0xa1,0x5,0x0       PIR2bits.USBIF = 0;                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006e0   90f2     BCF       0xf2,0x0,0x0       INTCONbits.RBIF = 0;                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006e2   8aa0     BSF       0xa0,0x5,0x0       PIE2bits.USBIE = 1;                     // Set USB wakeup source             C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006e4   86f2     BSF       0xf2,0x3,0x0       INTCONbits.RBIE = 1;                    // Set sw2,3 wakeup source           C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006e6   0003     SLEEP                        Sleep();                                // Goto sleep                        C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006e8   b0f2     BTFSC     0xf2,0x0,0x0       if(INTCONbits.RBIF == 1)                // Check if external stimulus        C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               {                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006ea   d807     RCALL     0x6fa                  USBRemoteWakeup();                  // If yes, attempt RWU               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               }                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006ec   9aa0     BCF       0xa0,0x5,0x0       PIE2bits.USBIE = 0;                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006ee   96f2     BCF       0xf2,0x3,0x0       INTCONbits.RBIE = 0;                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               /* End Modifiable Section */                                                 C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006f0   0012     RETURN    0x0            }//end USBSuspend                                                                C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBWakeFromSuspend(void)                                C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Overview:                                                                     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           void USBWakeFromSuspend(void)                                                    C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           {                                                                                C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * If using clock switching, this is the place to restore the                C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * original clock frequency.                                                 C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                */                                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006f2   926d     BCF       0x6d,0x1,0x0       UCONbits.SUSPND = 0;                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006f4   9469     BCF       0x69,0x2,0x0       UIEbits.ACTVIE = 0;                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006f6   9468     BCF       0x68,0x2,0x0       UIRbits.ACTVIF = 0;                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006f8   0012     RETURN    0x0            }//end USBWakeFromSuspend                                                        C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBRemoteWakeup(void)                                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This function should be called by user when the device       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  is waken up by an external stimulus other than ACTIVIF.      C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  Please read the note below to understand the limitations.    C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Note:            The modifiable section in this routine should be changed     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  to meet the application needs. Current implementation        C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  temporary blocks other functions from executing for a        C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  period of 1-13 ms depending on the core frequency.           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  According to USB 2.0 specification section 7.1.7.7,          C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  "The remote wakeup device must hold the resume signaling     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  for at lest 1 ms but for no more than 15 ms."                C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  The idea here is to use a delay counter loop, using a        C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  common value that would work over a wide range of core       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  frequencies.                                                 C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  That value selected is 1800. See table below:                C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  ==========================================================   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  Core Freq(MHz)      MIP         RESUME Signal Period (ms)    C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  ==========================================================   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                      48              12          1.05                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                       4              1           12.6                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  ==========================================================   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  * These timing could be incorrect when using code            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                    optimization or extended instruction mode,                 C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                    or when having other interrupts enabled.                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                    Make sure to verify using the MPLAB SIM's Stopwatch        C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           void USBRemoteWakeup(void)                                                       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           {                                                                                C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               static word delay_count;                                                     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006fa   0100     MOVLB     0x0                if(usb_stat.RemoteWakeup == 1)          // Check if RemoteWakeup function    C:\joyneuf\system\usb\usbdrv\usbdrv.c
0006fc   a177     BTFSS     0x77,0x0,0x1                                                                                    
0006fe   d00e     BRA       0x71c                                                                                           
                                               {                                       // has been enabled by the host.     C:\joyneuf\system\usb\usbdrv\usbdrv.c
000700   dff8     RCALL     0x6f2                  USBWakeFromSuspend();               // Unsuspend USB modue               C:\joyneuf\system\usb\usbdrv\usbdrv.c
000702   846d     BSF       0x6d,0x2,0x0           UCONbits.RESUME = 1;                // Start RESUME signaling            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                   /* Modifiable Section */                                                 C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
000704   0100     MOVLB     0x0                    delay_count = 1800U;                // Set RESUME line for 1-13 ms       C:\joyneuf\system\usb\usbdrv\usbdrv.c
000706   0e08     MOVLW     0x8                                                                                             
000708   6f7d     MOVWF     0x7d,0x1                                                                                        
00070a   0e07     MOVLW     0x7                                                                                             
00070c   6f7e     MOVWF     0x7e,0x1                                                                                        
                                                   do                                                                       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                   {                                                                        C:\joyneuf\system\usb\usbdrv\usbdrv.c
00070e   077d     DECF      0x7d,0x1,0x1               delay_count--;                                                       C:\joyneuf\system\usb\usbdrv\usbdrv.c
000710   0e00     MOVLW     0x0                                                                                             
000712   5b7e     SUBWFB    0x7e,0x1,0x1                                                                                    
000714   517d     MOVF      0x7d,0x0,0x1           }while(delay_count);                                                     C:\joyneuf\system\usb\usbdrv\usbdrv.c
000716   117e     IORWF     0x7e,0x0,0x1                                                                                    
000718   e1fa     BNZ       0x70e                                                                                           
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                   /* End Modifiable Section */                                             C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
00071a   946d     BCF       0x6d,0x2,0x0           UCONbits.RESUME = 0;                                                     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               }//endif                                                                     C:\joyneuf\system\usb\usbdrv\usbdrv.c
00071c   0012     RETURN    0x0            }//end USBRemoteWakeup                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USB_SOF_Handler(void)                                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Overview:        The USB host sends out a SOF packet to full-speed devices    C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  every 1 ms. This interrupt may be useful for isochronous     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  pipes. End designers should implement callback routine       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  as necessary.                                                C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           void USB_SOF_Handler(void)                                                       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           {                                                                                C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               /* Callback routine here */                                                  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
00071e   9c68     BCF       0x68,0x6,0x0       UIRbits.SOFIF = 0;                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
000720   0012     RETURN    0x0            }//end USB_SOF_Handler                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBStallHandler(void)                                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    A STALL packet is sent to the host by the SIE.               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Overview:        The STALLIF is set anytime the SIE sends out a STALL         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  packet regardless of which endpoint causes it.               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  A Setup transaction overrides the STALL function. A stalled  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  endpoint stops stalling once it receives a setup packet.     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  In this case, the SIE will accepts the Setup packet and      C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  set the TRNIF flag to notify the firmware. STALL function    C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  for that particular endpoint pipe will be automatically      C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  disabled (direction specific).                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  There are a few reasons for an endpoint to be stalled.       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  1. When a non-supported USB request is received.             C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                     Example: GET_DESCRIPTOR(DEVICE_QUALIFIER)                 C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  2. When an endpoint is currently halted.                     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  3. When the device class specifies that an endpoint must     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                     stall in response to a specific event.                    C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                     Example: Mass Storage Device Class                        C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                              If the CBW is not valid, the device shall        C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                              STALL the Bulk-In pipe.                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                              See USB Mass Storage Class Bulk-only Transport   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                              Specification for more details.                  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Note:            UEPn.EPSTALL can be scanned to see which endpoint causes     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  the stall event.                                             C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  If                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           void USBStallHandler(void)                                                       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           {                                                                                C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * Does not really have to do anything here,                                 C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * even for the control endpoint.                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * All BDs of Endpoint 0 are owned by SIE right now,                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * but once a Setup Transaction is received, the ownership                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * for EP0_OUT will be returned to CPU.                                      C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * When the Setup Transaction is serviced, the ownership                     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                * for EP0_IN will then be forced back to CPU by firmware.                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                */                                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
000722   a070     BTFSS     0x70,0x0,0x0       if(UEP0bits.EPSTALL == 1)                                                    C:\joyneuf\system\usb\usbdrv\usbdrv.c
000724   d003     BRA       0x72c                                                                                           
                                               {                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
000726   ec00     CALL      0x600,0x0              USBPrepareForNextSetupTrf();        // Firmware work-around              C:\joyneuf\system\usb\usbdrv\usbdrv.c
000728   f003                                                                                                               
00072a   9070     BCF       0x70,0x0,0x0           UEP0bits.EPSTALL = 0;                                                    C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                               }                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
00072c   9a68     BCF       0x68,0x5,0x0       UIRbits.STALLIF = 0;                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
00072e   0012     RETURN    0x0            }//end USBStallHandler                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBErrorHandler(void)                                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Overview:        The purpose of this interrupt is mainly for debugging        C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  during development. Check UEIR to see which error causes     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  the interrupt.                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           void USBErrorHandler(void)                                                       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           {                                                                                C:\joyneuf\system\usb\usbdrv\usbdrv.c
000730   9268     BCF       0x68,0x1,0x0       UIRbits.UERRIF = 0;                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
000732   0012     RETURN    0x0            }//end USBErrorHandler                                                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBProtocolResetHandler(void)                           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    A USB bus reset is received from the host.                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    Currently, this routine flushes any pending USB              C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  transactions. It empties out the USTAT FIFO. This action     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  might not be desirable in some applications.                 C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Overview:        Once a USB bus reset is received from the host, this         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  routine should be called. It resets the device address to    C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  zero, disables all non-EP0 endpoints, initializes EP0 to     C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  be ready for default communication, clears all USB           C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  interrupt flags, unmasks applicable USB interrupts, and      C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                  reinitializes internal state-machine variables.              C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *                                                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           void USBProtocolResetHandler(void)                                               C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           {                                                                                C:\joyneuf\system\usb\usbdrv\usbdrv.c
000734   6a6a     CLRF      0x6a,0x0           UEIR = 0;                       // Clear all USB error flags                 C:\joyneuf\system\usb\usbdrv\usbdrv.c
000736   6a68     CLRF      0x68,0x0           UIR = 0;                        // Clears all USB interrupts                 C:\joyneuf\system\usb\usbdrv\usbdrv.c
000738   0e9f     MOVLW     0x9f               UEIE = 0b10011111;              // Unmask all USB error interrupts           C:\joyneuf\system\usb\usbdrv\usbdrv.c
00073a   6e6b     MOVWF     0x6b,0x0                                                                                        
00073c   0e7b     MOVLW     0x7b               UIE = 0b01111011;               // Enable all interrupts except ACTVIE       C:\joyneuf\system\usb\usbdrv\usbdrv.c
00073e   6e69     MOVWF     0x69,0x0                                                                                        
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
000740   6a6e     CLRF      0x6e,0x0           UADDR = 0x00;                   // Reset to default address                  C:\joyneuf\system\usb\usbdrv\usbdrv.c
000742   0e0f     MOVLW     0xf                mDisableEP1to15();              // Reset all non-EP0 UEPn registers          C:\joyneuf\system\usb\usbdrv\usbdrv.c
000744   6ee6     MOVWF     0xe6,0x0                                                                                        
000746   0e71     MOVLW     0x71                                                                                            
000748   6ee6     MOVWF     0xe6,0x0                                                                                        
00074a   0e0f     MOVLW     0xf                                                                                             
00074c   6ee6     MOVWF     0xe6,0x0                                                                                        
00074e   d814     RCALL     0x778                                                                                           
000750   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000752   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000754   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000756   0e16     MOVLW     0x16               UEP0 = EP_CTRL|HSHK_EN;         // Init EP0 as a Ctrl EP, see usbdrv.h       C:\joyneuf\system\usb\usbdrv\usbdrv.c
000758   6e70     MOVWF     0x70,0x0                                                                                        
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
00075a   a668     BTFSS     0x68,0x3,0x0       while(UIRbits.TRNIF == 1)       // Flush any pending transactions            C:\joyneuf\system\usb\usbdrv\usbdrv.c
00075c   d002     BRA       0x762                                                                                           
000760   d7fc     BRA       0x75a                                                                                           
00075e   9668     BCF       0x68,0x3,0x0           UIRbits.TRNIF = 0;                                                       C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
000762   986d     BCF       0x6d,0x4,0x0       UCONbits.PKTDIS = 0;            // Make sure packet processing is enabled    C:\joyneuf\system\usb\usbdrv\usbdrv.c
000764   ec00     CALL      0x600,0x0          USBPrepareForNextSetupTrf();    // Declared in usbctrltrf.c                  C:\joyneuf\system\usb\usbdrv\usbdrv.c
000766   f003                                                                                                               
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
000768   0100     MOVLB     0x0                usb_stat.RemoteWakeup = 0;      // Default status flag to disable            C:\joyneuf\system\usb\usbdrv\usbdrv.c
00076a   9177     BCF       0x77,0x0,0x1                                                                                    
00076c   0100     MOVLB     0x0                usb_active_cfg = 0;             // Clear active configuration                C:\joyneuf\system\usb\usbdrv\usbdrv.c
00076e   6b78     CLRF      0x78,0x1                                                                                        
000770   0100     MOVLB     0x0                usb_device_state = DEFAULT_STATE;                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
000772   0e03     MOVLW     0x3                                                                                             
000774   6f76     MOVWF     0x76,0x1                                                                                        
000776   0012     RETURN    0x0            }//end USBProtocolResetHandler                                                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           /* Auxiliary Function */                                                         C:\joyneuf\system\usb\usbdrv\usbdrv.c
000778   cfd9     MOVFF     0xfd9,0xfe6    void ClearArray(byte* startAdr,byte count)                                       C:\joyneuf\system\usb\usbdrv\usbdrv.c
00077a   ffe6                                                                                                               
00077c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00077e   ffd9                                                                                                               
                                           {                                                                                C:\joyneuf\system\usb\usbdrv\usbdrv.c
000780   0efd     MOVLW     0xfd               *startAdr;                                                                   C:\joyneuf\system\usb\usbdrv\usbdrv.c
000782   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000784   ffe9                                                                                                               
000786   0efe     MOVLW     0xfe                                                                                            
000788   cfdb     MOVFF     0xfdb,0xfea                                                                                     
00078a   ffea                                                                                                               
00078c   0efc     MOVLW     0xfc               while(count)                                                                 C:\joyneuf\system\usb\usbdrv\usbdrv.c
00078e   50db     MOVF      0xdb,0x0,0x0                                                                                    
000790   e004     BZ        0x79a                                                                                           
000798   d7f9     BRA       0x78c                                                                                           
                                               {                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                   _asm                                                                     C:\joyneuf\system\usb\usbdrv\usbdrv.c
000792   6aee     CLRF      0xee,0x0               clrf POSTINC0,0                                                          C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                                   _endasm                                                                  C:\joyneuf\system\usb\usbdrv\usbdrv.c
000794   0efc     MOVLW     0xfc                   count--;                                                                 C:\joyneuf\system\usb\usbdrv\usbdrv.c
000796   06db     DECF      0xdb,0x1,0x0                                                                                    
                                               }//end while                                                                 C:\joyneuf\system\usb\usbdrv\usbdrv.c
00079a   52e5     MOVF      0xe5,0x1,0x0   }//end ClearArray                                                                C:\joyneuf\system\usb\usbdrv\usbdrv.c
00079c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00079e   ffd9                                                                                                               
0007a0   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           /** EOF usbdrv.c *************************************************************/  C:\joyneuf\system\usb\usbdrv\usbdrv.c
                                           /*********************************************************************           C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            *                Microchip USB C18 Firmware Version 1.0                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            *********************************************************************           C:\joyneuf\system\usb\usb9\usb9.c
                                            * FileName:        usb9.c                                                       C:\joyneuf\system\usb\usb9\usb9.c
                                            * Dependencies:    See INCLUDES section below                                   C:\joyneuf\system\usb\usb9\usb9.c
                                            * Processor:       PIC18                                                        C:\joyneuf\system\usb\usb9\usb9.c
                                            * Compiler:        C18 2.30.01+                                                 C:\joyneuf\system\usb\usb9\usb9.c
                                            * Company:         Microchip Technology, Inc.                                   C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Software License Agreement                                                    C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * The software supplied herewith by Microchip Technology Incorporated           C:\joyneuf\system\usb\usb9\usb9.c
                                            * (the ìCompanyî) for its PICmicroÆ Microcontroller is intended and             C:\joyneuf\system\usb\usb9\usb9.c
                                            * supplied to you, the Companyís customer, for use solely and                   C:\joyneuf\system\usb\usb9\usb9.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               C:\joyneuf\system\usb\usb9\usb9.c
                                            * software is owned by the Company and/or its supplier, and is                  C:\joyneuf\system\usb\usb9\usb9.c
                                            * protected under applicable copyright laws. All rights are reserved.           C:\joyneuf\system\usb\usb9\usb9.c
                                            * Any use in violation of the foregoing restrictions may subject the            C:\joyneuf\system\usb\usb9\usb9.c
                                            * user to criminal sanctions under applicable laws, as well as to               C:\joyneuf\system\usb\usb9\usb9.c
                                            * civil liability for the breach of the terms and conditions of this            C:\joyneuf\system\usb\usb9\usb9.c
                                            * license.                                                                      C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * THIS SOFTWARE IS PROVIDED IN AN ìAS ISî CONDITION. NO WARRANTIES,             C:\joyneuf\system\usb\usb9\usb9.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             C:\joyneuf\system\usb\usb9\usb9.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   C:\joyneuf\system\usb\usb9\usb9.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             C:\joyneuf\system\usb\usb9\usb9.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    C:\joyneuf\system\usb\usb9\usb9.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Author               Date        Comment                                      C:\joyneuf\system\usb\usb9\usb9.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           C:\joyneuf\system\usb\usb9\usb9.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    C:\joyneuf\system\usb\usb9\usb9.c
                                            ********************************************************************/           C:\joyneuf\system\usb\usb9\usb9.c
                                                                                                                            C:\joyneuf\system\usb\usb9\usb9.c
                                           /** I N C L U D E S **********************************************************/  C:\joyneuf\system\usb\usb9\usb9.c
                                           #include <p18cxxx.h>                                                             C:\joyneuf\system\usb\usb9\usb9.c
                                           #include "system\typedefs.h"                                                     C:\joyneuf\system\usb\usb9\usb9.c
                                           #include "system\usb\usb.h"                                                      C:\joyneuf\system\usb\usb9\usb9.c
                                           #include "io_cfg.h"                     // Required for self_power status        C:\joyneuf\system\usb\usb9\usb9.c
                                                                                                                            C:\joyneuf\system\usb\usb9\usb9.c
                                           /** V A R I A B L E S ********************************************************/  C:\joyneuf\system\usb\usb9\usb9.c
                                           #pragma udata                                                                    C:\joyneuf\system\usb\usb9\usb9.c
                                                                                                                            C:\joyneuf\system\usb\usb9\usb9.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  C:\joyneuf\system\usb\usb9\usb9.c
                                           void USBStdGetDscHandler(void);                                                  C:\joyneuf\system\usb\usb9\usb9.c
                                           void USBStdSetCfgHandler(void);                                                  C:\joyneuf\system\usb\usb9\usb9.c
                                           void USBStdGetStatusHandler(void);                                               C:\joyneuf\system\usb\usb9\usb9.c
                                           void USBStdFeatureReqHandler(void);                                              C:\joyneuf\system\usb\usb9\usb9.c
                                                                                                                            C:\joyneuf\system\usb\usb9\usb9.c
                                           /** D E C L A R A T I O N S **************************************************/  C:\joyneuf\system\usb\usb9\usb9.c
                                           #pragma code                                                                     C:\joyneuf\system\usb\usb9\usb9.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usb9\usb9.c
                                            * Function:        void USBCheckStdRequest(void)                                C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Overview:        This routine checks the setup data packet to see if it       C:\joyneuf\system\usb\usb9\usb9.c
                                            *                  knows how to handle it                                       C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Note:            None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usb9\usb9.c
                                           void USBCheckStdRequest(void)                                                    C:\joyneuf\system\usb\usb9\usb9.c
                                           {                                                                                C:\joyneuf\system\usb\usb9\usb9.c
00002c   0104     MOVLB     0x4                if(SetupPkt.RequestType != STANDARD) return;                                 C:\joyneuf\system\usb\usb9\usb9.c
00002e   5110     MOVF      0x10,0x0,0x1                                                                                    
000030   0b60     ANDLW     0x60                                                                                            
000032   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000034   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000036   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000038   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
00003a   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
00003c   0900     IORLW     0x0                                                                                             
00003e   e001     BZ        0x42                                                                                            
000040   d055     BRA       0xec                                                                                            
                                                                                                                            C:\joyneuf\system\usb\usb9\usb9.c
000042   5111     MOVF      0x11,0x0,0x1       switch(SetupPkt.bRequest)                                                    C:\joyneuf\system\usb\usb9\usb9.c
000044   0a07     XORLW     0x7                                                                                             
000046   e051     BZ        0xea                                                                                            
000048   0a0b     XORLW     0xb                                                                                             
00004a   e04f     BZ        0xea                                                                                            
00004c   0a07     XORLW     0x7                                                                                             
00004e   e040     BZ        0xd0                                                                                            
000050   0a01     XORLW     0x1                                                                                             
000052   e02c     BZ        0xac                                                                                            
000054   0a0b     XORLW     0xb                                                                                             
000056   e028     BZ        0xa8                                                                                            
000058   0a02     XORLW     0x2                                                                                             
00005a   e026     BZ        0xa8                                                                                            
00005c   0a03     XORLW     0x3                                                                                             
00005e   e022     BZ        0xa4                                                                                            
000060   0a08     XORLW     0x8                                                                                             
000062   e012     BZ        0x88                                                                                            
000064   0a01     XORLW     0x1                                                                                             
000066   e00e     BZ        0x84                                                                                            
000068   0a0f     XORLW     0xf                                                                                             
00006a   e00a     BZ        0x80                                                                                            
00006c   0a03     XORLW     0x3                                                                                             
00006e   e001     BZ        0x72                                                                                            
000070   d03c     BRA       0xea                                                                                            
                                               {                                                                            C:\joyneuf\system\usb\usb9\usb9.c
                                                   case SET_ADR:                                                            C:\joyneuf\system\usb\usb9\usb9.c
000072   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  C:\joyneuf\system\usb\usb9\usb9.c
000074   0e01     MOVLW     0x1                                                                                             
000076   6f6b     MOVWF     0x6b,0x1                                                                                        
000078   0100     MOVLB     0x0                        usb_device_state = ADR_PENDING_STATE;       // Update state only     C:\joyneuf\system\usb\usb9\usb9.c
00007a   0e04     MOVLW     0x4                                                                                             
00007c   6f76     MOVWF     0x76,0x1                                                                                        
                                                       /* See USBCtrlTrfInHandler() in usbctrltrf.c for the next step */    C:\joyneuf\system\usb\usb9\usb9.c
00007e   d036     BRA       0xec                       break;                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                                   case GET_DSC:                                                            C:\joyneuf\system\usb\usb9\usb9.c
000080   d836     RCALL     0xee                       USBStdGetDscHandler();                                               C:\joyneuf\system\usb\usb9\usb9.c
000082   d034     BRA       0xec                       break;                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                                   case SET_CFG:                                                            C:\joyneuf\system\usb\usb9\usb9.c
000084   d890     RCALL     0x1a6                      USBStdSetCfgHandler();                                               C:\joyneuf\system\usb\usb9\usb9.c
000086   d032     BRA       0xec                       break;                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                                   case GET_CFG:                                                            C:\joyneuf\system\usb\usb9\usb9.c
000088   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  C:\joyneuf\system\usb\usb9\usb9.c
00008a   0e01     MOVLW     0x1                                                                                             
00008c   6f6b     MOVWF     0x6b,0x1                                                                                        
00008e   0100     MOVLB     0x0                        pSrc.bRam = (byte*)&usb_active_cfg;         // Set Source            C:\joyneuf\system\usb\usb9\usb9.c
000090   0e78     MOVLW     0x78                                                                                            
000092   6f6c     MOVWF     0x6c,0x1                                                                                        
000094   0e00     MOVLW     0x0                                                                                             
000096   6f6d     MOVWF     0x6d,0x1                                                                                        
000098   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;               // Set memory type       C:\joyneuf\system\usb\usb9\usb9.c
00009a   9377     BCF       0x77,0x1,0x1                                                                                    
00009c   0100     MOVLB     0x0                        LSB(wCount) = 1;                            // Set data count        C:\joyneuf\system\usb\usb9\usb9.c
00009e   0e01     MOVLW     0x1                                                                                             
0000a0   6f70     MOVWF     0x70,0x1                                                                                        
0000a2   d024     BRA       0xec                       break;                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                                   case GET_STATUS:                                                         C:\joyneuf\system\usb\usb9\usb9.c
0000a4   d8a8     RCALL     0x1f6                      USBStdGetStatusHandler();                                            C:\joyneuf\system\usb\usb9\usb9.c
0000a6   d022     BRA       0xec                       break;                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                                   case CLR_FEATURE:                                                        C:\joyneuf\system\usb\usb9\usb9.c
                                                   case SET_FEATURE:                                                        C:\joyneuf\system\usb\usb9\usb9.c
0000a8   d8f4     RCALL     0x292                      USBStdFeatureReqHandler();                                           C:\joyneuf\system\usb\usb9\usb9.c
0000aa   d020     BRA       0xec                       break;                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                                   case GET_INTF:                                                           C:\joyneuf\system\usb\usb9\usb9.c
0000ac   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  C:\joyneuf\system\usb\usb9\usb9.c
0000ae   0e01     MOVLW     0x1                                                                                             
0000b0   6f6b     MOVWF     0x6b,0x1                                                                                        
0000b2   0104     MOVLB     0x4                        pSrc.bRam = (byte*)&usb_alt_intf+SetupPkt.bIntfID;  // Set source    C:\joyneuf\system\usb\usb9\usb9.c
0000b4   5114     MOVF      0x14,0x0,0x1                                                                                    
0000b6   0100     MOVLB     0x0                                                                                             
0000b8   6f6c     MOVWF     0x6c,0x1                                                                                        
0000ba   6b6d     CLRF      0x6d,0x1                                                                                        
0000bc   0e79     MOVLW     0x79                                                                                            
0000be   276c     ADDWF     0x6c,0x1,0x1                                                                                    
0000c0   0e00     MOVLW     0x0                                                                                             
0000c2   236d     ADDWFC    0x6d,0x1,0x1                                                                                    
0000c4   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;               // Set memory type       C:\joyneuf\system\usb\usb9\usb9.c
0000c6   9377     BCF       0x77,0x1,0x1                                                                                    
0000c8   0100     MOVLB     0x0                        LSB(wCount) = 1;                            // Set data count        C:\joyneuf\system\usb\usb9\usb9.c
0000ca   0e01     MOVLW     0x1                                                                                             
0000cc   6f70     MOVWF     0x70,0x1                                                                                        
0000ce   d00e     BRA       0xec                       break;                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                                   case SET_INTF:                                                           C:\joyneuf\system\usb\usb9\usb9.c
0000d0   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  C:\joyneuf\system\usb\usb9\usb9.c
0000d2   0e01     MOVLW     0x1                                                                                             
0000d4   6f6b     MOVWF     0x6b,0x1                                                                                        
0000d6   0104     MOVLB     0x4                        usb_alt_intf[SetupPkt.bIntfID] = SetupPkt.bAltID;                    C:\joyneuf\system\usb\usb9\usb9.c
0000d8   5114     MOVF      0x14,0x0,0x1                                                                                    
0000da   6aea     CLRF      0xea,0x0                                                                                        
0000dc   0f79     ADDLW     0x79                                                                                            
0000de   6ee9     MOVWF     0xe9,0x0                                                                                        
0000e0   0e00     MOVLW     0x0                                                                                             
0000e2   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0000e4   c412     MOVFF     0x412,0xfef                                                                                     
0000e6   ffef                                                                                                               
0000e8   d001     BRA       0xec                       break;                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                                   case SET_DSC:                                                            C:\joyneuf\system\usb\usb9\usb9.c
                                                   case SYNCH_FRAME:                                                        C:\joyneuf\system\usb\usb9\usb9.c
                                                   default:                                                                 C:\joyneuf\system\usb\usb9\usb9.c
0000ea   d000     BRA       0xec                       break;                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                               }//end switch                                                                C:\joyneuf\system\usb\usb9\usb9.c
                                                                                                                            C:\joyneuf\system\usb\usb9\usb9.c
0000ec   0012     RETURN    0x0            }//end USBCheckStdRequest                                                        C:\joyneuf\system\usb\usb9\usb9.c
                                                                                                                            C:\joyneuf\system\usb\usb9\usb9.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usb9\usb9.c
                                            * Function:        void USBStdGetDscHandler(void)                               C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Overview:        This routine handles the standard GET_DESCRIPTOR request.    C:\joyneuf\system\usb\usb9\usb9.c
                                            *                  It utilizes tables dynamically looks up descriptor size.     C:\joyneuf\system\usb\usb9\usb9.c
                                            *                  This routine should never have to be modified if the tables  C:\joyneuf\system\usb\usb9\usb9.c
                                            *                  in usbdsc.c are declared correctly.                          C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Note:            None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usb9\usb9.c
                                           void USBStdGetDscHandler(void)                                                   C:\joyneuf\system\usb\usb9\usb9.c
                                           {                                                                                C:\joyneuf\system\usb\usb9\usb9.c
0000ee   0e80     MOVLW     0x80               if(SetupPkt.bmRequestType == 0x80)                                           C:\joyneuf\system\usb\usb9\usb9.c
0000f0   0104     MOVLB     0x4                                                                                             
0000f2   5d10     SUBWF     0x10,0x0,0x1                                                                                    
0000f4   e157     BNZ       0x1a4                                                                                           
                                               {                                                                            C:\joyneuf\system\usb\usb9\usb9.c
0000f6   5113     MOVF      0x13,0x0,0x1           switch(SetupPkt.bDscType)                                                C:\joyneuf\system\usb\usb9\usb9.c
0000f8   0a03     XORLW     0x3                                                                                             
0000fa   e034     BZ        0x164                                                                                           
0000fc   0a01     XORLW     0x1                                                                                             
0000fe   e010     BZ        0x120                                                                                           
000100   0a03     XORLW     0x3                                                                                             
000102   e001     BZ        0x106                                                                                           
000104   d04d     BRA       0x1a0                                                                                           
                                                   {                                                                        C:\joyneuf\system\usb\usb9\usb9.c
                                                       case DSC_DEV:                                                        C:\joyneuf\system\usb\usb9\usb9.c
000106   0100     MOVLB     0x0                            ctrl_trf_session_owner = MUID_USB9;                              C:\joyneuf\system\usb\usb9\usb9.c
000108   0e01     MOVLW     0x1                                                                                             
00010a   6f6b     MOVWF     0x6b,0x1                                                                                        
00010c   0100     MOVLB     0x0                            pSrc.bRom = (rom byte*)&device_dsc;                              C:\joyneuf\system\usb\usb9\usb9.c
00010e   0e2a     MOVLW     0x2a                                                                                            
000110   6f6c     MOVWF     0x6c,0x1                                                                                        
000112   0e0a     MOVLW     0xa                                                                                             
000114   6f6d     MOVWF     0x6d,0x1                                                                                        
000116   0e12     MOVLW     0x12                           wCount._word = sizeof(device_dsc);          // Set data count    C:\joyneuf\system\usb\usb9\usb9.c
000118   0100     MOVLB     0x0                                                                                             
00011a   6f70     MOVWF     0x70,0x1                                                                                        
00011c   6b71     CLRF      0x71,0x1                                                                                        
00011e   d040     BRA       0x1a0                          break;                                                           C:\joyneuf\system\usb\usb9\usb9.c
                                                       case DSC_CFG:                                                        C:\joyneuf\system\usb\usb9\usb9.c
000120   0100     MOVLB     0x0                            ctrl_trf_session_owner = MUID_USB9;                              C:\joyneuf\system\usb\usb9\usb9.c
000122   0e01     MOVLW     0x1                                                                                             
000124   6f6b     MOVWF     0x6b,0x1                                                                                        
000126   0104     MOVLB     0x4                            pSrc.bRom = *(USB_CD_Ptr+SetupPkt.bDscIndex);                    C:\joyneuf\system\usb\usb9\usb9.c
000128   5112     MOVF      0x12,0x0,0x1                                                                                    
00012a   6ef6     MOVWF     0xf6,0x0                                                                                        
00012c   6af7     CLRF      0xf7,0x0                                                                                        
00012e   90d8     BCF       0xd8,0x0,0x0                                                                                    
000130   36f6     RLCF      0xf6,0x1,0x0                                                                                    
000132   36f7     RLCF      0xf7,0x1,0x0                                                                                    
000134   0e13     MOVLW     0x13                                                                                            
000136   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
000138   0e0b     MOVLW     0xb                                                                                             
00013a   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
00013c   0009     TBLRDPOSTINC                                                                                              
00013e   cff5     MOVFF     0xff5,0x6c                                                                                      
000140   f06c                                                                                                               
000142   000a     TBLRDPOSTDEC                                                                                              
000144   cff5     MOVFF     0xff5,0x6d                                                                                      
000146   f06d                                                                                                               
000148   0e02     MOVLW     0x2                            wCount._word = *(pSrc.wRom+1);              // Set data count    C:\joyneuf\system\usb\usb9\usb9.c
00014a   0100     MOVLB     0x0                                                                                             
00014c   6af7     CLRF      0xf7,0x0                                                                                        
00014e   256c     ADDWF     0x6c,0x0,0x1                                                                                    
000150   6ef6     MOVWF     0xf6,0x0                                                                                        
000152   516d     MOVF      0x6d,0x0,0x1                                                                                    
000154   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
000156   0009     TBLRDPOSTINC                                                                                              
000158   cff5     MOVFF     0xff5,0x70                                                                                      
00015a   f070                                                                                                               
00015c   000a     TBLRDPOSTDEC                                                                                              
00015e   cff5     MOVFF     0xff5,0x71                                                                                      
000160   f071                                                                                                               
000162   d01e     BRA       0x1a0                          break;                                                           C:\joyneuf\system\usb\usb9\usb9.c
                                                       case DSC_STR:                                                        C:\joyneuf\system\usb\usb9\usb9.c
000164   0100     MOVLB     0x0                            ctrl_trf_session_owner = MUID_USB9;                              C:\joyneuf\system\usb\usb9\usb9.c
000166   0e01     MOVLW     0x1                                                                                             
000168   6f6b     MOVWF     0x6b,0x1                                                                                        
00016a   0104     MOVLB     0x4                            pSrc.bRom = *(USB_SD_Ptr+SetupPkt.bDscIndex);                    C:\joyneuf\system\usb\usb9\usb9.c
00016c   5112     MOVF      0x12,0x0,0x1                                                                                    
00016e   6ef6     MOVWF     0xf6,0x0                                                                                        
000170   6af7     CLRF      0xf7,0x0                                                                                        
000172   90d8     BCF       0xd8,0x0,0x0                                                                                    
000174   36f6     RLCF      0xf6,0x1,0x0                                                                                    
000176   36f7     RLCF      0xf7,0x1,0x0                                                                                    
000178   0e17     MOVLW     0x17                                                                                            
00017a   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
00017c   0e0b     MOVLW     0xb                                                                                             
00017e   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
000180   0009     TBLRDPOSTINC                                                                                              
000182   cff5     MOVFF     0xff5,0x6c                                                                                      
000184   f06c                                                                                                               
000186   000a     TBLRDPOSTDEC                                                                                              
000188   cff5     MOVFF     0xff5,0x6d                                                                                      
00018a   f06d                                                                                                               
00018c   c06c     MOVFF     0x6c,0xff6                     wCount._word = *pSrc.bRom;                  // Set data count    C:\joyneuf\system\usb\usb9\usb9.c
00018e   fff6                                                                                                               
000190   c06d     MOVFF     0x6d,0xff7                                                                                      
000192   fff7                                                                                                               
000194   0008     TBLRD                                                                                                     
000196   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000198   0100     MOVLB     0x0                                                                                             
00019a   6f70     MOVWF     0x70,0x1                                                                                        
00019c   6b71     CLRF      0x71,0x1                                                                                        
00019e   d000     BRA       0x1a0                          break;                                                           C:\joyneuf\system\usb\usb9\usb9.c
                                                   }//end switch                                                            C:\joyneuf\system\usb\usb9\usb9.c
                                                                                                                            C:\joyneuf\system\usb\usb9\usb9.c
0001a0   0100     MOVLB     0x0                    usb_stat.ctrl_trf_mem = _ROM;                       // Set memory type   C:\joyneuf\system\usb\usb9\usb9.c
0001a2   8377     BSF       0x77,0x1,0x1                                                                                    
                                               }//end if                                                                    C:\joyneuf\system\usb\usb9\usb9.c
0001a4   0012     RETURN    0x0            }//end USBStdGetDscHandler                                                       C:\joyneuf\system\usb\usb9\usb9.c
                                                                                                                            C:\joyneuf\system\usb\usb9\usb9.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usb9\usb9.c
                                            * Function:        void USBStdSetCfgHandler(void)                               C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Overview:        This routine first disables all endpoints by clearing        C:\joyneuf\system\usb\usb9\usb9.c
                                            *                  UEP registers. It then configures (initializes) endpoints    C:\joyneuf\system\usb\usb9\usb9.c
                                            *                  specified in the modifiable section.                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Note:            None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usb9\usb9.c
                                           void USBStdSetCfgHandler(void)                                                   C:\joyneuf\system\usb\usb9\usb9.c
                                           {                                                                                C:\joyneuf\system\usb\usb9\usb9.c
0001a6   0100     MOVLB     0x0                ctrl_trf_session_owner = MUID_USB9;                                          C:\joyneuf\system\usb\usb9\usb9.c
0001a8   0e01     MOVLW     0x1                                                                                             
0001aa   6f6b     MOVWF     0x6b,0x1                                                                                        
0001ac   0e0f     MOVLW     0xf                mDisableEP1to15();                          // See usbdrv.h                  C:\joyneuf\system\usb\usb9\usb9.c
0001ae   6ee6     MOVWF     0xe6,0x0                                                                                        
0001b0   0e71     MOVLW     0x71                                                                                            
0001b2   6ee6     MOVWF     0xe6,0x0                                                                                        
0001b4   0e0f     MOVLW     0xf                                                                                             
0001b6   6ee6     MOVWF     0xe6,0x0                                                                                        
0001b8   ecbc     CALL      0x778,0x0                                                                                       
0001ba   f003                                                                                                               
0001bc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001be   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001c0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001c2   0e01     MOVLW     0x1                ClearArray((byte*)&usb_alt_intf,MAX_NUM_INT);                                C:\joyneuf\system\usb\usb9\usb9.c
0001c4   6ee6     MOVWF     0xe6,0x0                                                                                        
0001c6   0e79     MOVLW     0x79                                                                                            
0001c8   6ee6     MOVWF     0xe6,0x0                                                                                        
0001ca   0e00     MOVLW     0x0                                                                                             
0001cc   6ee6     MOVWF     0xe6,0x0                                                                                        
0001ce   ecbc     CALL      0x778,0x0                                                                                       
0001d0   f003                                                                                                               
0001d2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001d4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001d6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001d8   c412     MOVFF     0x412,0x78         usb_active_cfg = SetupPkt.bCfgValue;                                         C:\joyneuf\system\usb\usb9\usb9.c
0001da   f078                                                                                                               
0001dc   0104     MOVLB     0x4                if(SetupPkt.bCfgValue == 0)                                                  C:\joyneuf\system\usb\usb9\usb9.c
0001de   5112     MOVF      0x12,0x0,0x1                                                                                    
0001e0   e104     BNZ       0x1ea                                                                                           
0001e2   0100     MOVLB     0x0                    usb_device_state = ADDRESS_STATE;                                        C:\joyneuf\system\usb\usb9\usb9.c
0001e4   0e05     MOVLW     0x5                                                                                             
0001e6   6f76     MOVWF     0x76,0x1                                                                                        
0001e8   d005     BRA       0x1f4              else                                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                               {                                                                            C:\joyneuf\system\usb\usb9\usb9.c
0001ea   0100     MOVLB     0x0                    usb_device_state = CONFIGURED_STATE;                                     C:\joyneuf\system\usb\usb9\usb9.c
0001ec   0e06     MOVLW     0x6                                                                                             
0001ee   6f76     MOVWF     0x76,0x1                                                                                        
                                                                                                                            C:\joyneuf\system\usb\usb9\usb9.c
                                                   /* Modifiable Section */                                                 C:\joyneuf\system\usb\usb9\usb9.c
                                                                                                                            C:\joyneuf\system\usb\usb9\usb9.c
                                                   #if defined(USB_USE_HID)                // See autofiles\usbcfg.h        C:\joyneuf\system\usb\usb9\usb9.c
0001f0   ec85     CALL      0x90a,0x0              HIDInitEP();                                                             C:\joyneuf\system\usb\usb9\usb9.c
0001f2   f004                                                                                                               
                                                   #endif                                                                   C:\joyneuf\system\usb\usb9\usb9.c
                                                                                                                            C:\joyneuf\system\usb\usb9\usb9.c
                                                   /* End modifiable section */                                             C:\joyneuf\system\usb\usb9\usb9.c
                                                                                                                            C:\joyneuf\system\usb\usb9\usb9.c
                                               }//end if(SetupPkt.bcfgValue == 0)                                           C:\joyneuf\system\usb\usb9\usb9.c
0001f4   0012     RETURN    0x0            }//end USBStdSetCfgHandler                                                       C:\joyneuf\system\usb\usb9\usb9.c
                                                                                                                            C:\joyneuf\system\usb\usb9\usb9.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usb9\usb9.c
                                            * Function:        void USBStdGetStatusHandler(void)                            C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Overview:        This routine handles the standard GET_STATUS request         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Note:            None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usb9\usb9.c
                                           void USBStdGetStatusHandler(void)                                                C:\joyneuf\system\usb\usb9\usb9.c
                                           {                                                                                C:\joyneuf\system\usb\usb9\usb9.c
0001f6   0104     MOVLB     0x4                CtrlTrfData._byte0 = 0;                         // Initialize content        C:\joyneuf\system\usb\usb9\usb9.c
0001f8   6b18     CLRF      0x18,0x1                                                                                        
0001fa   6b19     CLRF      0x19,0x1           CtrlTrfData._byte1 = 0;                                                      C:\joyneuf\system\usb\usb9\usb9.c
                                                                                                                            C:\joyneuf\system\usb\usb9\usb9.c
0001fc   0104     MOVLB     0x4                switch(SetupPkt.Recipient)                                                   C:\joyneuf\system\usb\usb9\usb9.c
0001fe   5110     MOVF      0x10,0x0,0x1                                                                                    
000200   0b1f     ANDLW     0x1f                                                                                            
000202   0a02     XORLW     0x2                                                                                             
000204   e014     BZ        0x22e                                                                                           
000206   0a03     XORLW     0x3                                                                                             
000208   e00e     BZ        0x226                                                                                           
00020a   0a01     XORLW     0x1                                                                                             
00020c   e001     BZ        0x210                                                                                           
00020e   d033     BRA       0x276                                                                                           
                                               {                                                                            C:\joyneuf\system\usb\usb9\usb9.c
                                                   case RCPT_DEV:                                                           C:\joyneuf\system\usb\usb9\usb9.c
000210   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  C:\joyneuf\system\usb\usb9\usb9.c
000212   0e01     MOVLW     0x1                                                                                             
000214   6f6b     MOVWF     0x6b,0x1                                                                                        
                                                       /*                                                                   C:\joyneuf\system\usb\usb9\usb9.c
                                                        * _byte0: bit0: Self-Powered Status [0] Bus-Powered [1] Self-Powered C:\joyneuf\system\usb\usb9\usb9.c
                                                        *         bit1: RemoteWakeup        [0] Disabled    [1] Enabled     C:\joyneuf\system\usb\usb9\usb9.c
                                                        */                                                                  C:\joyneuf\system\usb\usb9\usb9.c
                                                       if(self_power == 1)                     // self_power defined in io_cfg.h C:\joyneuf\system\usb\usb9\usb9.c
000216   0104     MOVLB     0x4                            CtrlTrfData._byte0|=0b000000001;    // Set bit0                  C:\joyneuf\system\usb\usb9\usb9.c
000218   8118     BSF       0x18,0x0,0x1                                                                                    
                                                                                                                            C:\joyneuf\system\usb\usb9\usb9.c
00021a   0100     MOVLB     0x0                        if(usb_stat.RemoteWakeup == 1)          // usb_stat defined in usbmmap.c C:\joyneuf\system\usb\usb9\usb9.c
00021c   a177     BTFSS     0x77,0x0,0x1                                                                                    
00021e   d002     BRA       0x224                                                                                           
000220   0104     MOVLB     0x4                            CtrlTrfData._byte0|=0b00000010;     // Set bit1                  C:\joyneuf\system\usb\usb9\usb9.c
000222   8318     BSF       0x18,0x1,0x1                                                                                    
000224   d028     BRA       0x276                      break;                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                                   case RCPT_INTF:                                                          C:\joyneuf\system\usb\usb9\usb9.c
000226   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;     // No data to update         C:\joyneuf\system\usb\usb9\usb9.c
000228   0e01     MOVLW     0x1                                                                                             
00022a   6f6b     MOVWF     0x6b,0x1                                                                                        
00022c   d024     BRA       0x276                      break;                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                                   case RCPT_EP:                                                            C:\joyneuf\system\usb\usb9\usb9.c
00022e   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  C:\joyneuf\system\usb\usb9\usb9.c
000230   0e01     MOVLW     0x1                                                                                             
000232   6f6b     MOVWF     0x6b,0x1                                                                                        
                                                       /*                                                                   C:\joyneuf\system\usb\usb9\usb9.c
                                                        * _byte0: bit0: Halt Status [0] Not Halted [1] Halted               C:\joyneuf\system\usb\usb9\usb9.c
                                                        */                                                                  C:\joyneuf\system\usb\usb9\usb9.c
000234   0104     MOVLB     0x4                        pDst.bRam = (byte*)&ep0Bo+(SetupPkt.EPNum*8)+(SetupPkt.EPDir*4);     C:\joyneuf\system\usb\usb9\usb9.c
000236   5114     MOVF      0x14,0x0,0x1                                                                                    
000238   0b0f     ANDLW     0xf                                                                                             
00023a   0d08     MULLW     0x8                                                                                             
00023c   50f3     MOVF      0xf3,0x0,0x0                                                                                    
00023e   6a03     CLRF      0x3,0x0                                                                                         
000240   0f00     ADDLW     0x0                                                                                             
000242   6e02     MOVWF     0x2,0x0                                                                                         
000244   0e04     MOVLW     0x4                                                                                             
000246   2203     ADDWFC    0x3,0x1,0x0                                                                                     
000248   5114     MOVF      0x14,0x0,0x1                                                                                    
00024a   0b80     ANDLW     0x80                                                                                            
00024c   e001     BZ        0x250                                                                                           
00024e   0e01     MOVLW     0x1                                                                                             
000250   0d04     MULLW     0x4                                                                                             
000252   50f3     MOVF      0xf3,0x0,0x0                                                                                    
000254   0100     MOVLB     0x0                                                                                             
000256   2402     ADDWF     0x2,0x0,0x0                                                                                     
000258   6f6e     MOVWF     0x6e,0x1                                                                                        
00025a   0e00     MOVLW     0x0                                                                                             
00025c   2003     ADDWFC    0x3,0x0,0x0                                                                                     
00025e   6f6f     MOVWF     0x6f,0x1                                                                                        
000260   c06e     MOVFF     0x6e,0xfe9                 if(*pDst.bRam & _BSTALL)    // Use _BSTALL as a bit mask             C:\joyneuf\system\usb\usb9\usb9.c
000262   ffe9                                                                                                               
000264   c06f     MOVFF     0x6f,0xfea                                                                                      
000266   ffea                                                                                                               
000268   50ef     MOVF      0xef,0x0,0x0                                                                                    
00026a   0b04     ANDLW     0x4                                                                                             
00026c   e003     BZ        0x274                                                                                           
00026e   0104     MOVLB     0x4                            CtrlTrfData._byte0=0x01;// Set bit0                              C:\joyneuf\system\usb\usb9\usb9.c
000270   0e01     MOVLW     0x1                                                                                             
000272   6f18     MOVWF     0x18,0x1                                                                                        
000274   d000     BRA       0x276                      break;                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                               }//end switch                                                                C:\joyneuf\system\usb\usb9\usb9.c
                                                                                                                            C:\joyneuf\system\usb\usb9\usb9.c
000276   0100     MOVLB     0x0                if(ctrl_trf_session_owner == MUID_USB9)                                      C:\joyneuf\system\usb\usb9\usb9.c
000278   056b     DECF      0x6b,0x0,0x1                                                                                    
00027a   e10a     BNZ       0x290                                                                                           
                                               {                                                                            C:\joyneuf\system\usb\usb9\usb9.c
00027c   0100     MOVLB     0x0                    pSrc.bRam = (byte*)&CtrlTrfData;            // Set Source                C:\joyneuf\system\usb\usb9\usb9.c
00027e   0e18     MOVLW     0x18                                                                                            
000280   6f6c     MOVWF     0x6c,0x1                                                                                        
000282   0e04     MOVLW     0x4                                                                                             
000284   6f6d     MOVWF     0x6d,0x1                                                                                        
000286   0100     MOVLB     0x0                    usb_stat.ctrl_trf_mem = _RAM;               // Set memory type           C:\joyneuf\system\usb\usb9\usb9.c
000288   9377     BCF       0x77,0x1,0x1                                                                                    
00028a   0100     MOVLB     0x0                    LSB(wCount) = 2;                            // Set data count            C:\joyneuf\system\usb\usb9\usb9.c
00028c   0e02     MOVLW     0x2                                                                                             
00028e   6f70     MOVWF     0x70,0x1                                                                                        
                                               }//end if(...)                                                               C:\joyneuf\system\usb\usb9\usb9.c
000290   0012     RETURN    0x0            }//end USBStdGetStatusHandler                                                    C:\joyneuf\system\usb\usb9\usb9.c
                                                                                                                            C:\joyneuf\system\usb\usb9\usb9.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usb9\usb9.c
                                            * Function:        void USBStdFeatureReqHandler(void)                           C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Overview:        This routine handles the standard SET & CLEAR FEATURES       C:\joyneuf\system\usb\usb9\usb9.c
                                            *                  requests                                                     C:\joyneuf\system\usb\usb9\usb9.c
                                            *                                                                               C:\joyneuf\system\usb\usb9\usb9.c
                                            * Note:            None                                                         C:\joyneuf\system\usb\usb9\usb9.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usb9\usb9.c
                                           void USBStdFeatureReqHandler(void)                                               C:\joyneuf\system\usb\usb9\usb9.c
                                           {                                                                                C:\joyneuf\system\usb\usb9\usb9.c
000292   0104     MOVLB     0x4                if((SetupPkt.bFeature == DEVICE_REMOTE_WAKEUP)&&                             C:\joyneuf\system\usb\usb9\usb9.c
000294   0512     DECF      0x12,0x0,0x1                                                                                    
000296   e110     BNZ       0x2b8                 (SetupPkt.Recipient == RCPT_DEV))                                         C:\joyneuf\system\usb\usb9\usb9.c
000298   5110     MOVF      0x10,0x0,0x1                                                                                    
00029a   0b1f     ANDLW     0x1f                                                                                            
00029c   0900     IORLW     0x0                                                                                             
00029e   e10c     BNZ       0x2b8                                                                                           
                                               {                                                                            C:\joyneuf\system\usb\usb9\usb9.c
0002a0   0100     MOVLB     0x0                    ctrl_trf_session_owner = MUID_USB9;                                      C:\joyneuf\system\usb\usb9\usb9.c
0002a2   0e01     MOVLW     0x1                                                                                             
0002a4   6f6b     MOVWF     0x6b,0x1                                                                                        
0002a6   0e03     MOVLW     0x3                    if(SetupPkt.bRequest == SET_FEATURE)                                     C:\joyneuf\system\usb\usb9\usb9.c
0002a8   0104     MOVLB     0x4                                                                                             
0002aa   5d11     SUBWF     0x11,0x0,0x1                                                                                    
0002ac   e103     BNZ       0x2b4                                                                                           
0002ae   0100     MOVLB     0x0                        usb_stat.RemoteWakeup = 1;                                           C:\joyneuf\system\usb\usb9\usb9.c
0002b0   8177     BSF       0x77,0x0,0x1                                                                                    
0002b2   d002     BRA       0x2b8                  else                                                                     C:\joyneuf\system\usb\usb9\usb9.c
0002b4   0100     MOVLB     0x0                        usb_stat.RemoteWakeup = 0;                                           C:\joyneuf\system\usb\usb9\usb9.c
0002b6   9177     BCF       0x77,0x0,0x1                                                                                    
                                               }//end if                                                                    C:\joyneuf\system\usb\usb9\usb9.c
                                                                                                                            C:\joyneuf\system\usb\usb9\usb9.c
0002b8   0104     MOVLB     0x4                if((SetupPkt.bFeature == ENDPOINT_HALT)&&                                    C:\joyneuf\system\usb\usb9\usb9.c
0002ba   5112     MOVF      0x12,0x0,0x1                                                                                    
0002bc   e13a     BNZ       0x332                 (SetupPkt.Recipient == RCPT_EP)&&                                         C:\joyneuf\system\usb\usb9\usb9.c
0002be   5110     MOVF      0x10,0x0,0x1                                                                                    
0002c0   0b1f     ANDLW     0x1f                                                                                            
0002c2   0802     SUBLW     0x2                                                                                             
0002c4   e136     BNZ       0x332                                                                                           
0002c6   5114     MOVF      0x14,0x0,0x1          (SetupPkt.EPNum != 0))                                                    C:\joyneuf\system\usb\usb9\usb9.c
0002c8   0b0f     ANDLW     0xf                                                                                             
0002ca   0900     IORLW     0x0                                                                                             
0002cc   e032     BZ        0x332                                                                                           
                                               {                                                                            C:\joyneuf\system\usb\usb9\usb9.c
0002ce   0100     MOVLB     0x0                    ctrl_trf_session_owner = MUID_USB9;                                      C:\joyneuf\system\usb\usb9\usb9.c
0002d0   0e01     MOVLW     0x1                                                                                             
0002d2   6f6b     MOVWF     0x6b,0x1                                                                                        
                                                   /* Must do address calculation here */                                   C:\joyneuf\system\usb\usb9\usb9.c
0002d4   0104     MOVLB     0x4                    pDst.bRam = (byte*)&ep0Bo+(SetupPkt.EPNum*8)+(SetupPkt.EPDir*4);         C:\joyneuf\system\usb\usb9\usb9.c
0002d6   5114     MOVF      0x14,0x0,0x1                                                                                    
0002d8   0b0f     ANDLW     0xf                                                                                             
0002da   0d08     MULLW     0x8                                                                                             
0002dc   50f3     MOVF      0xf3,0x0,0x0                                                                                    
0002de   6a03     CLRF      0x3,0x0                                                                                         
0002e0   0f00     ADDLW     0x0                                                                                             
0002e2   6e02     MOVWF     0x2,0x0                                                                                         
0002e4   0e04     MOVLW     0x4                                                                                             
0002e6   2203     ADDWFC    0x3,0x1,0x0                                                                                     
0002e8   5114     MOVF      0x14,0x0,0x1                                                                                    
0002ea   0b80     ANDLW     0x80                                                                                            
0002ec   e001     BZ        0x2f0                                                                                           
0002ee   0e01     MOVLW     0x1                                                                                             
0002f0   0d04     MULLW     0x4                                                                                             
0002f2   50f3     MOVF      0xf3,0x0,0x0                                                                                    
0002f4   0100     MOVLB     0x0                                                                                             
0002f6   2402     ADDWF     0x2,0x0,0x0                                                                                     
0002f8   6f6e     MOVWF     0x6e,0x1                                                                                        
0002fa   0e00     MOVLW     0x0                                                                                             
0002fc   2003     ADDWFC    0x3,0x0,0x0                                                                                     
0002fe   6f6f     MOVWF     0x6f,0x1                                                                                        
                                                                                                                            C:\joyneuf\system\usb\usb9\usb9.c
000300   0e03     MOVLW     0x3                    if(SetupPkt.bRequest == SET_FEATURE)                                     C:\joyneuf\system\usb\usb9\usb9.c
000302   0104     MOVLB     0x4                                                                                             
000304   5d11     SUBWF     0x11,0x0,0x1                                                                                    
000306   e107     BNZ       0x316                                                                                           
000308   0e84     MOVLW     0x84                       *pDst.bRam = _USIE|_BSTALL;                                          C:\joyneuf\system\usb\usb9\usb9.c
00030a   c06e     MOVFF     0x6e,0xfe9                                                                                      
00030c   ffe9                                                                                                               
00030e   c06f     MOVFF     0x6f,0xfea                                                                                      
000310   ffea                                                                                                               
000312   6eef     MOVWF     0xef,0x0                                                                                        
000314   d00e     BRA       0x332                  else                                                                     C:\joyneuf\system\usb\usb9\usb9.c
                                                   {                                                                        C:\joyneuf\system\usb\usb9\usb9.c
000316   af14     BTFSS     0x14,0x7,0x1               if(SetupPkt.EPDir == 1) // IN                                        C:\joyneuf\system\usb\usb9\usb9.c
000318   d006     BRA       0x326                                                                                           
00031a   c06e     MOVFF     0x6e,0xfe9                     *pDst.bRam = _UCPU;                                              C:\joyneuf\system\usb\usb9\usb9.c
00031c   ffe9                                                                                                               
00031e   c06f     MOVFF     0x6f,0xfea                                                                                      
000320   ffea                                                                                                               
000322   6aef     CLRF      0xef,0x0                                                                                        
000324   d006     BRA       0x332                      else                                                                 C:\joyneuf\system\usb\usb9\usb9.c
000326   0e88     MOVLW     0x88                           *pDst.bRam = _USIE|_DAT0|_DTSEN;                                 C:\joyneuf\system\usb\usb9\usb9.c
000328   c06e     MOVFF     0x6e,0xfe9                                                                                      
00032a   ffe9                                                                                                               
00032c   c06f     MOVFF     0x6f,0xfea                                                                                      
00032e   ffea                                                                                                               
000330   6eef     MOVWF     0xef,0x0                                                                                        
                                                   }//end if                                                                C:\joyneuf\system\usb\usb9\usb9.c
                                               }//end if                                                                    C:\joyneuf\system\usb\usb9\usb9.c
000332   0012     RETURN    0x0            }//end USBStdFeatureReqHandler                                                   C:\joyneuf\system\usb\usb9\usb9.c
                                                                                                                            C:\joyneuf\system\usb\usb9\usb9.c
                                           /** EOF usb9.c ***************************************************************/  C:\joyneuf\system\usb\usb9\usb9.c
                                           /*********************************************************************           C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            *                Microchip USB C18 Firmware Version 1.0                         C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            *********************************************************************           C:\joyneuf\autofiles\usbdsc.c
                                            * FileName:        usbdsc.c                                                     C:\joyneuf\autofiles\usbdsc.c
                                            * Dependencies:    See INCLUDES section below                                   C:\joyneuf\autofiles\usbdsc.c
                                            * Processor:       PIC18                                                        C:\joyneuf\autofiles\usbdsc.c
                                            * Compiler:        C18 2.30.01+                                                 C:\joyneuf\autofiles\usbdsc.c
                                            * Company:         Microchip Technology, Inc.                                   C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            * Software License Agreement                                                    C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            * The software supplied herewith by Microchip Technology Incorporated           C:\joyneuf\autofiles\usbdsc.c
                                            * (the ìCompanyÅE for its PICmicroÆ Microcontroller is intended and             C:\joyneuf\autofiles\usbdsc.c
                                            * supplied to you, the Companyís customer, for use solely and                   C:\joyneuf\autofiles\usbdsc.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               C:\joyneuf\autofiles\usbdsc.c
                                            * software is owned by the Company and/or its supplier, and is                  C:\joyneuf\autofiles\usbdsc.c
                                            * protected under applicable copyright laws. All rights are reserved.           C:\joyneuf\autofiles\usbdsc.c
                                            * Any use in violation of the foregoing restrictions may subject the            C:\joyneuf\autofiles\usbdsc.c
                                            * user to criminal sanctions under applicable laws, as well as to               C:\joyneuf\autofiles\usbdsc.c
                                            * civil liability for the breach of the terms and conditions of this            C:\joyneuf\autofiles\usbdsc.c
                                            * license.                                                                      C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            * THIS SOFTWARE IS PROVIDED IN AN ìAS ISÅECONDITION. NO WARRANTIES,             C:\joyneuf\autofiles\usbdsc.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             C:\joyneuf\autofiles\usbdsc.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   C:\joyneuf\autofiles\usbdsc.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             C:\joyneuf\autofiles\usbdsc.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    C:\joyneuf\autofiles\usbdsc.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            ********************************************************************/           C:\joyneuf\autofiles\usbdsc.c
                                                                                                                            C:\joyneuf\autofiles\usbdsc.c
                                           /*********************************************************************           C:\joyneuf\autofiles\usbdsc.c
                                            * -usbdsc.c-                                                                    C:\joyneuf\autofiles\usbdsc.c
                                            * This file contains the USB descriptor information. It is used                 C:\joyneuf\autofiles\usbdsc.c
                                            * in conjunction with the usbdsc.h file. When a descriptor is added             C:\joyneuf\autofiles\usbdsc.c
                                            * or removed from the main configuration descriptor, i.e. CFG01,                C:\joyneuf\autofiles\usbdsc.c
                                            * the user must also change the descriptor structure defined in                 C:\joyneuf\autofiles\usbdsc.c
                                            * the usbdsc.h file. The structure is used to calculate the                     C:\joyneuf\autofiles\usbdsc.c
                                            * descriptor size, i.e. sizeof(CFG01).                                          C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            * A typical configuration descriptor consists of:                               C:\joyneuf\autofiles\usbdsc.c
                                            * At least one configuration descriptor (USB_CFG_DSC)                           C:\joyneuf\autofiles\usbdsc.c
                                            * One or more interface descriptors (USB_INTF_DSC)                              C:\joyneuf\autofiles\usbdsc.c
                                            * One or more endpoint descriptors (USB_EP_DSC)                                 C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            * Naming Convention:                                                            C:\joyneuf\autofiles\usbdsc.c
                                            * To resolve ambiguity, the naming convention are as followed:                  C:\joyneuf\autofiles\usbdsc.c
                                            * - USB_CFG_DSC type should be named cdxx, where xx is the                      C:\joyneuf\autofiles\usbdsc.c
                                            *   configuration number. This number should match the actual                   C:\joyneuf\autofiles\usbdsc.c
                                            *   index value of this configuration.                                          C:\joyneuf\autofiles\usbdsc.c
                                            * - USB_INTF_DSC type should be named i<yy>a<zz>, where yy is the               C:\joyneuf\autofiles\usbdsc.c
                                            *   interface number and zz is the alternate interface number.                  C:\joyneuf\autofiles\usbdsc.c
                                            * - USB_EP_DSC type should be named ep<##><d>_i<yy>a<zz>, where                 C:\joyneuf\autofiles\usbdsc.c
                                            *   ## is the endpoint number and d is the direction of transfer.               C:\joyneuf\autofiles\usbdsc.c
                                            *   The interface name should also be listed as a suffix to identify            C:\joyneuf\autofiles\usbdsc.c
                                            *   which interface does the endpoint belong to.                                C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            * Example:                                                                      C:\joyneuf\autofiles\usbdsc.c
                                            * If a device has one configuration, two interfaces; interface 0                C:\joyneuf\autofiles\usbdsc.c
                                            * has two endpoints (in and out), and interface 1 has one endpoint(in).         C:\joyneuf\autofiles\usbdsc.c
                                            * Then the CFG01 structure in the usbdsc.h should be:                           C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            * #define CFG01 rom struct                            \                         C:\joyneuf\autofiles\usbdsc.c
                                            * {   USB_CFG_DSC             cd01;                   \                         C:\joyneuf\autofiles\usbdsc.c
                                            *     USB_INTF_DSC            i00a00;                 \                         C:\joyneuf\autofiles\usbdsc.c
                                            *     USB_EP_DSC              ep01o_i00a00;           \                         C:\joyneuf\autofiles\usbdsc.c
                                            *     USB_EP_DSC              ep01i_i00a00;           \                         C:\joyneuf\autofiles\usbdsc.c
                                            *     USB_INTF_DSC            i01a00;                 \                         C:\joyneuf\autofiles\usbdsc.c
                                            *     USB_EP_DSC              ep02i_i01a00;           \                         C:\joyneuf\autofiles\usbdsc.c
                                            * } cfg01                                                                       C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            * Note the hierarchy of the descriptors above, it follows the USB               C:\joyneuf\autofiles\usbdsc.c
                                            * specification requirement. All endpoints belonging to an interface            C:\joyneuf\autofiles\usbdsc.c
                                            * should be listed immediately after that interface.                            C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           C:\joyneuf\autofiles\usbdsc.c
                                            * Filling in the descriptor values in the usbdsc.c file:                        C:\joyneuf\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           C:\joyneuf\autofiles\usbdsc.c
                                            * Most items should be self-explanatory, however, a few will be                 C:\joyneuf\autofiles\usbdsc.c
                                            * explained for clarification.                                                  C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            * [Configuration Descriptor(USB_CFG_DSC)]                                       C:\joyneuf\autofiles\usbdsc.c
                                            * The configuration attribute must always have the _DEFAULT                     C:\joyneuf\autofiles\usbdsc.c
                                            * definition at the minimum. Additional options can be ORed                     C:\joyneuf\autofiles\usbdsc.c
                                            * to the _DEFAULT attribute. Available options are _SELF and _RWU.              C:\joyneuf\autofiles\usbdsc.c
                                            * These definitions are defined in the usbdefs_std_dsc.h file. The              C:\joyneuf\autofiles\usbdsc.c
                                            * _SELF tells the USB host that this device is self-powered. The                C:\joyneuf\autofiles\usbdsc.c
                                            * _RWU tells the USB host that this device supports Remote Wakeup.              C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            * [Endpoint Descriptor(USB_EP_DSC)]                                             C:\joyneuf\autofiles\usbdsc.c
                                            * Assume the following example:                                                 C:\joyneuf\autofiles\usbdsc.c
                                            * sizeof(USB_EP_DSC),DSC_EP,_EP01_OUT,_BULK,64,0x00                             C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            * The first two parameters are self-explanatory. They specify the               C:\joyneuf\autofiles\usbdsc.c
                                            * length of this endpoint descriptor (7) and the descriptor type.               C:\joyneuf\autofiles\usbdsc.c
                                            * The next parameter identifies the endpoint, the definitions are               C:\joyneuf\autofiles\usbdsc.c
                                            * defined in usbdefs_std_dsc.h and has the following naming                     C:\joyneuf\autofiles\usbdsc.c
                                            * convention:                                                                   C:\joyneuf\autofiles\usbdsc.c
                                            * _EP<##>_<dir>                                                                 C:\joyneuf\autofiles\usbdsc.c
                                            * where ## is the endpoint number and dir is the direction of                   C:\joyneuf\autofiles\usbdsc.c
                                            * transfer. The dir has the value of either 'OUT' or 'IN'.                      C:\joyneuf\autofiles\usbdsc.c
                                            * The next parameter identifies the type of the endpoint. Available             C:\joyneuf\autofiles\usbdsc.c
                                            * options are _BULK, _INT, _ISO, and _CTRL. The _CTRL is not                    C:\joyneuf\autofiles\usbdsc.c
                                            * typically used because the default control transfer endpoint is               C:\joyneuf\autofiles\usbdsc.c
                                            * not defined in the USB descriptors. When _ISO option is used,                 C:\joyneuf\autofiles\usbdsc.c
                                            * addition options can be ORed to _ISO. Example:                                C:\joyneuf\autofiles\usbdsc.c
                                            * _ISO|_AD|_FE                                                                  C:\joyneuf\autofiles\usbdsc.c
                                            * This describes the endpoint as an isochronous pipe with adaptive              C:\joyneuf\autofiles\usbdsc.c
                                            * and feedback attributes. See usbdefs_std_dsc.h and the USB                    C:\joyneuf\autofiles\usbdsc.c
                                            * specification for details. The next parameter defines the size of             C:\joyneuf\autofiles\usbdsc.c
                                            * the endpoint. The last parameter in the polling interval.                     C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           C:\joyneuf\autofiles\usbdsc.c
                                            * Adding a USB String                                                           C:\joyneuf\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           C:\joyneuf\autofiles\usbdsc.c
                                            * A string descriptor array should have the following format:                   C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            * rom struct{byte bLength;byte bDscType;word string[size];}sdxxx={              C:\joyneuf\autofiles\usbdsc.c
                                            * sizeof(sdxxx),DSC_STR,<text>};                                                C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            * The above structure provides a means for the C compiler to                    C:\joyneuf\autofiles\usbdsc.c
                                            * calculate the length of string descriptor sdxxx, where xxx is the             C:\joyneuf\autofiles\usbdsc.c
                                            * index number. The first two bytes of the descriptor are descriptor            C:\joyneuf\autofiles\usbdsc.c
                                            * length and type. The rest <text> are string texts which must be               C:\joyneuf\autofiles\usbdsc.c
                                            * in the unicode format. The unicode format is achieved by declaring            C:\joyneuf\autofiles\usbdsc.c
                                            * each character as a word type. The whole text string is declared              C:\joyneuf\autofiles\usbdsc.c
                                            * as a word array with the number of characters equals to <size>.               C:\joyneuf\autofiles\usbdsc.c
                                            * <size> has to be manually counted and entered into the array                  C:\joyneuf\autofiles\usbdsc.c
                                            * declaration. Let's study this through an example:                             C:\joyneuf\autofiles\usbdsc.c
                                            * if the string is "USB" , then the string descriptor should be:                C:\joyneuf\autofiles\usbdsc.c
                                            * (Using index 02)                                                              C:\joyneuf\autofiles\usbdsc.c
                                            * rom struct{byte bLength;byte bDscType;word string[3];}sd002={                 C:\joyneuf\autofiles\usbdsc.c
                                            * sizeof(sd002),DSC_STR,'U','S','B'};                                           C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            * A USB project may have multiple strings and the firmware supports             C:\joyneuf\autofiles\usbdsc.c
                                            * the management of multiple strings through a look-up table.                   C:\joyneuf\autofiles\usbdsc.c
                                            * The look-up table is defined as:                                              C:\joyneuf\autofiles\usbdsc.c
                                            * rom const unsigned char *rom USB_SD_Ptr[]={&sd000,&sd001,&sd002};             C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            * The above declaration has 3 strings, sd000, sd001, and sd002.                 C:\joyneuf\autofiles\usbdsc.c
                                            * Strings can be removed or added. sd000 is a specialized string                C:\joyneuf\autofiles\usbdsc.c
                                            * descriptor. It defines the language code, usually this is                     C:\joyneuf\autofiles\usbdsc.c
                                            * US English (0x0409). The index of the string must match the index             C:\joyneuf\autofiles\usbdsc.c
                                            * position of the USB_SD_Ptr array, &sd000 must be in position                  C:\joyneuf\autofiles\usbdsc.c
                                            * USB_SD_Ptr[0], &sd001 must be in position USB_SD_Ptr[1] and so on.            C:\joyneuf\autofiles\usbdsc.c
                                            * The look-up table USB_SD_Ptr is used by the get string handler                C:\joyneuf\autofiles\usbdsc.c
                                            * function in usb9.c.                                                           C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            * The look-up table scheme also applies to the configuration                    C:\joyneuf\autofiles\usbdsc.c
                                            * descriptor. A USB device may have multiple configuration                      C:\joyneuf\autofiles\usbdsc.c
                                            * descriptors, i.e. CFG01, CFG02, etc. To add a configuration                   C:\joyneuf\autofiles\usbdsc.c
                                            * descriptor, user must implement a structure similar to CFG01.                 C:\joyneuf\autofiles\usbdsc.c
                                            * The next step is to add the configuration descriptor name, i.e.               C:\joyneuf\autofiles\usbdsc.c
                                            * cfg01, cfg02,.., to the look-up table USB_CD_Ptr. USB_CD_Ptr[0]               C:\joyneuf\autofiles\usbdsc.c
                                            * is a dummy place holder since configuration 0 is the un-configured            C:\joyneuf\autofiles\usbdsc.c
                                            * state according to the definition in the USB specification.                   C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            ********************************************************************/           C:\joyneuf\autofiles\usbdsc.c
                                                                                                                            C:\joyneuf\autofiles\usbdsc.c
                                           /*********************************************************************           C:\joyneuf\autofiles\usbdsc.c
                                            * Descriptor specific type definitions are defined in:                          C:\joyneuf\autofiles\usbdsc.c
                                            * system\usb\usbdefs\usbdefs_std_dsc.h                                          C:\joyneuf\autofiles\usbdsc.c
                                            *                                                                               C:\joyneuf\autofiles\usbdsc.c
                                            * Configuration information is defined in:                                      C:\joyneuf\autofiles\usbdsc.c
                                            * autofiles\usbcfg.h                                                            C:\joyneuf\autofiles\usbdsc.c
                                            ********************************************************************/           C:\joyneuf\autofiles\usbdsc.c
                                                                                                                            C:\joyneuf\autofiles\usbdsc.c
                                           /** I N C L U D E S *************************************************/           C:\joyneuf\autofiles\usbdsc.c
                                           #include "system\typedefs.h"                                                     C:\joyneuf\autofiles\usbdsc.c
                                           #include "system\usb\usb.h"                                                      C:\joyneuf\autofiles\usbdsc.c
                                                                                                                            C:\joyneuf\autofiles\usbdsc.c
                                           /** C O N S T A N T S ************************************************/          C:\joyneuf\autofiles\usbdsc.c
                                           #pragma romdata                                                                  C:\joyneuf\autofiles\usbdsc.c
                                                                                                                            C:\joyneuf\autofiles\usbdsc.c
                                           /* Device Descriptor */                                                          C:\joyneuf\autofiles\usbdsc.c
                                           rom USB_DEV_DSC device_dsc=                                                      C:\joyneuf\autofiles\usbdsc.c
                                           {                                                                                C:\joyneuf\autofiles\usbdsc.c
                                               sizeof(USB_DEV_DSC),    // Size of this descriptor in bytes                  C:\joyneuf\autofiles\usbdsc.c
                                               DSC_DEV,                // DEVICE descriptor type                            C:\joyneuf\autofiles\usbdsc.c
                                               0x0200,                 // USB Spec Release Number in BCD format             C:\joyneuf\autofiles\usbdsc.c
                                               0x00,                   // Class Code                                        C:\joyneuf\autofiles\usbdsc.c
                                               0x00,                   // Subclass code                                     C:\joyneuf\autofiles\usbdsc.c
                                               0x00,                   // Protocol code                                     C:\joyneuf\autofiles\usbdsc.c
                                               EP0_BUFF_SIZE,          // Max packet size for EP0, see usbcfg.h             C:\joyneuf\autofiles\usbdsc.c
                                               0x04D8,                 // Vendor ID                                         C:\joyneuf\autofiles\usbdsc.c
                                               0x0000,                 // Product ID: Mouse in a circle fw demo             C:\joyneuf\autofiles\usbdsc.c
                                               0x0001,                 // Device release number in BCD format               C:\joyneuf\autofiles\usbdsc.c
                                               0x01,                   // Manufacturer string index                         C:\joyneuf\autofiles\usbdsc.c
                                               0x02,                   // Product string index                              C:\joyneuf\autofiles\usbdsc.c
                                               0x00,                   // Device serial number string index                 C:\joyneuf\autofiles\usbdsc.c
                                               0x01                    // Number of possible configurations                 C:\joyneuf\autofiles\usbdsc.c
                                           };                                                                               C:\joyneuf\autofiles\usbdsc.c
                                                                                                                            C:\joyneuf\autofiles\usbdsc.c
                                           /* Configuration 1 Descriptor */                                                 C:\joyneuf\autofiles\usbdsc.c
                                           CFG01={                                                                          C:\joyneuf\autofiles\usbdsc.c
                                               /* Configuration Descriptor */                                               C:\joyneuf\autofiles\usbdsc.c
                                               sizeof(USB_CFG_DSC),    // Size of this descriptor in bytes                  C:\joyneuf\autofiles\usbdsc.c
                                               DSC_CFG,                // CONFIGURATION descriptor type                     C:\joyneuf\autofiles\usbdsc.c
                                               sizeof(cfg01),          // Total length of data for this cfg                 C:\joyneuf\autofiles\usbdsc.c
                                               1,                      // Number of interfaces in this cfg                  C:\joyneuf\autofiles\usbdsc.c
                                               1,                      // Index value of this configuration                 C:\joyneuf\autofiles\usbdsc.c
                                               0,                      // Configuration string index                        C:\joyneuf\autofiles\usbdsc.c
                                               _DEFAULT|_RWU,          // Attributes, see usbdefs_std_dsc.h                 C:\joyneuf\autofiles\usbdsc.c
                                               50,                     // Max power consumption (2X mA)                     C:\joyneuf\autofiles\usbdsc.c
                                                                                                                            C:\joyneuf\autofiles\usbdsc.c
                                               /* Interface Descriptor */                                                   C:\joyneuf\autofiles\usbdsc.c
                                               sizeof(USB_INTF_DSC),   // Size of this descriptor in bytes                  C:\joyneuf\autofiles\usbdsc.c
                                               DSC_INTF,               // INTERFACE descriptor type                         C:\joyneuf\autofiles\usbdsc.c
                                               0,                      // Interface Number                                  C:\joyneuf\autofiles\usbdsc.c
                                               0,                      // Alternate Setting Number                          C:\joyneuf\autofiles\usbdsc.c
                                               1,                      // Number of endpoints in this intf                  C:\joyneuf\autofiles\usbdsc.c
                                               HID_INTF,               // Class code                                        C:\joyneuf\autofiles\usbdsc.c
                                               BOOT_INTF_SUBCLASS,     // Subclass code                                     C:\joyneuf\autofiles\usbdsc.c
                                               HID_PROTOCOL_MOUSE,     // Protocol code                                     C:\joyneuf\autofiles\usbdsc.c
                                               0,                      // Interface string index                            C:\joyneuf\autofiles\usbdsc.c
                                                                                                                            C:\joyneuf\autofiles\usbdsc.c
                                               /* HID Class-Specific Descriptor */                                          C:\joyneuf\autofiles\usbdsc.c
                                               sizeof(USB_HID_DSC),    // Size of this descriptor in bytes                  C:\joyneuf\autofiles\usbdsc.c
                                               DSC_HID,                // HID descriptor type                               C:\joyneuf\autofiles\usbdsc.c
                                               0x0101,                 // HID Spec Release Number in BCD format             C:\joyneuf\autofiles\usbdsc.c
                                               0x00,                   // Country Code (0x00 for Not supported)             C:\joyneuf\autofiles\usbdsc.c
                                               HID_NUM_OF_DSC,         // Number of class descriptors, see usbcfg.h         C:\joyneuf\autofiles\usbdsc.c
                                               DSC_RPT,                // Report descriptor type                            C:\joyneuf\autofiles\usbdsc.c
                                               sizeof(hid_rpt01),      // Size of the report descriptor                     C:\joyneuf\autofiles\usbdsc.c
                                                                                                                            C:\joyneuf\autofiles\usbdsc.c
                                               /* Endpoint Descriptor */                                                    C:\joyneuf\autofiles\usbdsc.c
                                               sizeof(USB_EP_DSC),DSC_EP,_EP01_IN,_INT,HID_INT_IN_EP_SIZE,0x0A              C:\joyneuf\autofiles\usbdsc.c
                                           };                                                                               C:\joyneuf\autofiles\usbdsc.c
                                                                                                                            C:\joyneuf\autofiles\usbdsc.c
                                           rom struct{byte bLength;byte bDscType;word string[1];}sd000={                    C:\joyneuf\autofiles\usbdsc.c
                                           sizeof(sd000),DSC_STR,0x0409};                                                   C:\joyneuf\autofiles\usbdsc.c
                                                                                                                            C:\joyneuf\autofiles\usbdsc.c
                                           rom struct{byte bLength;byte bDscType;word string[25];}sd001={                   C:\joyneuf\autofiles\usbdsc.c
                                           sizeof(sd001),DSC_STR,                                                           C:\joyneuf\autofiles\usbdsc.c
                                           'M','i','c','r','o','c','h','i','p',' ',                                         C:\joyneuf\autofiles\usbdsc.c
                                           'T','e','c','h','n','o','l','o','g','y',' ','I','n','c','.'};                    C:\joyneuf\autofiles\usbdsc.c
                                                                                                                            C:\joyneuf\autofiles\usbdsc.c
                                           rom struct{byte bLength;byte bDscType;word string[22];}sd002={                   C:\joyneuf\autofiles\usbdsc.c
                                           sizeof(sd002),DSC_STR,                                                           C:\joyneuf\autofiles\usbdsc.c
                                           'M','o','u','s','e',' ','I','n',' ','a',' ',                                     C:\joyneuf\autofiles\usbdsc.c
                                           'C','i','r','c','l','e',' ','D','e','m','o'};                                    C:\joyneuf\autofiles\usbdsc.c
                                                                                                                            C:\joyneuf\autofiles\usbdsc.c
                                           rom struct{byte report[HID_RPT01_SIZE];}hid_rpt01={                              C:\joyneuf\autofiles\usbdsc.c
                                               0x05, 0x01, /* Usage Page (Generic Desktop)             */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x09, 0x04, /* Usage (Joystick)                         */                   C:\joyneuf\autofiles\usbdsc.c
                                               0xA1, 0x01, /* Collection (Application)                 */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x05, 0x02, /* Usage Page (Simulation Controls)         */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x09, 0xBB, /* Usage (Throttle)                         */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x15, 0x81, /*      Logical Minimum (-127)              */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x25, 0x7F, /*      Logical Maximum (127)               */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x75, 0x08, /*      Report Size (8)                     */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x95, 0x01, /*      Report Count (1)                    */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x81, 0x02, /*      Input (Data, Variable, Absolute)    */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x05, 0x01, /* Usage Page (Generic Desktop)             */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x09, 0x01, /*      Usage (Pointer)                     */                   C:\joyneuf\autofiles\usbdsc.c
                                               0xA1, 0x00, /* Collection (Physical)                    */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x09, 0x30, /*      Usage Page (X)                      */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x09, 0x31, /*      Usage Page (Y)                      */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x95, 0x02, /*      Report Count (2)                    */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x81, 0x02, /*      Input (Data, Variable, Absolute)    */                   C:\joyneuf\autofiles\usbdsc.c
                                               0xC0,       /* End Collection                           */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x09, 0x39, /*      Usage (Hat switch)                  */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x15, 0x00, /*      Logical Minimum (0)                 */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x25, 0x03, /*      Logical Maximum (3)                 */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x35, 0x00, /*      Physical Minimum (0)                */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x46, 0x0E, /*      Physical Maximum (270)              */                   C:\joyneuf\autofiles\usbdsc.c
                                           		0x01,                                                                          C:\joyneuf\autofiles\usbdsc.c
                                           		0x65, 0x14, /*      Unit (English Rot :Angular Pos)     */                     C:\joyneuf\autofiles\usbdsc.c
                                               0x55, 0x00, /*      Unit Exponent (0)                   */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x75, 0x04, /*      Report Size (4)                     */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x95, 0x01, /*      Report Count (1)                    */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x81, 0x02, /*      Input (Data, Variable, Absolute)    */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x05, 0x09, /* Usage Page (Buttons)                     */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x19, 0x01, /*      Usage Minimum (1)                   */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x29, 0x04, /*      Usage Maximum (4)                   */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x15, 0x00, /*      Logical Minimum (0)                 */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x25, 0x01, /*      Logical Maximum (1)                 */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x35, 0x00, /*      Physical Minimum (0)                */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x45, 0x01, /*      Physical Maximum (1)                */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x95, 0x04, /*      Report Count (4)                    */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x75, 0x01, /*      Report Size (1)                     */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x65, 0x00, /*      Unit (None)                         */                   C:\joyneuf\autofiles\usbdsc.c
                                               0x81, 0x02, /*      Input (Data, Variable, Absolute)    */                   C:\joyneuf\autofiles\usbdsc.c
                                               0xC0};      /* End Collection                           */                   C:\joyneuf\autofiles\usbdsc.c
                                                                                                                            C:\joyneuf\autofiles\usbdsc.c
                                           rom const unsigned char *rom USB_CD_Ptr[]={(rom const unsigned char *rom)&cfg01,(rom const unsigned char *rom)&cfg01}; C:\joyneuf\autofiles\usbdsc.c
                                           rom const unsigned char *rom USB_SD_Ptr[]={(rom const unsigned char *rom)&sd000,(rom const unsigned char *rom)&sd001,(rom const unsigned char *rom)&sd002}; C:\joyneuf\autofiles\usbdsc.c
                                                                                                                            C:\joyneuf\autofiles\usbdsc.c
                                           rom pFunc ClassReqHandler[1]=                                                    C:\joyneuf\autofiles\usbdsc.c
                                           {                                                                                C:\joyneuf\autofiles\usbdsc.c
                                               &USBCheckHIDRequest                                                          C:\joyneuf\autofiles\usbdsc.c
                                           };                                                                               C:\joyneuf\autofiles\usbdsc.c
                                                                                                                            C:\joyneuf\autofiles\usbdsc.c
                                           #pragma code                                                                     C:\joyneuf\autofiles\usbdsc.c
                                                                                                                            C:\joyneuf\autofiles\usbdsc.c
                                           /** EOF usbdsc.c ****************************************************/           C:\joyneuf\autofiles\usbdsc.c
                                           /*********************************************************************           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                Microchip USB C18 Firmware Version 1.0                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *********************************************************************           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * FileName:        usbctrltrf.c                                                 C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Dependencies:    See INCLUDES section below                                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Processor:       PIC18                                                        C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Compiler:        C18 2.30.01+                                                 C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Company:         Microchip Technology, Inc.                                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Software License Agreement                                                    C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * The software supplied herewith by Microchip Technology Incorporated           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * (the ìCompanyî) for its PICmicroÆ Microcontroller is intended and             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * supplied to you, the Companyís customer, for use solely and                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * software is owned by the Company and/or its supplier, and is                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * protected under applicable copyright laws. All rights are reserved.           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Any use in violation of the foregoing restrictions may subject the            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * user to criminal sanctions under applicable laws, as well as to               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * civil liability for the breach of the terms and conditions of this            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * license.                                                                      C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * THIS SOFTWARE IS PROVIDED IN AN ìAS ISî CONDITION. NO WARRANTIES,             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Author               Date        Comment                                      C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            ********************************************************************/           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           /** I N C L U D E S **********************************************************/  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           #include <p18cxxx.h>                                                             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           #include "system\typedefs.h"                                                     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           #include "system\usb\usb.h"                                                      C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           /** V A R I A B L E S ********************************************************/  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           #pragma udata                                                                    C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           byte ctrl_trf_state;                // Control Transfer State                    C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           byte ctrl_trf_session_owner;        // Current transfer session owner            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           POINTER pSrc;                       // Data source pointer                       C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           POINTER pDst;                       // Data destination pointer                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           WORD wCount;                        // Data counter                              C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfSetupHandler(void);                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfOutHandler(void);                                                 C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfInHandler(void);                                                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           /** D E C L A R A T I O N S **************************************************/  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           #pragma code                                                                     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlEPService(void)                                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    USTAT is loaded with a valid endpoint address.               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        USBCtrlEPService checks for three transaction types that     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  it knows how to service and services them:                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  1. EP0 SETUP                                                 C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  2. EP0 OUT                                                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  3. EP0 IN                                                    C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  It ignores all other types (i.e. EP1, EP2, etc.)             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlEPService(void)                                                      C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000334   506c     MOVF      0x6c,0x0,0x0       if(USTAT == EP00_OUT)                                                        C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000336   e10b     BNZ       0x34e                                                                                           
                                               {                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000338   0104     MOVLB     0x4                    if(ep0Bo.Stat.PID == SETUP_TOKEN)           // EP0 SETUP                 C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00033a   5100     MOVF      0x0,0x0,0x1                                                                                     
00033c   0b3c     ANDLW     0x3c                                                                                            
00033e   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000340   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000342   080d     SUBLW     0xd                                                                                             
000344   e102     BNZ       0x34a                                                                                           
000346   d808     RCALL     0x358                      USBCtrlTrfSetupHandler();                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000348   d001     BRA       0x34c                  else                                        // EP0 OUT                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00034a   d83c     RCALL     0x3c4                      USBCtrlTrfOutHandler();                                              C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                               }                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00034c   d004     BRA       0x356              else if(USTAT == EP00_IN)                       // EP0 IN                    C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00034e   0e04     MOVLW     0x4                                                                                             
000350   5c6c     SUBWF     0x6c,0x0,0x0                                                                                    
000352   e101     BNZ       0x356                                                                                           
000354   d847     RCALL     0x3e4                  USBCtrlTrfInHandler();                                                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000356   0012     RETURN    0x0            }//end USBCtrlEPService                                                          C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfSetupHandler(void)                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    SetupPkt buffer is loaded with valid USB Setup Data          C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine is a task dispatcher and has 3 stages.          C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  1. It initializes the control transfer state machine.        C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  2. It calls on each of the module that may know how to       C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     service the Setup Request from the host.                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     Module Example: USB9, HID, CDC, MSD, ...                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     As new classes are added, ClassReqHandler table in        C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     usbdsc.c should be updated to call all available          C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     class handlers.                                           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  3. Once each of the modules has had a chance to check if     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     it is responsible for servicing the request, stage 3      C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     then checks direction of the transfer to determine how    C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     to prepare EP0 for the control transfer.                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     Refer to USBCtrlEPServiceComplete() for more details.     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            Microchip USB Firmware has three different states for        C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  the control transfer state machine:                          C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  1. WAIT_SETUP                                                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  2. CTRL_TRF_TX                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  3. CTRL_TRF_RX                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  Refer to firmware manual to find out how one state           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  is transitioned to another.                                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  A Control Transfer is composed of many USB transactions.     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  When transferring data over multiple transactions,           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  it is important to keep track of data source, data           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  destination, and data count. These three parameters are      C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  stored in pSrc,pDst, and wCount. A flag is used to           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  note if the data source is from ROM or RAM.                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000358   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfSetupHandler(void)                                                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00035a   ffe6                                                                                                               
00035c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00035e   ffd9                                                                                                               
000360   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                               byte i;                                                                      C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                               /* Stage 1 */                                                                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000362   0100     MOVLB     0x0                ctrl_trf_state = WAIT_SETUP;                                                 C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000364   6b6a     CLRF      0x6a,0x1                                                                                        
000366   6b6b     CLRF      0x6b,0x1           ctrl_trf_session_owner = MUID_NULL;     // Set owner to NULL                 C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000368   6b70     CLRF      0x70,0x1           wCount._word = 0;                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00036a   6b71     CLRF      0x71,0x1                                                                                        
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                               /* Stage 2 */                                                                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00036c   ec16     CALL      0x2c,0x0           USBCheckStdRequest();                   // See system\usb9\usb9.c            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00036e   f000                                                                                                               
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                               /* Modifiable Section */                                                     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000370   6adf     CLRF      0xdf,0x0           for(i=0;i < (sizeof(ClassReqHandler)/sizeof(pFunc));i++)                     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000372   50df     MOVF      0xdf,0x0,0x0                                                                                    
000374   6e02     MOVWF     0x2,0x0                                                                                         
000376   6a03     CLRF      0x3,0x0                                                                                         
000378   0e01     MOVLW     0x1                                                                                             
00037a   5c02     SUBWF     0x2,0x0,0x0                                                                                     
00037c   0e00     MOVLW     0x0                                                                                             
00037e   5803     SUBWFB    0x3,0x0,0x0                                                                                     
000380   e21b     BC        0x3b8                                                                                           
0003b4   2adf     INCF      0xdf,0x1,0x0                                                                                    
0003b6   d7dd     BRA       0x372                                                                                           
                                               {                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000382   0100     MOVLB     0x0                    if(ctrl_trf_session_owner != MUID_NULL)break;                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000384   516b     MOVF      0x6b,0x0,0x1                                                                                    
000386   e001     BZ        0x38a                                                                                           
000388   d017     BRA       0x3b8                                                                                           
00038a   6af7     CLRF      0xf7,0x0               ClassReqHandler[i]();               // See autofiles\usbdsc.c            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00038c   34df     RLCF      0xdf,0x0,0x0                                                                                    
00038e   0bfe     ANDLW     0xfe                                                                                            
000390   36f7     RLCF      0xf7,0x1,0x0                                                                                    
000392   6ef6     MOVWF     0xf6,0x0                                                                                        
000394   0e1d     MOVLW     0x1d                                                                                            
000396   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
000398   0e0b     MOVLW     0xb                                                                                             
00039a   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
00039c   0009     TBLRDPOSTINC                                                                                              
00039e   cff5     MOVFF     0xff5,0x2                                                                                       
0003a0   f002                                                                                                               
0003a2   0008     TBLRD                                                                                                     
0003a4   cff5     MOVFF     0xff5,0x3                                                                                       
0003a6   f003                                                                                                               
0003a8   d004     BRA       0x3b2                                                                                           
0003aa   c003     MOVFF     0x3,0xffa                                                                                       
0003ac   fffa                                                                                                               
0003ae   5002     MOVF      0x2,0x0,0x0                                                                                     
0003b0   6ef9     MOVWF     0xf9,0x0                                                                                        
0003b2   dffb     RCALL     0x3aa                                                                                           
                                               }//end while                                                                 C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                               /* End Modifiable Section */                                                 C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                               /* Stage 3 */                                                                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0003b8   d8dd     RCALL     0x574              USBCtrlEPServiceComplete();                                                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0003ba   52e5     MOVF      0xe5,0x1,0x0   }//end USBCtrlTrfSetupHandler                                                    C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0003bc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0003be   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0003c0   ffd9                                                                                                               
0003c2   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfOutHandler(void)                              C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine handles an OUT transaction according to         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  which control transfer state is currently active.            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            Note that if the the control transfer was from               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  host to device, the session owner should be notified         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  at the end of each OUT transaction to service the            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  received data.                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfOutHandler(void)                                                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0003c4   0e02     MOVLW     0x2                if(ctrl_trf_state == CTRL_TRF_RX)                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0003c6   0100     MOVLB     0x0                                                                                             
0003c8   5d6a     SUBWF     0x6a,0x0,0x1                                                                                    
0003ca   e10a     BNZ       0x3e0                                                                                           
                                               {                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0003cc   d896     RCALL     0x4fa                  USBCtrlTrfRxService();                                                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                   /*                                                                       C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                    * Don't have to worry about overwriting _KEEP bit                       C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                    * because if _KEEP was set, TRNIF would not have been                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                    * generated in the first place.                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                    */                                                                      C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0003ce   0104     MOVLB     0x4                    if(ep0Bo.Stat.DTS == 0)                                                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0003d0   bd00     BTFSC     0x0,0x6,0x1                                                                                     
0003d2   d003     BRA       0x3da                                                                                           
0003d4   0ec8     MOVLW     0xc8                       ep0Bo.Stat._byte = _USIE|_DAT1|_DTSEN;                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0003d6   6f00     MOVWF     0x0,0x1                                                                                         
0003d8   d002     BRA       0x3de                  else                                                                     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0003da   0e88     MOVLW     0x88                       ep0Bo.Stat._byte = _USIE|_DAT0|_DTSEN;                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0003dc   6f00     MOVWF     0x0,0x1                                                                                         
                                               }                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0003de   d001     BRA       0x3e2              else    // CTRL_TRF_TX                                                       C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0003e0   d90f     RCALL     0x600                  USBPrepareForNextSetupTrf();                                             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0003e2   0012     RETURN    0x0            }//end USBCtrlTrfOutHandler                                                      C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfInHandler(void)                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine handles an IN transaction according to          C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  which control transfer state is currently active.            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            A Set Address Request must not change the acutal address     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  of the device until the completion of the control            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transfer. The end of the control transfer for Set Address    C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  Request is an IN transaction. Therefore it is necessary      C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  to service this unique situation when the condition is       C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  right. Macro mUSBCheckAdrPendingState is defined in          C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  usb9.h and its function is to specifically service this      C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  event.                                                       C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfInHandler(void)                                                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0003e4   0e04     MOVLW     0x4                mUSBCheckAdrPendingState();         // Must check if in ADR_PENDING_STATE    C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0003e6   0100     MOVLB     0x0                                                                                             
0003e8   5d76     SUBWF     0x76,0x0,0x1                                                                                    
0003ea   e10a     BNZ       0x400                                                                                           
0003ec   c412     MOVFF     0x412,0xf6e                                                                                     
0003ee   ff6e                                                                                                               
0003f0   506e     MOVF      0x6e,0x0,0x0                                                                                    
0003f2   0800     SUBLW     0x0                                                                                             
0003f4   e203     BC        0x3fc                                                                                           
0003f6   0e05     MOVLW     0x5                                                                                             
0003f8   6f76     MOVWF     0x76,0x1                                                                                        
0003fa   d002     BRA       0x400                                                                                           
0003fc   0e03     MOVLW     0x3                                                                                             
0003fe   6f76     MOVWF     0x76,0x1                                                                                        
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000400   0100     MOVLB     0x0                if(ctrl_trf_state == CTRL_TRF_TX)                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000402   056a     DECF      0x6a,0x0,0x1                                                                                    
000404   e10a     BNZ       0x41a                                                                                           
                                               {                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000406   d80b     RCALL     0x41e                  USBCtrlTrfTxService();                                                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000408   0104     MOVLB     0x4                    if(ep0Bi.Stat.DTS == 0)                                                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00040a   bd04     BTFSC     0x4,0x6,0x1                                                                                     
00040c   d003     BRA       0x414                                                                                           
00040e   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000410   6f04     MOVWF     0x4,0x1                                                                                         
000412   d002     BRA       0x418                  else                                                                     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000414   0e88     MOVLW     0x88                       ep0Bi.Stat._byte = _USIE|_DAT0|_DTSEN;                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000416   6f04     MOVWF     0x4,0x1                                                                                         
                                               }                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000418   d001     BRA       0x41c              else // CTRL_TRF_RX                                                          C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00041a   d8f2     RCALL     0x600                  USBPrepareForNextSetupTrf();                                             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00041c   0012     RETURN    0x0            }//end USBCtrlTrfInHandler                                                       C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfTxService(void)                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    pSrc, wCount, and usb_stat.ctrl_trf_mem are setup properly.  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine should be called from only two places.          C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  One from USBCtrlEPServiceComplete() and one from             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  USBCtrlTrfInHandler(). It takes care of managing a           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transfer over multiple USB transactions.                     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            This routine works with isochronous endpoint larger than     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  256 bytes and is shown here as an example of how to deal     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  with BC9 and BC8. In reality, a control endpoint can never   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  be larger than 64 bytes.                                     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00041e   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfTxService(void)                                                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000420   ffe6                                                                                                               
000422   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000424   ffd9                                                                                                               
000426   0e02     MOVLW     0x2                                                                                             
000428   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                               WORD byte_to_send;                                                           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                * First, have to figure out how many byte of data to send.                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00042a   0100     MOVLB     0x0                if(wCount._word < EP0_BUFF_SIZE)                                             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00042c   0e08     MOVLW     0x8                                                                                             
00042e   5d70     SUBWF     0x70,0x0,0x1                                                                                    
000430   0e00     MOVLW     0x0                                                                                             
000432   5971     SUBWFB    0x71,0x0,0x1                                                                                    
000434   e205     BC        0x440                                                                                           
000436   c070     MOVFF     0x70,0xfde             byte_to_send._word = wCount._word;                                       C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000438   ffde                                                                                                               
00043a   c071     MOVFF     0x71,0xfdd                                                                                      
00043c   ffdd                                                                                                               
00043e   d003     BRA       0x446              else                                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000440   0e08     MOVLW     0x8                    byte_to_send._word = EP0_BUFF_SIZE;                                      C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000442   6ede     MOVWF     0xde,0x0                                                                                        
000444   6add     CLRF      0xdd,0x0                                                                                        
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                * Next, load the number of bytes to send to BC9..0 in buffer descriptor     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000446   0104     MOVLB     0x4                ep0Bi.Stat.BC9 = 0;                                                          C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000448   9304     BCF       0x4,0x1,0x1                                                                                     
00044a   9104     BCF       0x4,0x0,0x1        ep0Bi.Stat.BC8 = 0;                                                          C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00044c   0e01     MOVLW     0x1                ep0Bi.Stat._byte |= MSB(byte_to_send);                                       C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00044e   50db     MOVF      0xdb,0x0,0x0                                                                                    
000450   1304     IORWF     0x4,0x1,0x1                                                                                     
000452   cfdf     MOVFF     0xfdf,0x405        ep0Bi.Cnt = LSB(byte_to_send);                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000454   f405                                                                                                               
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                * Subtract the number of bytes just about to be sent from the total.        C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000456   0e00     MOVLW     0x0                wCount._word = wCount._word - byte_to_send._word;                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000458   50db     MOVF      0xdb,0x0,0x0                                                                                    
00045a   0100     MOVLB     0x0                                                                                             
00045c   5f70     SUBWF     0x70,0x1,0x1                                                                                    
00045e   0e01     MOVLW     0x1                                                                                             
000460   50db     MOVF      0xdb,0x0,0x0                                                                                    
000462   5b71     SUBWFB    0x71,0x1,0x1                                                                                    
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000464   0e18     MOVLW     0x18               pDst.bRam = (byte*)&CtrlTrfData;        // Set destination pointer           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000466   6f6e     MOVWF     0x6e,0x1                                                                                        
000468   0e04     MOVLW     0x4                                                                                             
00046a   6f6f     MOVWF     0x6f,0x1                                                                                        
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00046c   0100     MOVLB     0x0                if(usb_stat.ctrl_trf_mem == _ROM)       // Determine type of memory source   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00046e   a377     BTFSS     0x77,0x1,0x1                                                                                    
000470   d01e     BRA       0x4ae                                                                                           
                                               {                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000472   cfd9     MOVFF     0xfd9,0xfe9            while(byte_to_send._word)                                                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000474   ffe9                                                                                                               
000476   cfda     MOVFF     0xfda,0xfea                                                                                     
000478   ffea                                                                                                               
00047a   50ee     MOVF      0xee,0x0,0x0                                                                                    
00047c   10ed     IORWF     0xed,0x0,0x0                                                                                    
00047e   e016     BZ        0x4ac                                                                                           
0004aa   d7e3     BRA       0x472                                                                                           
                                                   {                                                                        C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000480   c06c     MOVFF     0x6c,0xff6                 *pDst.bRam = *pSrc.bRom;                                             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000482   fff6                                                                                                               
000484   c06d     MOVFF     0x6d,0xff7                                                                                      
000486   fff7                                                                                                               
000488   0008     TBLRD                                                                                                     
00048a   50f5     MOVF      0xf5,0x0,0x0                                                                                    
00048c   c06e     MOVFF     0x6e,0xfe9                                                                                      
00048e   ffe9                                                                                                               
000490   c06f     MOVFF     0x6f,0xfea                                                                                      
000492   ffea                                                                                                               
000494   6eef     MOVWF     0xef,0x0                                                                                        
000496   0100     MOVLB     0x0                        pDst.bRam++;                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000498   2b6e     INCF      0x6e,0x1,0x1                                                                                    
00049a   0e00     MOVLW     0x0                                                                                             
00049c   236f     ADDWFC    0x6f,0x1,0x1                                                                                    
00049e   2b6c     INCF      0x6c,0x1,0x1               pSrc.bRom++;                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0004a0   236d     ADDWFC    0x6d,0x1,0x1                                                                                    
0004a2   06df     DECF      0xdf,0x1,0x0               byte_to_send._word--;                                                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0004a4   0e01     MOVLW     0x1                                                                                             
0004a6   e201     BC        0x4aa                                                                                           
0004a8   06db     DECF      0xdb,0x1,0x0                                                                                    
                                                   }//end while(byte_to_send._word)                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                               }                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0004ac   d01c     BRA       0x4e6              else // RAM                                                                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                               {                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0004ae   cfd9     MOVFF     0xfd9,0xfe9            while(byte_to_send._word)                                                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0004b0   ffe9                                                                                                               
0004b2   cfda     MOVFF     0xfda,0xfea                                                                                     
0004b4   ffea                                                                                                               
0004b6   50ee     MOVF      0xee,0x0,0x0                                                                                    
0004b8   10ed     IORWF     0xed,0x0,0x0                                                                                    
0004ba   e015     BZ        0x4e6                                                                                           
0004e4   d7e4     BRA       0x4ae                                                                                           
                                                   {                                                                        C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0004bc   c06c     MOVFF     0x6c,0xfe9                 *pDst.bRam = *pSrc.bRam;                                             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0004be   ffe9                                                                                                               
0004c0   c06d     MOVFF     0x6d,0xfea                                                                                      
0004c2   ffea                                                                                                               
0004c4   50ef     MOVF      0xef,0x0,0x0                                                                                    
0004c6   c06e     MOVFF     0x6e,0xfe9                                                                                      
0004c8   ffe9                                                                                                               
0004ca   c06f     MOVFF     0x6f,0xfea                                                                                      
0004cc   ffea                                                                                                               
0004ce   6eef     MOVWF     0xef,0x0                                                                                        
0004d0   0100     MOVLB     0x0                        pDst.bRam++;                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0004d2   2b6e     INCF      0x6e,0x1,0x1                                                                                    
0004d4   0e00     MOVLW     0x0                                                                                             
0004d6   236f     ADDWFC    0x6f,0x1,0x1                                                                                    
0004d8   2b6c     INCF      0x6c,0x1,0x1               pSrc.bRam++;                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0004da   236d     ADDWFC    0x6d,0x1,0x1                                                                                    
0004dc   06df     DECF      0xdf,0x1,0x0               byte_to_send._word--;                                                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0004de   0e01     MOVLW     0x1                                                                                             
0004e0   e201     BC        0x4e4                                                                                           
0004e2   06db     DECF      0xdb,0x1,0x0                                                                                    
                                                   }//end while(byte_to_send._word)                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                               }//end if(usb_stat.ctrl_trf_mem == _ROM)                                     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0004e6   0e02     MOVLW     0x2            }//end USBCtrlTrfTxService                                                       C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0004e8   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
0004ea   e202     BC        0x4f0                                                                                           
0004ec   6ae1     CLRF      0xe1,0x0                                                                                        
0004ee   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0004f0   6ee1     MOVWF     0xe1,0x0                                                                                        
0004f2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0004f4   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0004f6   ffd9                                                                                                               
0004f8   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfRxService(void)                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    pDst and wCount are setup properly.                          C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  pSrc is always &CtrlTrfData                                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  usb_stat.ctrl_trf_mem is always _RAM.                        C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  wCount should be set to 0 at the start of each control       C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transfer.                                                    C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        *** This routine is only partially complete. Check for       C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  new version of the firmware.                                 C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0004fa   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfRxService(void)                                                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0004fc   ffe6                                                                                                               
0004fe   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000500   ffd9                                                                                                               
000502   0e02     MOVLW     0x2                                                                                             
000504   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                               WORD byte_to_read;                                                           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000506   0e03     MOVLW     0x3                MSB(byte_to_read) = 0x03 & ep0Bo.Stat._byte;    // Filter out last 2 bits    C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000508   0104     MOVLB     0x4                                                                                             
00050a   1500     ANDWF     0x0,0x0,0x1                                                                                     
00050c   6ee7     MOVWF     0xe7,0x0                                                                                        
00050e   0e01     MOVLW     0x1                                                                                             
000510   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
000512   ffdb                                                                                                               
000514   c401     MOVFF     0x401,0xfdf        LSB(byte_to_read) = ep0Bo.Cnt;                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000516   ffdf                                                                                                               
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                * Accumulate total number of bytes read                                     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000518   50de     MOVF      0xde,0x0,0x0       wCount._word = wCount._word + byte_to_read._word;                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00051a   0100     MOVLB     0x0                                                                                             
00051c   2770     ADDWF     0x70,0x1,0x1                                                                                    
00051e   50dd     MOVF      0xdd,0x0,0x0                                                                                    
000520   2371     ADDWFC    0x71,0x1,0x1                                                                                    
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000522   0e18     MOVLW     0x18               pSrc.bRam = (byte*)&CtrlTrfData;                                             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000524   6f6c     MOVWF     0x6c,0x1                                                                                        
000526   0e04     MOVLW     0x4                                                                                             
000528   6f6d     MOVWF     0x6d,0x1                                                                                        
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00052a   cfd9     MOVFF     0xfd9,0xfe9        while(byte_to_read._word)                                                    C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00052c   ffe9                                                                                                               
00052e   cfda     MOVFF     0xfda,0xfea                                                                                     
000530   ffea                                                                                                               
000532   50ee     MOVF      0xee,0x0,0x0                                                                                    
000534   10ed     IORWF     0xed,0x0,0x0                                                                                    
000536   e014     BZ        0x560                                                                                           
00055e   d7e5     BRA       0x52a                                                                                           
                                               {                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000538   c06c     MOVFF     0x6c,0xfe9             *pDst.bRam = *pSrc.bRam;                                                 C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00053a   ffe9                                                                                                               
00053c   c06d     MOVFF     0x6d,0xfea                                                                                      
00053e   ffea                                                                                                               
000540   50ef     MOVF      0xef,0x0,0x0                                                                                    
000542   c06e     MOVFF     0x6e,0xfe9                                                                                      
000544   ffe9                                                                                                               
000546   c06f     MOVFF     0x6f,0xfea                                                                                      
000548   ffea                                                                                                               
00054a   6eef     MOVWF     0xef,0x0                                                                                        
00054c   2b6e     INCF      0x6e,0x1,0x1           pDst.bRam++;                                                             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00054e   0e00     MOVLW     0x0                                                                                             
000550   236f     ADDWFC    0x6f,0x1,0x1                                                                                    
000552   2b6c     INCF      0x6c,0x1,0x1           pSrc.bRam++;                                                             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000554   236d     ADDWFC    0x6d,0x1,0x1                                                                                    
000556   06df     DECF      0xdf,0x1,0x0           byte_to_read._word--;                                                    C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000558   0e01     MOVLW     0x1                                                                                             
00055a   e201     BC        0x55e                                                                                           
00055c   06db     DECF      0xdb,0x1,0x0                                                                                    
                                               }//end while(byte_to_read._word)                                             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000560   0e02     MOVLW     0x2            }//end USBCtrlTrfRxService                                                       C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000562   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
000564   e202     BC        0x56a                                                                                           
000566   6ae1     CLRF      0xe1,0x0                                                                                        
000568   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00056a   6ee1     MOVWF     0xe1,0x0                                                                                        
00056c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00056e   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000570   ffd9                                                                                                               
000572   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlEPServiceComplete(void)                          C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine wrap up the ramaining tasks in servicing        C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  a Setup Request. Its main task is to set the endpoint        C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  controls appropriately for a given situation. See code       C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  below.                                                       C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  There are three main scenarios:                              C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  a) There was no handler for the Request, in this case        C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     a STALL should be sent out.                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  b) The host has requested a read control transfer,           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     endpoints are required to be setup in a specific way.     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  c) The host has requested a write control transfer, or       C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     a control data stage is not required, endpoints are       C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     required to be setup in a specific way.                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  Packet processing is resumed by clearing PKTDIS bit.         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlEPServiceComplete(void)                                              C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000574   0100     MOVLB     0x0                if(ctrl_trf_session_owner == MUID_NULL)                                      C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000576   516b     MOVF      0x6b,0x0,0x1                                                                                    
000578   e10c     BNZ       0x592                                                                                           
                                               {                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                   /*                                                                       C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                    * If no one knows how to service this request then stall.               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                    * Must also prepare EP0 to receive the next SETUP transaction.          C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                    */                                                                      C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00057a   0104     MOVLB     0x4                    ep0Bo.Cnt = EP0_BUFF_SIZE;                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00057c   0e08     MOVLW     0x8                                                                                             
00057e   6f01     MOVWF     0x1,0x1                                                                                         
000580   0e10     MOVLW     0x10                   ep0Bo.ADR = (byte*)&SetupPkt;                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000582   6f02     MOVWF     0x2,0x1                                                                                         
000584   0e04     MOVLW     0x4                                                                                             
000586   6f03     MOVWF     0x3,0x1                                                                                         
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000588   0e84     MOVLW     0x84                   ep0Bo.Stat._byte = _USIE|_BSTALL;                                        C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00058a   6f00     MOVWF     0x0,0x1                                                                                         
00058c   0104     MOVLB     0x4                    ep0Bi.Stat._byte = _USIE|_BSTALL;                                        C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00058e   6f04     MOVWF     0x4,0x1                                                                                         
                                               }                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000590   d035     BRA       0x5fc              else    // A module has claimed ownership of the control transfer session.   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                               {                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000592   0104     MOVLB     0x4                    if(SetupPkt.DataDir == DEV_TO_HOST)                                      C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000594   af10     BTFSS     0x10,0x7,0x1                                                                                    
000596   d022     BRA       0x5dc                                                                                           
                                                   {                                                                        C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000598   0100     MOVLB     0x0                        if(SetupPkt.wLength < wCount._word)                                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00059a   5170     MOVF      0x70,0x0,0x1                                                                                    
00059c   0104     MOVLB     0x4                                                                                             
00059e   5d16     SUBWF     0x16,0x0,0x1                                                                                    
0005a0   0100     MOVLB     0x0                                                                                             
0005a2   5171     MOVF      0x71,0x0,0x1                                                                                    
0005a4   0104     MOVLB     0x4                                                                                             
0005a6   5917     SUBWFB    0x17,0x0,0x1                                                                                    
0005a8   e204     BC        0x5b2                                                                                           
0005aa   c416     MOVFF     0x416,0x70                     wCount._word = SetupPkt.wLength;                                 C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005ac   f070                                                                                                               
0005ae   c417     MOVFF     0x417,0x71                                                                                      
0005b0   f071                                                                                                               
0005b2   df35     RCALL     0x41e                      USBCtrlTrfTxService();                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005b4   0100     MOVLB     0x0                        ctrl_trf_state = CTRL_TRF_TX;                                        C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005b6   0e01     MOVLW     0x1                                                                                             
0005b8   6f6a     MOVWF     0x6a,0x1                                                                                        
                                                       /*                                                                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Control Read:                                                     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * <SETUP[0]><IN[1]><IN[0]>...<OUT[1]> | <SETUP[0]>                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 1. Prepare OUT EP to respond to early termination                 C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * NOTE:                                                             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * If something went wrong during the control transfer,              C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * the last status stage may not be sent by the host.                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * When this happens, two different things could happen              C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * depending on the host.                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * a) The host could send out a RESET.                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * b) The host could send out a new SETUP transaction                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    without sending a RESET first.                                 C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * To properly handle case (b), the OUT EP must be setup             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * to receive either a zero length OUT transaction, or a             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * new SETUP transaction.                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Since the SETUP transaction requires the DTS bit to be            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * DAT0 while the zero length OUT status requires the DTS            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * bit to be DAT1, the DTS bit check by the hardware should          C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * be disabled. This way the SIE could accept either of              C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * the two transactions.                                             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Furthermore, the Cnt byte should be set to prepare for            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * the SETUP data (8-byte or more), and the buffer address           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * should be pointed to SetupPkt.                                    C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005ba   0104     MOVLB     0x4                        ep0Bo.Cnt = EP0_BUFF_SIZE;                                           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005bc   0e08     MOVLW     0x8                                                                                             
0005be   6f01     MOVWF     0x1,0x1                                                                                         
0005c0   0e10     MOVLW     0x10                       ep0Bo.ADR = (byte*)&SetupPkt;                                        C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005c2   6f02     MOVWF     0x2,0x1                                                                                         
0005c4   0e04     MOVLW     0x4                                                                                             
0005c6   6f03     MOVWF     0x3,0x1                                                                                         
0005c8   0e80     MOVLW     0x80                       ep0Bo.Stat._byte = _USIE;           // Note: DTSEN is 0!             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005ca   6f00     MOVWF     0x0,0x1                                                                                         
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                       /*                                                                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 2. Prepare IN EP to transfer data, Cnt should have                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    been initialized by responsible request owner.                 C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005cc   0104     MOVLB     0x4                        ep0Bi.ADR = (byte*)&CtrlTrfData;                                     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005ce   0e18     MOVLW     0x18                                                                                            
0005d0   6f06     MOVWF     0x6,0x1                                                                                         
0005d2   0e04     MOVLW     0x4                                                                                             
0005d4   6f07     MOVWF     0x7,0x1                                                                                         
0005d6   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005d8   6f04     MOVWF     0x4,0x1                                                                                         
                                                   }                                                                        C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005da   d010     BRA       0x5fc                  else    // (SetupPkt.DataDir == HOST_TO_DEV)                             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                   {                                                                        C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005dc   0100     MOVLB     0x0                        ctrl_trf_state = CTRL_TRF_RX;                                        C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005de   0e02     MOVLW     0x2                                                                                             
0005e0   6f6a     MOVWF     0x6a,0x1                                                                                        
                                                       /*                                                                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Control Write:                                                    C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * <SETUP[0]><OUT[1]><OUT[0]>...<IN[1]> | <SETUP[0]>                 C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 1. Prepare IN EP to respond to early termination                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    This is the same as a Zero Length Packet Response              C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    for control transfer without a data stage                      C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005e2   0104     MOVLB     0x4                        ep0Bi.Cnt = 0;                                                       C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005e4   6b05     CLRF      0x5,0x1                                                                                         
0005e6   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005e8   6f04     MOVWF     0x4,0x1                                                                                         
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                       /*                                                                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 2. Prepare OUT EP to receive data.                                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005ea   0104     MOVLB     0x4                        ep0Bo.Cnt = EP0_BUFF_SIZE;                                           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005ec   0e08     MOVLW     0x8                                                                                             
0005ee   6f01     MOVWF     0x1,0x1                                                                                         
0005f0   0e18     MOVLW     0x18                       ep0Bo.ADR = (byte*)&CtrlTrfData;                                     C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005f2   6f02     MOVWF     0x2,0x1                                                                                         
0005f4   0e04     MOVLW     0x4                                                                                             
0005f6   6f03     MOVWF     0x3,0x1                                                                                         
0005f8   0ec8     MOVLW     0xc8                       ep0Bo.Stat._byte = _USIE|_DAT1|_DTSEN;                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005fa   6f00     MOVWF     0x0,0x1                                                                                         
                                                   }//end if(SetupPkt.DataDir == DEV_TO_HOST)                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                               }//end if(ctrl_trf_session_owner == MUID_NULL)                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                * PKTDIS bit is set when a Setup Transaction is received.                   C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                * Clear to resume packet processing.                                        C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005fc   986d     BCF       0x6d,0x4,0x0       UCONbits.PKTDIS = 0;                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
0005fe   0012     RETURN    0x0            }//end USBCtrlEPServiceComplete                                                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBPrepareForNextSetupTrf(void)                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        The routine forces EP0 OUT to be ready for a new Setup       C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transaction, and forces EP0 IN to be owned by CPU.           C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBPrepareForNextSetupTrf(void)                                             C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000600   0100     MOVLB     0x0                ctrl_trf_state = WAIT_SETUP;            // See usbctrltrf.h                  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000602   6b6a     CLRF      0x6a,0x1                                                                                        
000604   0104     MOVLB     0x4                ep0Bo.Cnt = EP0_BUFF_SIZE;              // Defined in usbcfg.h               C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000606   0e08     MOVLW     0x8                                                                                             
000608   6f01     MOVWF     0x1,0x1                                                                                         
00060a   0e10     MOVLW     0x10               ep0Bo.ADR = (byte*)&SetupPkt;                                                C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
00060c   6f02     MOVWF     0x2,0x1                                                                                         
00060e   0e04     MOVLW     0x4                                                                                             
000610   6f03     MOVWF     0x3,0x1                                                                                         
000612   0e88     MOVLW     0x88               ep0Bo.Stat._byte = _USIE|_DAT0|_DTSEN;  // EP0 buff dsc init, see usbmmap.h  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000614   6f00     MOVWF     0x0,0x1                                                                                         
000616   0104     MOVLB     0x4                ep0Bi.Stat._byte = _UCPU;               // EP0 IN buffer initialization      C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
000618   6b04     CLRF      0x4,0x1                                                                                         
00061a   0012     RETURN    0x0            }//end USBPrepareForNextSetupTrf                                                 C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           /** EOF usbctrltrf.c *********************************************************/  C:\joyneuf\system\usb\usbctrltrf\usbctrltrf.c
                                           /*********************************************************************           C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            *             Microchip USB C18 Firmware -  HID Version 1.0                     C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            *********************************************************************           C:\joyneuf\system\usb\class\hid\hid.c
                                            * FileName:        hid.c                                                        C:\joyneuf\system\usb\class\hid\hid.c
                                            * Dependencies:    See INCLUDES section below                                   C:\joyneuf\system\usb\class\hid\hid.c
                                            * Processor:       PIC18                                                        C:\joyneuf\system\usb\class\hid\hid.c
                                            * Compiler:        C18 2.30.01+                                                 C:\joyneuf\system\usb\class\hid\hid.c
                                            * Company:         Microchip Technology, Inc.                                   C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Software License Agreement                                                    C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * The software supplied herewith by Microchip Technology Incorporated           C:\joyneuf\system\usb\class\hid\hid.c
                                            * (the ìCompanyî) for its PICmicroÆ Microcontroller is intended and             C:\joyneuf\system\usb\class\hid\hid.c
                                            * supplied to you, the Companyís customer, for use solely and                   C:\joyneuf\system\usb\class\hid\hid.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               C:\joyneuf\system\usb\class\hid\hid.c
                                            * software is owned by the Company and/or its supplier, and is                  C:\joyneuf\system\usb\class\hid\hid.c
                                            * protected under applicable copyright laws. All rights are reserved.           C:\joyneuf\system\usb\class\hid\hid.c
                                            * Any use in violation of the foregoing restrictions may subject the            C:\joyneuf\system\usb\class\hid\hid.c
                                            * user to criminal sanctions under applicable laws, as well as to               C:\joyneuf\system\usb\class\hid\hid.c
                                            * civil liability for the breach of the terms and conditions of this            C:\joyneuf\system\usb\class\hid\hid.c
                                            * license.                                                                      C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * THIS SOFTWARE IS PROVIDED IN AN ìAS ISî CONDITION. NO WARRANTIES,             C:\joyneuf\system\usb\class\hid\hid.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             C:\joyneuf\system\usb\class\hid\hid.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   C:\joyneuf\system\usb\class\hid\hid.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             C:\joyneuf\system\usb\class\hid\hid.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    C:\joyneuf\system\usb\class\hid\hid.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Author               Date        Comment                                      C:\joyneuf\system\usb\class\hid\hid.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           C:\joyneuf\system\usb\class\hid\hid.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    C:\joyneuf\system\usb\class\hid\hid.c
                                            ********************************************************************/           C:\joyneuf\system\usb\class\hid\hid.c
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                           /** I N C L U D E S **********************************************************/  C:\joyneuf\system\usb\class\hid\hid.c
                                           #include <p18cxxx.h>                                                             C:\joyneuf\system\usb\class\hid\hid.c
                                           #include "system\typedefs.h"                                                     C:\joyneuf\system\usb\class\hid\hid.c
                                           #include "system\usb\usb.h"                                                      C:\joyneuf\system\usb\class\hid\hid.c
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                           #ifdef USB_USE_HID                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                           /** V A R I A B L E S ********************************************************/  C:\joyneuf\system\usb\class\hid\hid.c
                                           #pragma udata                                                                    C:\joyneuf\system\usb\class\hid\hid.c
                                           byte idle_rate;                                                                  C:\joyneuf\system\usb\class\hid\hid.c
                                           byte active_protocol;               // [0] Boot Protocol [1] Report Protocol     C:\joyneuf\system\usb\class\hid\hid.c
                                           byte hid_rpt_rx_len;                                                             C:\joyneuf\system\usb\class\hid\hid.c
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  C:\joyneuf\system\usb\class\hid\hid.c
                                           void HIDGetReportHandler(void);                                                  C:\joyneuf\system\usb\class\hid\hid.c
                                           void HIDSetReportHandler(void);                                                  C:\joyneuf\system\usb\class\hid\hid.c
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                           /** D E C L A R A T I O N S **************************************************/  C:\joyneuf\system\usb\class\hid\hid.c
                                           #pragma code                                                                     C:\joyneuf\system\usb\class\hid\hid.c
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                           /** C L A S S  S P E C I F I C  R E Q ****************************************/  C:\joyneuf\system\usb\class\hid\hid.c
                                           /******************************************************************************  C:\joyneuf\system\usb\class\hid\hid.c
                                            * Function:        void USBCheckHIDRequest(void)                                C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * PreCondition:    None                                                         C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Overview:        This routine checks the setup data packet to see if it       C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  knows how to handle it                                       C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Note:            None                                                         C:\joyneuf\system\usb\class\hid\hid.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\class\hid\hid.c
                                           void USBCheckHIDRequest(void)                                                    C:\joyneuf\system\usb\class\hid\hid.c
                                           {                                                                                C:\joyneuf\system\usb\class\hid\hid.c
000806   0104     MOVLB     0x4                if(SetupPkt.Recipient != RCPT_INTF) return;                                  C:\joyneuf\system\usb\class\hid\hid.c
000808   5110     MOVF      0x10,0x0,0x1                                                                                    
00080a   0b1f     ANDLW     0x1f                                                                                            
00080c   0801     SUBLW     0x1                                                                                             
00080e   e001     BZ        0x812                                                                                           
000810   d079     BRA       0x904                                                                                           
000812   5114     MOVF      0x14,0x0,0x1       if(SetupPkt.bIntfID != HID_INTF_ID) return;                                  C:\joyneuf\system\usb\class\hid\hid.c
000814   e001     BZ        0x818                                                                                           
000816   d076     BRA       0x904                                                                                           
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                               /*                                                                           C:\joyneuf\system\usb\class\hid\hid.c
                                                * There are two standard requests that hid.c may support.                   C:\joyneuf\system\usb\class\hid\hid.c
                                                * 1. GET_DSC(DSC_HID,DSC_RPT,DSC_PHY);                                      C:\joyneuf\system\usb\class\hid\hid.c
                                                * 2. SET_DSC(DSC_HID,DSC_RPT,DSC_PHY);                                      C:\joyneuf\system\usb\class\hid\hid.c
                                                */                                                                          C:\joyneuf\system\usb\class\hid\hid.c
000818   0e06     MOVLW     0x6                if(SetupPkt.bRequest == GET_DSC)                                             C:\joyneuf\system\usb\class\hid\hid.c
00081a   5d11     SUBWF     0x11,0x0,0x1                                                                                    
00081c   e12e     BNZ       0x87a                                                                                           
                                               {                                                                            C:\joyneuf\system\usb\class\hid\hid.c
00081e   5113     MOVF      0x13,0x0,0x1           switch(SetupPkt.bDscType)                                                C:\joyneuf\system\usb\class\hid\hid.c
000820   0a23     XORLW     0x23                                                                                            
000822   e028     BZ        0x874                                                                                           
000824   0a01     XORLW     0x1                                                                                             
000826   e013     BZ        0x84e                                                                                           
000828   0a03     XORLW     0x3                                                                                             
00082a   e001     BZ        0x82e                                                                                           
00082c   d024     BRA       0x876                                                                                           
                                                   {                                                                        C:\joyneuf\system\usb\class\hid\hid.c
                                                       case DSC_HID:                                                        C:\joyneuf\system\usb\class\hid\hid.c
00082e   0100     MOVLB     0x0                            ctrl_trf_session_owner = MUID_HID;                               C:\joyneuf\system\usb\class\hid\hid.c
000830   0e02     MOVLW     0x2                                                                                             
000832   6f6b     MOVWF     0x6b,0x1                                                                                        
000834   0100     MOVLB     0x0                            mUSBGetHIDDscAdr(pSrc.bRom);        // See usbcfg.h              C:\joyneuf\system\usb\class\hid\hid.c
000836   0578     DECF      0x78,0x0,0x1                                                                                    
000838   e105     BNZ       0x844                                                                                           
00083a   0100     MOVLB     0x0                                                                                             
00083c   0e4e     MOVLW     0x4e                                                                                            
00083e   6f6c     MOVWF     0x6c,0x1                                                                                        
000840   0e0a     MOVLW     0xa                                                                                             
000842   6f6d     MOVWF     0x6d,0x1                                                                                        
000844   0e09     MOVLW     0x9                            wCount._word = sizeof(USB_HID_DSC);                              C:\joyneuf\system\usb\class\hid\hid.c
000846   0100     MOVLB     0x0                                                                                             
000848   6f70     MOVWF     0x70,0x1                                                                                        
00084a   6b71     CLRF      0x71,0x1                                                                                        
00084c   d014     BRA       0x876                          break;                                                           C:\joyneuf\system\usb\class\hid\hid.c
                                                       case DSC_RPT:                                                        C:\joyneuf\system\usb\class\hid\hid.c
00084e   0100     MOVLB     0x0                            ctrl_trf_session_owner = MUID_HID;                               C:\joyneuf\system\usb\class\hid\hid.c
000850   0e02     MOVLW     0x2                                                                                             
000852   6f6b     MOVWF     0x6b,0x1                                                                                        
000854   0100     MOVLB     0x0                            mUSBGetHIDRptDscAdr(pSrc.bRom);     // See usbcfg.h              C:\joyneuf\system\usb\class\hid\hid.c
000856   0578     DECF      0x78,0x0,0x1                                                                                    
000858   e105     BNZ       0x864                                                                                           
00085a   0100     MOVLB     0x0                                                                                             
00085c   0ec4     MOVLW     0xc4                                                                                            
00085e   6f6c     MOVWF     0x6c,0x1                                                                                        
000860   0e0a     MOVLW     0xa                                                                                             
000862   6f6d     MOVWF     0x6d,0x1                                                                                        
000864   0100     MOVLB     0x0                            mUSBGetHIDRptDscSize(wCount._word); // See usbcfg.h              C:\joyneuf\system\usb\class\hid\hid.c
000866   0578     DECF      0x78,0x0,0x1                                                                                    
000868   e104     BNZ       0x872                                                                                           
00086a   0e4f     MOVLW     0x4f                                                                                            
00086c   0100     MOVLB     0x0                                                                                             
00086e   6f70     MOVWF     0x70,0x1                                                                                        
000870   6b71     CLRF      0x71,0x1                                                                                        
000872   d001     BRA       0x876                          break;                                                           C:\joyneuf\system\usb\class\hid\hid.c
                                                       case DSC_PHY:                                                        C:\joyneuf\system\usb\class\hid\hid.c
                                                           // ctrl_trf_session_owner = MUID_HID;                            C:\joyneuf\system\usb\class\hid\hid.c
000874   d000     BRA       0x876                          break;                                                           C:\joyneuf\system\usb\class\hid\hid.c
                                                   }//end switch(SetupPkt.bDscType)                                         C:\joyneuf\system\usb\class\hid\hid.c
000876   0100     MOVLB     0x0                    usb_stat.ctrl_trf_mem = _ROM;                                            C:\joyneuf\system\usb\class\hid\hid.c
000878   8377     BSF       0x77,0x1,0x1                                                                                    
                                               }//end if(SetupPkt.bRequest == GET_DSC)                                      C:\joyneuf\system\usb\class\hid\hid.c
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
00087a   0104     MOVLB     0x4                if(SetupPkt.RequestType != CLASS) return;                                    C:\joyneuf\system\usb\class\hid\hid.c
00087c   5110     MOVF      0x10,0x0,0x1                                                                                    
00087e   0b60     ANDLW     0x60                                                                                            
000880   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000882   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000884   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000886   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000888   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
00088a   0801     SUBLW     0x1                                                                                             
00088c   e001     BZ        0x890                                                                                           
00088e   d03a     BRA       0x904                                                                                           
000890   5111     MOVF      0x11,0x0,0x1       switch(SetupPkt.bRequest)                                                    C:\joyneuf\system\usb\class\hid\hid.c
000892   0a0b     XORLW     0xb                                                                                             
000894   e031     BZ        0x8f8                                                                                           
000896   0a08     XORLW     0x8                                                                                             
000898   e021     BZ        0x8dc                                                                                           
00089a   0a09     XORLW     0x9                                                                                             
00089c   e019     BZ        0x8d0                                                                                           
00089e   0a08     XORLW     0x8                                                                                             
0008a0   e009     BZ        0x8b4                                                                                           
0008a2   0a0b     XORLW     0xb                                                                                             
0008a4   e005     BZ        0x8b0                                                                                           
0008a6   0a08     XORLW     0x8                                                                                             
0008a8   e001     BZ        0x8ac                                                                                           
0008aa   d02c     BRA       0x904                                                                                           
                                               {                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                                   case GET_REPORT:                                                         C:\joyneuf\system\usb\class\hid\hid.c
0008ac   d82c     RCALL     0x906                      HIDGetReportHandler();                                               C:\joyneuf\system\usb\class\hid\hid.c
0008ae   d02a     BRA       0x904                      break;                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                                   case SET_REPORT:                                                         C:\joyneuf\system\usb\class\hid\hid.c
0008b0   d82b     RCALL     0x908                      HIDSetReportHandler();                                               C:\joyneuf\system\usb\class\hid\hid.c
0008b2   d028     BRA       0x904                      break;                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                                   case GET_IDLE:                                                           C:\joyneuf\system\usb\class\hid\hid.c
0008b4   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_HID;                                   C:\joyneuf\system\usb\class\hid\hid.c
0008b6   0e02     MOVLW     0x2                                                                                             
0008b8   6f6b     MOVWF     0x6b,0x1                                                                                        
0008ba   0100     MOVLB     0x0                        pSrc.bRam = (byte*)&idle_rate;      // Set source                    C:\joyneuf\system\usb\class\hid\hid.c
0008bc   0e7a     MOVLW     0x7a                                                                                            
0008be   6f6c     MOVWF     0x6c,0x1                                                                                        
0008c0   0e00     MOVLW     0x0                                                                                             
0008c2   6f6d     MOVWF     0x6d,0x1                                                                                        
0008c4   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;       // Set memory type               C:\joyneuf\system\usb\class\hid\hid.c
0008c6   9377     BCF       0x77,0x1,0x1                                                                                    
0008c8   0100     MOVLB     0x0                        LSB(wCount) = 1;                    // Set data count                C:\joyneuf\system\usb\class\hid\hid.c
0008ca   0e01     MOVLW     0x1                                                                                             
0008cc   6f70     MOVWF     0x70,0x1                                                                                        
0008ce   d01a     BRA       0x904                      break;                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                                   case SET_IDLE:                                                           C:\joyneuf\system\usb\class\hid\hid.c
0008d0   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_HID;                                   C:\joyneuf\system\usb\class\hid\hid.c
0008d2   0e02     MOVLW     0x2                                                                                             
0008d4   6f6b     MOVWF     0x6b,0x1                                                                                        
0008d6   c413     MOVFF     0x413,0x7a                 idle_rate = MSB(SetupPkt.W_Value);                                   C:\joyneuf\system\usb\class\hid\hid.c
0008d8   f07a                                                                                                               
0008da   d014     BRA       0x904                      break;                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                                   case GET_PROTOCOL:                                                       C:\joyneuf\system\usb\class\hid\hid.c
0008dc   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_HID;                                   C:\joyneuf\system\usb\class\hid\hid.c
0008de   0e02     MOVLW     0x2                                                                                             
0008e0   6f6b     MOVWF     0x6b,0x1                                                                                        
0008e2   0100     MOVLB     0x0                        pSrc.bRam = (byte*)&active_protocol;// Set source                    C:\joyneuf\system\usb\class\hid\hid.c
0008e4   0e7b     MOVLW     0x7b                                                                                            
0008e6   6f6c     MOVWF     0x6c,0x1                                                                                        
0008e8   0e00     MOVLW     0x0                                                                                             
0008ea   6f6d     MOVWF     0x6d,0x1                                                                                        
0008ec   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;       // Set memory type               C:\joyneuf\system\usb\class\hid\hid.c
0008ee   9377     BCF       0x77,0x1,0x1                                                                                    
0008f0   0100     MOVLB     0x0                        LSB(wCount) = 1;                    // Set data count                C:\joyneuf\system\usb\class\hid\hid.c
0008f2   0e01     MOVLW     0x1                                                                                             
0008f4   6f70     MOVWF     0x70,0x1                                                                                        
0008f6   d006     BRA       0x904                      break;                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                                   case SET_PROTOCOL:                                                       C:\joyneuf\system\usb\class\hid\hid.c
0008f8   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_HID;                                   C:\joyneuf\system\usb\class\hid\hid.c
0008fa   0e02     MOVLW     0x2                                                                                             
0008fc   6f6b     MOVWF     0x6b,0x1                                                                                        
0008fe   c412     MOVFF     0x412,0x7b                 active_protocol = LSB(SetupPkt.W_Value);                             C:\joyneuf\system\usb\class\hid\hid.c
000900   f07b                                                                                                               
000902   d000     BRA       0x904                      break;                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                               }//end switch(SetupPkt.bRequest)                                             C:\joyneuf\system\usb\class\hid\hid.c
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
000904   0012     RETURN    0x0            }//end USBCheckHIDRequest                                                        C:\joyneuf\system\usb\class\hid\hid.c
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                           void HIDGetReportHandler(void)                                                   C:\joyneuf\system\usb\class\hid\hid.c
                                           {                                                                                C:\joyneuf\system\usb\class\hid\hid.c
                                               // ctrl_trf_session_owner = MUID_HID;                                        C:\joyneuf\system\usb\class\hid\hid.c
000906   0012     RETURN    0x0            }//end HIDGetReportHandler                                                       C:\joyneuf\system\usb\class\hid\hid.c
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                           void HIDSetReportHandler(void)                                                   C:\joyneuf\system\usb\class\hid\hid.c
                                           {                                                                                C:\joyneuf\system\usb\class\hid\hid.c
                                               // ctrl_trf_session_owner = MUID_HID;                                        C:\joyneuf\system\usb\class\hid\hid.c
                                               // pDst.bRam = (byte*)&hid_report_out;                                       C:\joyneuf\system\usb\class\hid\hid.c
000908   0012     RETURN    0x0            }//end HIDSetReportHandler                                                       C:\joyneuf\system\usb\class\hid\hid.c
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                           /** U S E R  A P I ***********************************************************/  C:\joyneuf\system\usb\class\hid\hid.c
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                           /******************************************************************************  C:\joyneuf\system\usb\class\hid\hid.c
                                            * Function:        void HIDInitEP(void)                                         C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * PreCondition:    None                                                         C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Input:           None                                                         C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Overview:        HIDInitEP initializes HID endpoints, buffer descriptors,     C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  internal state-machine, and variables.                       C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  It should be called after the USB host has sent out a        C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  SET_CONFIGURATION request.                                   C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  See USBStdSetCfgHandler() in usb9.c for examples.            C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Note:            None                                                         C:\joyneuf\system\usb\class\hid\hid.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\class\hid\hid.c
                                           void HIDInitEP(void)                                                             C:\joyneuf\system\usb\class\hid\hid.c
                                           {                                                                                C:\joyneuf\system\usb\class\hid\hid.c
00090a   0100     MOVLB     0x0                hid_rpt_rx_len =0;                                                           C:\joyneuf\system\usb\class\hid\hid.c
00090c   6b7c     CLRF      0x7c,0x1                                                                                        
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
00090e   0e1e     MOVLW     0x1e               HID_UEP = EP_OUT_IN|HSHK_EN;                // Enable 2 data pipes           C:\joyneuf\system\usb\class\hid\hid.c
000910   6e71     MOVWF     0x71,0x0                                                                                        
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
000912   0104     MOVLB     0x4                HID_BD_OUT.Cnt = sizeof(hid_report_out);    // Set buffer size               C:\joyneuf\system\usb\class\hid\hid.c
000914   0e04     MOVLW     0x4                                                                                             
000916   6f09     MOVWF     0x9,0x1                                                                                         
000918   0e20     MOVLW     0x20               HID_BD_OUT.ADR = (byte*)&hid_report_out;    // Set buffer address            C:\joyneuf\system\usb\class\hid\hid.c
00091a   6f0a     MOVWF     0xa,0x1                                                                                         
00091c   0e04     MOVLW     0x4                                                                                             
00091e   6f0b     MOVWF     0xb,0x1                                                                                         
000920   0e88     MOVLW     0x88               HID_BD_OUT.Stat._byte = _USIE|_DAT0|_DTSEN; // Set status                    C:\joyneuf\system\usb\class\hid\hid.c
000922   6f08     MOVWF     0x8,0x1                                                                                         
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                               /*                                                                           C:\joyneuf\system\usb\class\hid\hid.c
                                                * Do not have to init Cnt of IN pipes here.                                 C:\joyneuf\system\usb\class\hid\hid.c
                                                * Reason:  Number of bytes to send to the host                              C:\joyneuf\system\usb\class\hid\hid.c
                                                *          varies from one transaction to                                   C:\joyneuf\system\usb\class\hid\hid.c
                                                *          another. Cnt should equal the exact                              C:\joyneuf\system\usb\class\hid\hid.c
                                                *          number of bytes to transmit for                                  C:\joyneuf\system\usb\class\hid\hid.c
                                                *          a given IN transaction.                                          C:\joyneuf\system\usb\class\hid\hid.c
                                                *          This number of bytes will only                                   C:\joyneuf\system\usb\class\hid\hid.c
                                                *          be known right before the data is                                C:\joyneuf\system\usb\class\hid\hid.c
                                                *          sent.                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                                */                                                                          C:\joyneuf\system\usb\class\hid\hid.c
000924   0104     MOVLB     0x4                HID_BD_IN.ADR = (byte*)&hid_report_in;      // Set buffer address            C:\joyneuf\system\usb\class\hid\hid.c
000926   0e24     MOVLW     0x24                                                                                            
000928   6f0e     MOVWF     0xe,0x1                                                                                         
00092a   0e04     MOVLW     0x4                                                                                             
00092c   6f0f     MOVWF     0xf,0x1                                                                                         
00092e   0e40     MOVLW     0x40               HID_BD_IN.Stat._byte = _UCPU|_DAT1;         // Set status                    C:\joyneuf\system\usb\class\hid\hid.c
000930   6f0c     MOVWF     0xc,0x1                                                                                         
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
000932   0012     RETURN    0x0            }//end HIDInitEP                                                                 C:\joyneuf\system\usb\class\hid\hid.c
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                           /******************************************************************************  C:\joyneuf\system\usb\class\hid\hid.c
                                            * Function:        void HIDTxReport(char *buffer, byte len)                     C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * PreCondition:    mHIDTxIsBusy() must return false.                            C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  Value of 'len' must be equal to or smaller than              C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  HID_INT_IN_EP_SIZE                                           C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  For an interrupt endpoint, the largest buffer size is        C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  64 bytes.                                                    C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Input:           buffer  : Pointer to the starting location of data bytes     C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  len     : Number of bytes to be transferred                  C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Output:          None                                                         C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Side Effects:    None                                                         C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Overview:        Use this macro to transfer data located in data memory.      C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  Remember: mHIDTxIsBusy() must return false before user       C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  can call this function.                                      C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  Unexpected behavior will occur if this function is called    C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  when mHIDTxIsBusy() == 0                                     C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  Typical Usage:                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  if(!mHIDTxIsBusy())                                          C:\joyneuf\system\usb\class\hid\hid.c
                                            *                      HIDTxReport(buffer, 3);                                  C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Note:            None                                                         C:\joyneuf\system\usb\class\hid\hid.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\class\hid\hid.c
000934   cfd9     MOVFF     0xfd9,0xfe6    void HIDTxReport(char *buffer, byte len)                                         C:\joyneuf\system\usb\class\hid\hid.c
000936   ffe6                                                                                                               
000938   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00093a   ffd9                                                                                                               
00093c   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                C:\joyneuf\system\usb\class\hid\hid.c
                                           	byte i;                                                                         C:\joyneuf\system\usb\class\hid\hid.c
                                           	                                                                                C:\joyneuf\system\usb\class\hid\hid.c
                                               /*                                                                           C:\joyneuf\system\usb\class\hid\hid.c
                                                * Value of len should be equal to or smaller than HID_INT_IN_EP_SIZE.       C:\joyneuf\system\usb\class\hid\hid.c
                                                * This check forces the value of len to meet the precondition.              C:\joyneuf\system\usb\class\hid\hid.c
                                                */                                                                          C:\joyneuf\system\usb\class\hid\hid.c
00093e   0efc     MOVLW     0xfc           	if(len > HID_INT_IN_EP_SIZE)                                                    C:\joyneuf\system\usb\class\hid\hid.c
000940   50db     MOVF      0xdb,0x0,0x0                                                                                    
000942   0804     SUBLW     0x4                                                                                             
000944   e205     BC        0x950                                                                                           
000946   0e04     MOVLW     0x4            	    len = HID_INT_IN_EP_SIZE;                                                   C:\joyneuf\system\usb\class\hid\hid.c
000948   6ef3     MOVWF     0xf3,0x0                                                                                        
00094a   0efc     MOVLW     0xfc                                                                                            
00094c   cff3     MOVFF     0xff3,0xfdb                                                                                     
00094e   ffdb                                                                                                               
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                              /*                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                               * Copy data from user's buffer to dual-ram buffer                            C:\joyneuf\system\usb\class\hid\hid.c
                                               */                                                                           C:\joyneuf\system\usb\class\hid\hid.c
000950   6adf     CLRF      0xdf,0x0           for (i = 0; i < len; i++)                                                    C:\joyneuf\system\usb\class\hid\hid.c
000952   0efc     MOVLW     0xfc                                                                                            
000954   50db     MOVF      0xdb,0x0,0x0                                                                                    
000956   5cdf     SUBWF     0xdf,0x0,0x0                                                                                    
000958   e219     BC        0x98c                                                                                           
000988   2adf     INCF      0xdf,0x1,0x0                                                                                    
00098a   d7e3     BRA       0x952                                                                                           
00095a   50df     MOVF      0xdf,0x0,0x0       	hid_report_in[i] = buffer[i];                                               C:\joyneuf\system\usb\class\hid\hid.c
00095c   6ee7     MOVWF     0xe7,0x0                                                                                        
00095e   0efd     MOVLW     0xfd                                                                                            
000960   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000962   ffe9                                                                                                               
000964   0efe     MOVLW     0xfe                                                                                            
000966   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000968   ffea                                                                                                               
00096a   50e7     MOVF      0xe7,0x0,0x0                                                                                    
00096c   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
00096e   0e00     MOVLW     0x0                                                                                             
000970   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000972   50ef     MOVF      0xef,0x0,0x0                                                                                    
000974   6ee6     MOVWF     0xe6,0x0                                                                                        
000976   50df     MOVF      0xdf,0x0,0x0                                                                                    
000978   6aea     CLRF      0xea,0x0                                                                                        
00097a   0f24     ADDLW     0x24                                                                                            
00097c   6ee9     MOVWF     0xe9,0x0                                                                                        
00097e   0e04     MOVLW     0x4                                                                                             
000980   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000982   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000984   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000986   6eef     MOVWF     0xef,0x0                                                                                        
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
00098c   0efc     MOVLW     0xfc               HID_BD_IN.Cnt = len;                                                         C:\joyneuf\system\usb\class\hid\hid.c
00098e   cfdb     MOVFF     0xfdb,0x40d                                                                                     
000990   f40d                                                                                                               
000992   0e40     MOVLW     0x40               mUSBBufferReady(HID_BD_IN);                                                  C:\joyneuf\system\usb\class\hid\hid.c
000994   0104     MOVLB     0x4                                                                                             
000996   170c     ANDWF     0xc,0x1,0x1                                                                                     
000998   7d0c     BTG       0xc,0x6,0x1                                                                                     
00099a   0e88     MOVLW     0x88                                                                                            
00099c   130c     IORWF     0xc,0x1,0x1                                                                                     
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
00099e   52e5     MOVF      0xe5,0x1,0x0   }//end HIDTxReport                                                               C:\joyneuf\system\usb\class\hid\hid.c
0009a0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009a2   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0009a4   ffd9                                                                                                               
0009a6   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                           /******************************************************************************  C:\joyneuf\system\usb\class\hid\hid.c
                                            * Function:        byte HIDRxReport(char *buffer, byte len)                     C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * PreCondition:    Value of input argument 'len' should be smaller than the     C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  maximum endpoint size responsible for receiving report       C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  data from USB host for HID class.                            C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  Input argument 'buffer' should point to a buffer area that   C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  is bigger or equal to the size specified by 'len'.           C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Input:           buffer  : Pointer to where received bytes are to be stored   C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  len     : The number of bytes expected.                      C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Output:          The number of bytes copied to buffer.                        C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Side Effects:    Publicly accessible variable hid_rpt_rx_len is updated       C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  with the number of bytes copied to buffer.                   C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  Once HIDRxReport is called, subsequent retrieval of          C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  hid_rpt_rx_len can be done by calling macro                  C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  mHIDGetRptRxLength().                                        C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Overview:        HIDRxReport copies a string of bytes received through        C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  USB HID OUT endpoint to a user's specified location.         C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  It is a non-blocking function. It does not wait              C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  for data if there is no data available. Instead it returns   C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  '0' to notify the caller that there is no data available.    C:\joyneuf\system\usb\class\hid\hid.c
                                            *                                                                               C:\joyneuf\system\usb\class\hid\hid.c
                                            * Note:            If the actual number of bytes received is larger than the    C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  number of bytes expected (len), only the expected number     C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  of bytes specified will be copied to buffer.                 C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  If the actual number of bytes received is smaller than the   C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  number of bytes expected (len), only the actual number       C:\joyneuf\system\usb\class\hid\hid.c
                                            *                  of bytes received will be copied to buffer.                  C:\joyneuf\system\usb\class\hid\hid.c
                                            *****************************************************************************/  C:\joyneuf\system\usb\class\hid\hid.c
0009a8   cfd9     MOVFF     0xfd9,0xfe6    byte HIDRxReport(char *buffer, byte len)                                         C:\joyneuf\system\usb\class\hid\hid.c
0009aa   ffe6                                                                                                               
0009ac   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0009ae   ffd9                                                                                                               
                                           {                                                                                C:\joyneuf\system\usb\class\hid\hid.c
0009b0   0100     MOVLB     0x0                hid_rpt_rx_len = 0;                                                          C:\joyneuf\system\usb\class\hid\hid.c
0009b2   6b7c     CLRF      0x7c,0x1                                                                                        
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
0009b4   0104     MOVLB     0x4                if(!mHIDRxIsBusy())                                                          C:\joyneuf\system\usb\class\hid\hid.c
0009b6   bf08     BTFSC     0x8,0x7,0x1                                                                                     
0009b8   d031     BRA       0xa1c                                                                                           
                                               {                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                                   /*                                                                       C:\joyneuf\system\usb\class\hid\hid.c
                                                    * Adjust the expected number of bytes to equal                          C:\joyneuf\system\usb\class\hid\hid.c
                                                    * the actual number of bytes received.                                  C:\joyneuf\system\usb\class\hid\hid.c
                                                    */                                                                      C:\joyneuf\system\usb\class\hid\hid.c
0009ba   0efc     MOVLW     0xfc                   if(len > HID_BD_OUT.Cnt)                                                 C:\joyneuf\system\usb\class\hid\hid.c
0009bc   cfdb     MOVFF     0xfdb,0x2                                                                                       
0009be   f002                                                                                                               
0009c0   5109     MOVF      0x9,0x0,0x1                                                                                     
0009c2   80d8     BSF       0xd8,0x0,0x0                                                                                    
0009c4   5402     SUBFWB    0x2,0x0,0x0                                                                                     
0009c6   e203     BC        0x9ce                                                                                           
0009c8   0efc     MOVLW     0xfc                       len = HID_BD_OUT.Cnt;                                                C:\joyneuf\system\usb\class\hid\hid.c
0009ca   c409     MOVFF     0x409,0xfdb                                                                                     
0009cc   ffdb                                                                                                               
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                                   /*                                                                       C:\joyneuf\system\usb\class\hid\hid.c
                                                    * Copy data from dual-ram buffer to user's buffer                       C:\joyneuf\system\usb\class\hid\hid.c
                                                    */                                                                      C:\joyneuf\system\usb\class\hid\hid.c
0009ce   0100     MOVLB     0x0                    for(hid_rpt_rx_len = 0; hid_rpt_rx_len < len; hid_rpt_rx_len++)          C:\joyneuf\system\usb\class\hid\hid.c
0009d0   6b7c     CLRF      0x7c,0x1                                                                                        
0009d2   0efc     MOVLW     0xfc                                                                                            
0009d4   50db     MOVF      0xdb,0x0,0x0                                                                                    
0009d6   5d7c     SUBWF     0x7c,0x0,0x1                                                                                    
0009d8   e219     BC        0xa0c                                                                                           
000a08   2b7c     INCF      0x7c,0x1,0x1                                                                                    
000a0a   d7e3     BRA       0x9d2                                                                                           
0009da   517c     MOVF      0x7c,0x0,0x1               buffer[hid_rpt_rx_len] = hid_report_out[hid_rpt_rx_len];             C:\joyneuf\system\usb\class\hid\hid.c
0009dc   6aea     CLRF      0xea,0x0                                                                                        
0009de   0f20     ADDLW     0x20                                                                                            
0009e0   6ee9     MOVWF     0xe9,0x0                                                                                        
0009e2   0e04     MOVLW     0x4                                                                                             
0009e4   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0009e6   50ef     MOVF      0xef,0x0,0x0                                                                                    
0009e8   6ee6     MOVWF     0xe6,0x0                                                                                        
0009ea   517c     MOVF      0x7c,0x0,0x1                                                                                    
0009ec   6ee7     MOVWF     0xe7,0x0                                                                                        
0009ee   0efd     MOVLW     0xfd                                                                                            
0009f0   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
0009f2   ffe9                                                                                                               
0009f4   0efe     MOVLW     0xfe                                                                                            
0009f6   cfdb     MOVFF     0xfdb,0xfea                                                                                     
0009f8   ffea                                                                                                               
0009fa   50e7     MOVF      0xe7,0x0,0x0                                                                                    
0009fc   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
0009fe   0e00     MOVLW     0x0                                                                                             
000a00   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000a02   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a04   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000a06   6eef     MOVWF     0xef,0x0                                                                                        
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                                   /*                                                                       C:\joyneuf\system\usb\class\hid\hid.c
                                                    * Prepare dual-ram buffer for next OUT transaction                      C:\joyneuf\system\usb\class\hid\hid.c
                                                    */                                                                      C:\joyneuf\system\usb\class\hid\hid.c
000a0c   0104     MOVLB     0x4                    HID_BD_OUT.Cnt = sizeof(hid_report_out);                                 C:\joyneuf\system\usb\class\hid\hid.c
000a0e   0e04     MOVLW     0x4                                                                                             
000a10   6f09     MOVWF     0x9,0x1                                                                                         
000a12   0e40     MOVLW     0x40                   mUSBBufferReady(HID_BD_OUT);                                             C:\joyneuf\system\usb\class\hid\hid.c
000a14   1708     ANDWF     0x8,0x1,0x1                                                                                     
000a16   7d08     BTG       0x8,0x6,0x1                                                                                     
000a18   0e88     MOVLW     0x88                                                                                            
000a1a   1308     IORWF     0x8,0x1,0x1                                                                                     
                                               }//end if                                                                    C:\joyneuf\system\usb\class\hid\hid.c
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
000a1c   0100     MOVLB     0x0                return hid_rpt_rx_len;                                                       C:\joyneuf\system\usb\class\hid\hid.c
000a1e   517c     MOVF      0x7c,0x0,0x1                                                                                    
000a20   d000     BRA       0xa22                                                                                           
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
000a22   52e5     MOVF      0xe5,0x1,0x0   }//end HIDRxReport                                                               C:\joyneuf\system\usb\class\hid\hid.c
000a24   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000a26   ffd9                                                                                                               
000a28   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                           #endif //def USB_USE_HID                                                         C:\joyneuf\system\usb\class\hid\hid.c
                                                                                                                            C:\joyneuf\system\usb\class\hid\hid.c
                                           /** EOF hid.c ***************************************************************/   C:\joyneuf\system\usb\class\hid\hid.c
                                           /*********************************************************************           C:\joyneuf\user\user_mouse.c
                                            *                                                                               C:\joyneuf\user\user_mouse.c
                                            *                Microchip USB C18 Firmware - Mouse Demo                        C:\joyneuf\user\user_mouse.c
                                            *                                                                               C:\joyneuf\user\user_mouse.c
                                            *********************************************************************           C:\joyneuf\user\user_mouse.c
                                            * FileName:        user_mouse.c                                                 C:\joyneuf\user\user_mouse.c
                                            * Dependencies:    See INCLUDES section below                                   C:\joyneuf\user\user_mouse.c
                                            * Processor:       PIC18                                                        C:\joyneuf\user\user_mouse.c
                                            * Compiler:        C18 2.30.01+                                                 C:\joyneuf\user\user_mouse.c
                                            * Company:         Microchip Technology, Inc.                                   C:\joyneuf\user\user_mouse.c
                                            *                                                                               C:\joyneuf\user\user_mouse.c
                                            * Software License Agreement                                                    C:\joyneuf\user\user_mouse.c
                                            *                                                                               C:\joyneuf\user\user_mouse.c
                                            * The software supplied herewith by Microchip Technology Incorporated           C:\joyneuf\user\user_mouse.c
                                            * (the ìCompanyÅE for its PICmicroÆ Microcontroller is intended and             C:\joyneuf\user\user_mouse.c
                                            * supplied to you, the Companyís customer, for use solely and                   C:\joyneuf\user\user_mouse.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               C:\joyneuf\user\user_mouse.c
                                            * software is owned by the Company and/or its supplier, and is                  C:\joyneuf\user\user_mouse.c
                                            * protected under applicable copyright laws. All rights are reserved.           C:\joyneuf\user\user_mouse.c
                                            * Any use in violation of the foregoing restrictions may subject the            C:\joyneuf\user\user_mouse.c
                                            * user to criminal sanctions under applicable laws, as well as to               C:\joyneuf\user\user_mouse.c
                                            * civil liability for the breach of the terms and conditions of this            C:\joyneuf\user\user_mouse.c
                                            * license.                                                                      C:\joyneuf\user\user_mouse.c
                                            *                                                                               C:\joyneuf\user\user_mouse.c
                                            * THIS SOFTWARE IS PROVIDED IN AN ìAS ISÅECONDITION. NO WARRANTIES,             C:\joyneuf\user\user_mouse.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             C:\joyneuf\user\user_mouse.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   C:\joyneuf\user\user_mouse.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             C:\joyneuf\user\user_mouse.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    C:\joyneuf\user\user_mouse.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             C:\joyneuf\user\user_mouse.c
                                            *                                                                               C:\joyneuf\user\user_mouse.c
                                            * Author               Date        Comment                                      C:\joyneuf\user\user_mouse.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           C:\joyneuf\user\user_mouse.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    C:\joyneuf\user\user_mouse.c
                                            ********************************************************************/           C:\joyneuf\user\user_mouse.c
                                                                                                                            C:\joyneuf\user\user_mouse.c
                                           /** I N C L U D E S **********************************************************/  C:\joyneuf\user\user_mouse.c
                                           #include <p18cxxx.h>                                                             C:\joyneuf\user\user_mouse.c
                                           #include <usart.h>                                                               C:\joyneuf\user\user_mouse.c
                                           #include "system\typedefs.h"                                                     C:\joyneuf\user\user_mouse.c
                                                                                                                            C:\joyneuf\user\user_mouse.c
                                           #include "system\usb\usb.h"                                                      C:\joyneuf\user\user_mouse.c
                                                                                                                            C:\joyneuf\user\user_mouse.c
                                           #include "io_cfg.h"             // I/O pin mapping                               C:\joyneuf\user\user_mouse.c
                                           #include "user\user_mouse.h"                                                     C:\joyneuf\user\user_mouse.c
                                           #include "delays.h"                                                              C:\joyneuf\user\user_mouse.c
                                                                                                                            C:\joyneuf\user\user_mouse.c
                                           /** V A R I A B L E S ********************************************************/  C:\joyneuf\user\user_mouse.c
                                           #pragma udata                                                                    C:\joyneuf\user\user_mouse.c
                                           char buffer[4];                                                                  C:\joyneuf\user\user_mouse.c
                                                                                                                            C:\joyneuf\user\user_mouse.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  C:\joyneuf\user\user_mouse.c
                                                                                                                            C:\joyneuf\user\user_mouse.c
                                                                                                                            C:\joyneuf\user\user_mouse.c
                                           /** D E C L A R A T I O N S **************************************************/  C:\joyneuf\user\user_mouse.c
                                           #pragma code                                                                     C:\joyneuf\user\user_mouse.c
                                           void UserInit(void)                                                              C:\joyneuf\user\user_mouse.c
                                           {                                                                                C:\joyneuf\user\user_mouse.c
000bbe   0e01     MOVLW     0x1            	TRISA = 0x01;                                                                   C:\joyneuf\user\user_mouse.c
000bc0   6e92     MOVWF     0x92,0x0                                                                                        
000bc2   0012     RETURN    0x0            }//end UserInit                                                                  C:\joyneuf\user\user_mouse.c
                                                                                                                            C:\joyneuf\user\user_mouse.c
                                           /******************************************************************************  C:\joyneuf\user\user_mouse.c
                                            * Function:        void ProcessIO(void)                                         C:\joyneuf\user\user_mouse.c
                                            *                                                                               C:\joyneuf\user\user_mouse.c
                                            * PreCondition:    None                                                         C:\joyneuf\user\user_mouse.c
                                            *                                                                               C:\joyneuf\user\user_mouse.c
                                            * Input:           None                                                         C:\joyneuf\user\user_mouse.c
                                            *                                                                               C:\joyneuf\user\user_mouse.c
                                            * Output:          None                                                         C:\joyneuf\user\user_mouse.c
                                            *                                                                               C:\joyneuf\user\user_mouse.c
                                            * Side Effects:    None                                                         C:\joyneuf\user\user_mouse.c
                                            *                                                                               C:\joyneuf\user\user_mouse.c
                                            * Overview:        This function is a place holder for other user routines.     C:\joyneuf\user\user_mouse.c
                                            *                  It is a mixture of both USB and non-USB tasks.               C:\joyneuf\user\user_mouse.c
                                            *                                                                               C:\joyneuf\user\user_mouse.c
                                            * Note:            None                                                         C:\joyneuf\user\user_mouse.c
                                            *****************************************************************************/  C:\joyneuf\user\user_mouse.c
                                           void ProcessIO(void)                                                             C:\joyneuf\user\user_mouse.c
                                           {                                                                                C:\joyneuf\user\user_mouse.c
000bc4   0e06     MOVLW     0x6                if((usb_device_state < CONFIGURED_STATE)||(UCONbits.SUSPND==1)) return;      C:\joyneuf\user\user_mouse.c
000bc6   0100     MOVLB     0x0                                                                                             
000bc8   5d76     SUBWF     0x76,0x0,0x1                                                                                    
000bca   e303     BNC       0xbd2                                                                                           
000bcc   506d     MOVF      0x6d,0x0,0x0                                                                                    
000bce   0b02     ANDLW     0x2                                                                                             
000bd0   e001     BZ        0xbd4                                                                                           
000bd2   d02d     BRA       0xc2e                                                                                           
                                                                                                                            C:\joyneuf\user\user_mouse.c
000bd4   a080     BTFSS     0x80,0x0,0x0   	if(PORTAbits.RA0!=0) {                                                          C:\joyneuf\user\user_mouse.c
000bd6   d014     BRA       0xc00                                                                                           
000bd8   0100     MOVLB     0x0            		buffer[0]=0;                                                                   C:\joyneuf\user\user_mouse.c
000bda   6b72     CLRF      0x72,0x1                                                                                        
000bdc   6b73     CLRF      0x73,0x1       		buffer[1]=0;                                                                   C:\joyneuf\user\user_mouse.c
000bde   6b74     CLRF      0x74,0x1       		buffer[2]=0;                                                                   C:\joyneuf\user\user_mouse.c
000be0   6b75     CLRF      0x75,0x1       		buffer[3]=0;                                                                   C:\joyneuf\user\user_mouse.c
000be2   0104     MOVLB     0x4            		if(!mHIDTxIsBusy()) HIDTxReport(buffer,4);                                     C:\joyneuf\user\user_mouse.c
000be4   bf0c     BTFSC     0xc,0x7,0x1                                                                                     
000be6   d00b     BRA       0xbfe                                                                                           
000be8   0e04     MOVLW     0x4                                                                                             
000bea   6ee6     MOVWF     0xe6,0x0                                                                                        
000bec   0e72     MOVLW     0x72                                                                                            
000bee   6ee6     MOVWF     0xe6,0x0                                                                                        
000bf0   0e00     MOVLW     0x0                                                                                             
000bf2   6ee6     MOVWF     0xe6,0x0                                                                                        
000bf4   ec9a     CALL      0x934,0x0                                                                                       
000bf6   f004                                                                                                               
000bf8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000bfa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000bfc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	}                                                                               C:\joyneuf\user\user_mouse.c
000bfe   d017     BRA       0xc2e          	else {                                                                          C:\joyneuf\user\user_mouse.c
000c00   0100     MOVLB     0x0            		buffer[0]=-100;	//Throttle                                                     C:\joyneuf\user\user_mouse.c
000c02   0e9c     MOVLW     0x9c                                                                                            
000c04   6f72     MOVWF     0x72,0x1                                                                                        
000c06   0e96     MOVLW     0x96           		buffer[1]=150;	//X axis                                                        C:\joyneuf\user\user_mouse.c
000c08   6f73     MOVWF     0x73,0x1                                                                                        
000c0a   0ef6     MOVLW     0xf6           		buffer[2]=-10;	//Y axis                                                        C:\joyneuf\user\user_mouse.c
000c0c   6f74     MOVWF     0x74,0x1                                                                                        
000c0e   0e41     MOVLW     0x41           		buffer[3]=0x41; //0001 0001                                                    C:\joyneuf\user\user_mouse.c
000c10   6f75     MOVWF     0x75,0x1                                                                                        
                                           //As for buffer[3],                                                              C:\joyneuf\user\user_mouse.c
                                           //first 4 bits 0100 correspond to button #3                                      C:\joyneuf\user\user_mouse.c
                                           //last 4 bits 0001 correspond to hat switch and mean a 90-deg rotation (counter clockwise) C:\joyneuf\user\user_mouse.c
                                                                                                                            C:\joyneuf\user\user_mouse.c
000c12   0104     MOVLB     0x4            		if(!mHIDTxIsBusy()) HIDTxReport(buffer,4);                                     C:\joyneuf\user\user_mouse.c
000c14   bf0c     BTFSC     0xc,0x7,0x1                                                                                     
000c16   d00b     BRA       0xc2e                                                                                           
000c18   0e04     MOVLW     0x4                                                                                             
000c1a   6ee6     MOVWF     0xe6,0x0                                                                                        
000c1c   0e72     MOVLW     0x72                                                                                            
000c1e   6ee6     MOVWF     0xe6,0x0                                                                                        
000c20   0e00     MOVLW     0x0                                                                                             
000c22   6ee6     MOVWF     0xe6,0x0                                                                                        
000c24   ec9a     CALL      0x934,0x0                                                                                       
000c26   f004                                                                                                               
000c28   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c2a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c2c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	}		                                                                             C:\joyneuf\user\user_mouse.c
                                                                                                                            C:\joyneuf\user\user_mouse.c
000c2e   0012     RETURN    0x0            }//end ProcessIO                                                                 C:\joyneuf\user\user_mouse.c
                                                                                                                            C:\joyneuf\user\user_mouse.c
                                           /** EOF user_mouse.c *********************************************************/  C:\joyneuf\user\user_mouse.c
                                                   LIST P=18F2550                                                           C:\MCC18\src\traditional\proc\p18f2550.asm
                                                   LIST                                                                     C:\MCC18\src\traditional\proc\p18f2550.asm
                                                   END                                                                      C:\MCC18\src\traditional\proc\p18f2550.asm
                                           ;	RCS Header $Id: cmath18.asm,v 1.5 2006/01/12 23:16:38 rhinec Exp $             C:\MCC18\src\traditional\math\cmath18.asm
                                                                                                                            C:\MCC18\src\traditional\math\cmath18.asm
                                           ;       CMATH18 DATA DEFINITION FILE                                             C:\MCC18\src\traditional\math\cmath18.asm
                                                                                                                            C:\MCC18\src\traditional\math\cmath18.asm
                                           ;******************************************************************************* C:\MCC18\src\traditional\math\cmath18.asm
                                           ;   VARIABLE ALLOCATION - Core math library routines                             C:\MCC18\src\traditional\math\cmath18.asm
                                           ;******************************************************************************* C:\MCC18\src\traditional\math\cmath18.asm
                                                                                                                            C:\MCC18\src\traditional\math\cmath18.asm
                                           MATH_DATA      UDATA_ACS                                                         C:\MCC18\src\traditional\math\cmath18.asm
                                                                                                                            C:\MCC18\src\traditional\math\cmath18.asm
                                           SIGN		RES 1       ; save location for sign in MSB                                C:\MCC18\src\traditional\math\cmath18.asm
                                           __FPFLAGSbits                                                                    C:\MCC18\src\traditional\math\cmath18.asm
                                           __FPFLAGS		RES 1       ; floating point library exception flags                  C:\MCC18\src\traditional\math\cmath18.asm
                                                                                                                            C:\MCC18\src\traditional\math\cmath18.asm
                                                   GLOBAL  SIGN, __FPFLAGS, __FPFLAGSbits                                   C:\MCC18\src\traditional\math\cmath18.asm
                                           	                                                                                C:\MCC18\src\traditional\math\cmath18.asm
                                                   END                                                                      C:\MCC18\src\traditional\math\cmath18.asm
                                                                                                                            C:\MCC18\src\traditional\stdclib\__init.c
                                           /** @name __init                                                                 C:\MCC18\src\traditional\stdclib\__init.c
                                            * The {\bf __init} is called if the linker can not find a                       C:\MCC18\src\traditional\stdclib\__init.c
                                            * user defined version for it                                                   C:\MCC18\src\traditional\stdclib\__init.c
                                            */                                                                              C:\MCC18\src\traditional\stdclib\__init.c
                                                                                                                            C:\MCC18\src\traditional\stdclib\__init.c
                                           void __init (void)                                                               C:\MCC18\src\traditional\stdclib\__init.c
                                           {                                                                                C:\MCC18\src\traditional\stdclib\__init.c
0007fe   0012     RETURN    0x0            }                                                                                C:\MCC18\src\traditional\stdclib\__init.c
                                                                                                                            C:\MCC18\src\traditional\stdclib\__init.c
